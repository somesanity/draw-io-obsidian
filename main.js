/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => DrawioPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian9 = require("obsidian");

// consts.ts
var DRAWIOVIEW = "drawioview";

// views/drawioView.ts
var import_obsidian2 = require("obsidian");

// locales/en.json
var en_default = {
  DrawIoViewName: "draw.io editor",
  ribonIconTitle: "open draw.io editor",
  StartDrawioClientSever: "Draw.io server started on port",
  StopDrawioClinetServer: "Draw.io server stopped"
};

// locales/ru.json
var ru_default = {
  DrawIoViewName: "\u0420\u0435\u0434\u0430\u043A\u0442\u043E\u0440 draw.io",
  ribonIconTitle: "\u041E\u0442\u043A\u0440\u044B\u0442\u044C \u0440\u0435\u0434\u0430\u043A\u0442\u043E\u0440 draw.io",
  StartDrawioClientSever: "\u0421\u0435\u0440\u0435\u0432\u0435\u0440 \u0437\u0430\u043F\u0443\u0441\u0442\u0438\u043B\u0430 \u043D\u0430 \u043F\u043E\u0440\u0442\u0443",
  StopDrawioClinetServer: "\u0421\u0435\u0440\u0435\u0432\u0440 drawio \u043E\u0441\u0442\u0430\u043D\u043E\u0432\u043B\u0435\u043D"
};

// locales/i18n.ts
var locales = {
  en: en_default,
  ru: ru_default
};
var currentLocale = "en";
var translations = en_default;
function setLocale(locale) {
  currentLocale = locale in locales ? locale : "en";
  translations = locales[currentLocale];
}
function t(key) {
  return translations[key] || key;
}

// utils/folderExists.ts
var import_obsidian = require("obsidian");
function folderExists(app, path2) {
  const normalized = (0, import_obsidian.normalizePath)(path2);
  const folder = app.vault.getAbstractFileByPath(normalized);
  return folder instanceof import_obsidian.TFolder;
}

// views/drawioView.ts
var Drawioview = class extends import_obsidian2.ItemView {
  constructor(leaf, plugin) {
    super(leaf);
    this.iframe = null;
    this.plugin = plugin;
    this.messageHandler = this.listendrawiomessage.bind(this);
  }
  getViewType() {
    return DRAWIOVIEW;
  }
  getDisplayText() {
    return t("DrawIoViewName");
  }
  async onOpen() {
    const container = this.containerEl.children[1];
    container.empty();
    container.createEl("iframe", { attr: { id: "drawioiframe", src: `http://localhost:${this.plugin.settings.port}?embed=1&proto=json&ui=dark` } }).addClass("drawioIframe");
    this.iframe = document.getElementById("drawioiframe");
    window.addEventListener("message", this.messageHandler);
  }
  async listendrawiomessage(event) {
    var _a, _b, _c, _d;
    try {
      const msg = JSON.parse(event.data);
      switch (msg.event) {
        case "init":
          (_b = (_a = this.iframe) == null ? void 0 : _a.contentWindow) == null ? void 0 : _b.postMessage(JSON.stringify({
            action: "load",
            xml: "<mxGraphModel><root>...</root></mxGraphModel>",
            title: "example.drawio"
          }), `http://localhost:${this.plugin.settings.port}`);
          break;
        case "save":
          (_d = (_c = this.iframe) == null ? void 0 : _c.contentWindow) == null ? void 0 : _d.postMessage(JSON.stringify({
            action: "export",
            format: "xmlsvg",
            xml: 1
          }), `http://localhost:${this.plugin.settings.port}`);
          console.log("\u0414\u0438\u0430\u0433\u0440\u0430\u043C\u043C\u0430 \u0441\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u0430:", msg);
          break;
        case "export": {
          const svgBase64 = msg.data;
          const svg64Data = svgBase64.replace(/^data:image\/svg\+xml;base64,/, "");
          const svgContent = atob(svg64Data);
          const now = new Date();
          const timestamp = `${now.getFullYear()}${(now.getMonth() + 1).toString().padStart(2, "0")}${now.getDate().toString().padStart(2, "0")}${now.getHours().toString().padStart(2, "0")}${now.getMinutes().toString().padStart(2, "0")}${now.getSeconds().toString().padStart(2, "0")}`;
          if (folderExists(this.app, this.plugin.settings.Folder)) {
            this.app.vault.create(`${this.plugin.settings.Folder}/drawio_${timestamp}.drawio.svg`, svgContent);
          } else {
            this.app.vault.create(`/drawio_${timestamp}.drawio.svg`, svgContent);
          }
          break;
        }
        case "exit":
          console.log("\u0420\u0435\u0434\u0430\u043A\u0442\u043E\u0440 \u0437\u0430\u043A\u0440\u044B\u0442");
          break;
      }
    } catch (e) {
      console.warn("\u041D\u0435\u043A\u043E\u0440\u0440\u0435\u043A\u0442\u043D\u044B\u0439 JSON \u0432 \u0441\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u0438:", event.data);
    }
  }
  async onClose() {
    window.removeEventListener("message", this.messageHandler);
  }
};

// handlers/ServerStart.ts
var import_obsidian3 = require("obsidian");
var http = require("http");
var fs = require("fs");
var path = require("path");
function getDrawioPaths(app, manifestDir) {
  const vaultBasePath = app.vault.adapter.basePath;
  const pluginDir = path.join(vaultBasePath, manifestDir);
  const webAppPath = path.join(pluginDir, "webapp");
  return { vaultBasePath, pluginDir, webAppPath };
}
function serverStart(plugin, webAppPath, port) {
  return new Promise((resolve, reject) => {
    const server = http.createServer((req, res) => {
      const requestUrl = new URL(req.url || "", `http://${req.headers.host}`);
      const filePath = path.join(
        webAppPath,
        requestUrl.pathname === "/" ? "index.html" : requestUrl.pathname
      );
      if (!filePath.startsWith(webAppPath)) {
        res.writeHead(403, { "Content-Type": "text/plain" });
        res.end("403 Forbidden");
        return;
      }
      fs.readFile(filePath, (err, data) => {
        if (err) {
          if (err.code === "ENOENT") {
            res.writeHead(404, { "Content-Type": "text/plain" });
            res.end("404 Not Found");
          } else {
            res.writeHead(500, { "Content-Type": "text/plain" });
            res.end(`500 Internal Server Error: ${err.message}`);
          }
        } else {
          const ext = path.extname(filePath).toLowerCase();
          let contentType = "application/octet-stream";
          switch (ext) {
            case ".html":
              contentType = "text/html";
              break;
            case ".js":
              contentType = "application/javascript";
              break;
            case ".css":
              contentType = "text/css";
              break;
            case ".json":
              contentType = "application/json";
              break;
            case ".png":
              contentType = "image/png";
              break;
            case ".jpg":
              contentType = "image/jpeg";
              break;
            case ".gif":
              contentType = "image/gif";
              break;
            case ".svg":
              contentType = "image/svg+xml";
              break;
            case ".woff":
              contentType = "font/woff";
              break;
            case ".woff2":
              contentType = "font/woff2";
              break;
            case ".ttf":
              contentType = "font/ttf";
              break;
            case ".ico":
              contentType = "image/x-icon";
              break;
          }
          res.writeHead(200, { "Content-Type": contentType });
          res.end(data);
        }
      });
    });
    server.listen(port, () => {
      const port2 = plugin.settings.port;
      new import_obsidian3.Notice(`${t("StartDrawioClientSever")} ${port2}`);
      resolve(server);
    }).on("error", (err) => {
      if (err.code === "EADDRINUSE") {
        new import_obsidian3.Notice(`\u274C \u041F\u043E\u0440\u0442 ${port} \u0443\u0436\u0435 \u0437\u0430\u043D\u044F\u0442. \u0421\u0435\u0440\u0432\u0435\u0440 Draw.io \u043D\u0435 \u0437\u0430\u043F\u0443\u0449\u0435\u043D.`);
        console.error(`\u041F\u043E\u0440\u0442 ${port} \u0443\u0436\u0435 \u0437\u0430\u043D\u044F\u0442.`);
      } else {
        new import_obsidian3.Notice(`\u274C \u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0437\u0430\u043F\u0443\u0441\u0442\u0438\u0442\u044C \u0441\u0435\u0440\u0432\u0435\u0440 Draw.io: ${err.message}`);
        console.error(`\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0437\u0430\u043F\u0443\u0441\u0442\u0438\u0442\u044C \u0441\u0435\u0440\u0432\u0435\u0440 Draw.io:`, err);
      }
      reject(err);
    });
  });
}
async function launchDrawioServerLogic(plugin) {
  if (plugin.isServerOpen)
    return;
  const PORT = plugin.settings.port;
  const { webAppPath } = getDrawioPaths(plugin.app, plugin.manifest.dir);
  try {
    plugin.isServerOpen = await serverStart(plugin, webAppPath, Number(PORT));
    await new Promise((res) => setTimeout(res, 1e3));
    console.log(plugin.settings.port);
  } catch (error) {
    plugin.isServerOpen = null;
  }
}

// settings/Settings.ts
var DEFAULT_SETTINGS = {
  port: "1717",
  centeringDiagram: true,
  percentSize: true,
  interactiveDiagram: true,
  useMarkdownLinks: false,
  Folder: "drawio",
  diagramSize: ""
};

// settings/Settings-tab.ts
var import_obsidian4 = require("obsidian");
var DrawioTab = class extends import_obsidian4.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    let { containerEl } = this;
    containerEl.empty();
    new import_obsidian4.Setting(containerEl).setName("Set port").setDesc("Set port").addText(
      (text) => text.setPlaceholder("1717").setValue(this.plugin.settings.port).onChange(async (value) => {
        this.plugin.settings.port = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian4.Setting(containerEl).setName("Centering Diagram").setDesc("If active all diagram will be position to center").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.centeringDiagram).onChange(async (value) => {
        this.plugin.settings.centeringDiagram = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian4.Setting(containerEl).setName("Percent size").setDesc("Percent Size").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.percentSize).onChange(async (value) => {
        this.plugin.settings.percentSize = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian4.Setting(containerEl).setName("Interactive diagrams").setDesc("Interactive diagrams").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.interactiveDiagram).onChange(async (value) => {
        this.plugin.settings.interactiveDiagram = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian4.Setting(containerEl).setName("Use markdown Links").setDesc("If enable link will be markdown link style").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.useMarkdownLinks).onChange(async (value) => {
        this.plugin.settings.useMarkdownLinks = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian4.Setting(containerEl).setName("Select folder").setDesc("Select folder that save diagrams").addDropdown(
      (dropdown) => {
        const folders = this.app.vault.getAllLoadedFiles().filter((file) => file instanceof import_obsidian4.TFolder);
        folders.forEach((folder) => {
          dropdown.addOption(folder.path, folder.path);
        });
        dropdown.setValue(this.plugin.settings.Folder);
        dropdown.onChange(async (value) => {
          this.plugin.settings.Folder = value;
          await this.plugin.saveSettings();
        });
      }
    );
    new import_obsidian4.Setting(containerEl).setName("diagram width").setDesc("Set default diagram size").addText(
      (text) => text.setPlaceholder("100%").setValue(this.plugin.settings.diagramSize).onChange(async (value) => {
        this.plugin.settings.diagramSize = value;
        await this.plugin.saveSettings();
      })
    );
  }
};

// utils/centeringDiagrams.ts
async function CenteringDiagrams(plugin) {
  if (!plugin.settings.centeringDiagram) {
    return;
  } else {
    plugin.registerMarkdownPostProcessor((el, ctx) => {
      const embeds = el.querySelectorAll('span.internal-embed[src$=".drawio.svg"]');
      embeds.forEach((embed) => {
        var _a;
        const wrapper = document.createElement("div");
        wrapper.style.textAlign = "center";
        wrapper.style.width = "100%";
        const img = embed.querySelector("img");
        if (img) {
          img.style.width = "100%";
          img.style.height = "auto";
          img.style.maxWidth = "100%";
        }
        if (embed.parentElement && embed.parentElement.tagName === "DIV")
          return;
        (_a = embed.parentElement) == null ? void 0 : _a.insertBefore(wrapper, embed);
        wrapper.appendChild(embed);
      });
    });
  }
  ;
}

// utils/DefaultDiagramSize.ts
async function DefaultDiagramSize(plugin) {
  if (!plugin.settings.percentSize) {
    return;
  } else {
    plugin.registerMarkdownPostProcessor((el, ctx) => {
      const embeds = el.querySelectorAll('span.internal-embed[src$=".drawio.svg"]');
      embeds.forEach((embed) => {
        const width = embed.getAttribute("alt");
        const percentpattern = /^(100|[1-9]?\d)%$/;
        if (percentpattern.test(width != null ? width : "")) {
          embed.setAttribute("width", width);
        }
      });
    });
  }
}

// handlers/getFileContent.ts
var import_obsidian5 = require("obsidian");

// utils/findFileByName.ts
function findFileByName(fileName, app) {
  const files = app.vault.getFiles();
  for (const file of files) {
    if (file.name === fileName) {
      return file;
    }
  }
  return null;
}

// handlers/getFileContent.ts
function getFileContent(element, app) {
  const src = element.getAttribute("src");
  if (!src)
    return null;
  const filename = src.split("/").pop();
  if (!filename)
    return null;
  const file = findFileByName(filename, app);
  return file instanceof import_obsidian5.TFile ? file : null;
}

// utils/interactiveDiagrams.ts
var import_obsidian6 = require("obsidian");
async function InteractiveDiagrams(plugin) {
  if (!plugin.settings.interactiveDiagram)
    return;
  plugin.registerMarkdownPostProcessor(async (el, ctx) => {
    const embeds = el.querySelectorAll('span.internal-embed[src$=".drawio.svg"]');
    for (const embed of embeds) {
      embed.addClass("drawio-container");
      const file = getFileContent(embed, plugin.app);
      if (!(file instanceof import_obsidian6.TFile))
        continue;
      const data = await plugin.app.vault.read(file);
      const img = embed.querySelector("img");
      let imgSizee = null;
      if (img.hasAttribute("width")) {
        imgSizee = img.getAttribute("width");
      }
      if (img.hasAttribute("alt") && img.getAttribute("alt").includes("%")) {
        imgSizee = img.getAttribute("alt");
      }
      const temp = document.createElement("div");
      temp.innerHTML = data;
      const svgElement = temp.querySelector("svg");
      if (!svgElement)
        continue;
      img.replaceWith(svgElement);
      svgElement.addClass("drawio-svg");
      if (imgSizee !== null && !imgSizee.includes("%")) {
        svgElement.setAttribute("width", imgSizee + "px");
        svgElement.setAttribute("height", "100%");
      } else if (imgSizee !== null) {
        svgElement.setAttribute("width", imgSizee);
        svgElement.setAttribute("height", "100%");
      }
      if (document.body.classList.contains("theme-light")) {
        svgElement.addClass("drawio-scheme-light");
      } else {
        svgElement.addClass("drawio-scheme-dark");
      }
      const links = svgElement.querySelectorAll("a");
      for (const link of links) {
        link.addClass("internal-link");
        const hrefLink = link.getAttribute("xlink:href");
        let cleanHref = hrefLink;
        const matchRound = hrefLink.match(/\[.*?\]\((.*?)\)/);
        if (matchRound) {
          cleanHref = matchRound[1];
        }
        const matchDoubleSquare = hrefLink.match(/\[\[(.*?)\]\]/);
        if (matchDoubleSquare) {
          cleanHref = matchDoubleSquare[1];
        }
        link.setAttribute("href", cleanHref);
      }
    }
  });
}

// handlers/findDiagramFileUnderCursor.ts
var import_obsidian7 = require("obsidian");
function findDiagramFileUnderCursor(app, editor, view) {
  var _a, _b;
  const cursor = editor.getCursor();
  const line = editor.getLine(cursor.line);
  const linkRegex = /!\[\[([^|\]]+\.(?:drawio\.svg|drawio))[^\]]*\]\]/g;
  let execMatch;
  while ((execMatch = linkRegex.exec(line)) !== null) {
    const fullMatchText = execMatch[0];
    const linkText = execMatch[1];
    const startIndex = execMatch.index;
    const endIndex = startIndex + fullMatchText.length;
    if (cursor.ch >= startIndex && cursor.ch <= endIndex) {
      const linkedFile = app.metadataCache.getFirstLinkpathDest(linkText, (_b = (_a = view.file) == null ? void 0 : _a.path) != null ? _b : "");
      if (linkedFile instanceof import_obsidian7.TFile) {
        return linkedFile;
      }
    }
  }
  return null;
}

// views/modalDrawio.ts
var import_obsidian8 = require("obsidian");

// utils/forceMarkdownViewUpdate.ts
async function forceMarkdownViewUpdate(app, file) {
  var _a, _b;
  if (!file) {
    console.warn("forceMarkdownViewUpdate: \u0412\u044B\u0437\u0432\u0430\u043D\u0430 \u0441 null \u0444\u0430\u0439\u043B\u043E\u043C. \u041D\u0435\u0432\u043E\u0437\u043C\u043E\u0436\u043D\u043E \u043E\u043F\u0440\u0435\u0434\u0435\u043B\u0438\u0442\u044C, \u0438\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u044F \u043A\u0430\u043A\u043E\u0433\u043E \u0444\u0430\u0439\u043B\u0430 \u043E\u0442\u0441\u043B\u0435\u0436\u0438\u0432\u0430\u0442\u044C.");
    return;
  }
  const diagramFile = file;
  const leaves = app.workspace.getLeavesOfType("markdown");
  for (const leaf of leaves) {
    const mdView = leaf.view;
    if (!mdView || !mdView.file) {
      continue;
    }
    const currentViewFile = mdView.file;
    try {
      let needsRebuild = false;
      if (!currentViewFile || !currentViewFile.path) {
        console.warn(`forceMarkdownViewUpdate: currentViewFile \u0438\u043B\u0438 \u0435\u0433\u043E \u043F\u0443\u0442\u044C \u0441\u0442\u0430\u043B null/undefined \u0434\u043B\u044F \u043B\u0438\u0441\u0442\u0430 ${leaf}. \u041F\u0440\u043E\u043F\u0443\u0441\u043A\u0430\u0435\u043C \u043F\u0435\u0440\u0435\u0441\u0442\u0440\u043E\u0439\u043A\u0443.`);
        continue;
      }
      if (currentViewFile.path === diagramFile.path) {
        needsRebuild = true;
      } else {
        const fileContent = await app.vault.cachedRead(currentViewFile);
        if (fileContent.includes(diagramFile.name) || fileContent.includes(encodeURI(diagramFile.name))) {
          needsRebuild = true;
        }
      }
      if (needsRebuild) {
        if (typeof leaf.rebuildView === "function") {
          await leaf.rebuildView();
        } else {
          const viewState = leaf.getViewState();
          await leaf.setViewState({ type: "empty" });
          await leaf.setViewState(viewState);
        }
      }
    } catch (err) {
      const currentViewFilePathForLog = (_a = currentViewFile == null ? void 0 : currentViewFile.path) != null ? _a : "unknown file (no path)";
      const diagramFilePathForLog = (_b = diagramFile == null ? void 0 : diagramFile.path) != null ? _b : "unknown diagram path";
      console.warn(`\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u043E\u0431\u043D\u043E\u0432\u0438\u0442\u044C \u043F\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043B\u0435\u043D\u0438\u0435 \u0434\u043B\u044F ${currentViewFilePathForLog} \u043E\u0442\u043D\u043E\u0441\u0438\u0442\u0435\u043B\u044C\u043D\u043E \u0438\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u0439 \u0432 ${diagramFilePathForLog}:`, err);
    }
  }
}

// views/modalDrawio.ts
var DrawioEmbedModal = class extends import_obsidian8.Modal {
  constructor(app, editor, plugin, fileToEdit = null) {
    super(app);
    this.currentFile = null;
    this.iframe = null;
    this.messageHandler = null;
    this.isEmptyDiagram = true;
    this.editor = editor;
    this.plugin = plugin;
    this.currentFile = fileToEdit;
    this.modalEl.addClass("drawio-embed-modal");
    const modalBg = this.containerEl.querySelector(".modal-bg");
    if (modalBg) {
      this.scope.register([], "Escape", () => false);
      modalBg.addEventListener("click", (e) => e.stopPropagation(), true);
    }
  }
  async onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    this.titleEl.setText(this.currentFile ? `Edit Diagram: ${this.currentFile.name}` : "Create New Diagram");
    if (this.currentFile) {
      this.isEmptyDiagram = false;
    }
    const isDarkTheme = document.body.hasClass("theme-dark");
    const drawioUrl = `http://localhost:${this.plugin.settings.port}/?embed=1&proto=json&libraries=1&spin=1&splash=0` + (isDarkTheme ? `&ui=dark&dark=1` : `&ui=atlas`);
    this.iframe = contentEl.createEl("iframe", { attr: { src: drawioUrl } });
    this.iframe.addClass("drawioIframe");
    this.messageHandler = this.createMessageHandler();
    window.addEventListener("message", this.messageHandler);
  }
  async onClose() {
    const { contentEl } = this;
    contentEl.empty();
    if (this.messageHandler) {
      window.removeEventListener("message", this.messageHandler);
      this.messageHandler = null;
    }
    await this.handleModalCloseBasedOnContent();
    this.iframe = null;
    this.isEmptyDiagram = true;
    this.currentFile = null;
  }
  sendMessageToDrawio(message) {
    if (this.iframe && this.iframe.contentWindow) {
      this.iframe.contentWindow.postMessage(JSON.stringify(message), `http://localhost:${this.plugin.settings.port}`);
    }
  }
  async handleNewDiagramCreation() {
    const folderPath = this.plugin.settings.Folder;
    try {
      await this.app.vault.createFolder(folderPath);
    } catch (e) {
      if (!e.message.includes("Folder already exists")) {
        new import_obsidian8.Notice("\u274C Could not create folder for new diagram.");
        console.error("Error creating Drawio folder:", e);
        return null;
      }
    }
    const now = new Date();
    const timestamp = `${now.getFullYear()}${(now.getMonth() + 1).toString().padStart(2, "0")}${now.getDate().toString().padStart(2, "0")}${now.getHours().toString().padStart(2, "0")}${now.getMinutes().toString().padStart(2, "0")}${now.getSeconds().toString().padStart(2, "0")}`;
    const fileName = `diagram_${timestamp}.drawio.svg`;
    const fullPath = `${folderPath}/${fileName}`;
    const emptySvgContent = `<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1px" height="1px" viewBox="-0.5 -0.5 1 1" content="&lt;mxGraphModel&gt;&lt;root&gt;&lt;mxCell id=&quot;0&quot;/&gt;&lt;mxCell id=&quot;1&quot; parent=&quot;0&quot;/&gt;&lt;/root&gt;&lt;/mxGraphModel&gt;"><defs/><g/></svg>`;
    try {
      return await this.app.vault.create(fullPath, emptySvgContent);
    } catch (e) {
      new import_obsidian8.Notice(`\u274C Failed to create new diagram file: ${fullPath}`);
      console.error("Error creating new diagram file:", e);
      return null;
    }
  }
  createMessageHandler() {
    return async (event) => {
      if (event.origin !== `http://localhost:${this.plugin.settings.port}`)
        return;
      let msg;
      try {
        msg = typeof event.data === "string" ? JSON.parse(event.data) : event.data;
      } catch (e) {
        console.warn("Could not parse Draw.io message:", event.data, e);
        return;
      }
      switch (msg.event) {
        case "init":
          await this.handleInitMessage();
          break;
        case "save":
          this.sendMessageToDrawio({ action: "export", format: "xmlsvg", xml: 1, empty: 1 });
          break;
        case "export":
          await this.handleExportMessage(msg.data);
          break;
        case "change":
          this.handleChangeMessage(msg.xml);
          break;
        case "exit":
          this.close();
          break;
      }
    };
  }
  async handleInitMessage() {
    if (this.currentFile) {
      const fileContent = await this.app.vault.read(this.currentFile);
      this.sendMessageToDrawio({ action: "load", xml: fileContent, autosave: 1 });
    } else {
      const emptyXml = "<mxGraphModel><root><mxCell id='0'/><mxCell id='1' parent='0'/></root></mxGraphModel>";
      this.sendMessageToDrawio({ action: "load", xml: emptyXml, autosave: 1 });
    }
  }
  async handleExportMessage(svgDataUri) {
    await this.saveDiagramFromModal(svgDataUri);
  }
  handleChangeMessage(xmlContent) {
    const baseEmptyXml = "<mxGraphModel><root><mxCell id='0'/><mxCell id='1' parent='0'/></root></mxGraphModel>";
    this.isEmptyDiagram = !xmlContent || xmlContent === baseEmptyXml;
  }
  async saveDiagramFromModal(svgDataUri) {
    var _a;
    let contentToSave;
    try {
      contentToSave = this.decodeSvgDataUri(svgDataUri);
    } catch (e) {
      new import_obsidian8.Notice(`\u274C Failed to decode SVG content: ${e.message}`);
      return;
    }
    if (this.isSvgContentActuallyEmpty(contentToSave)) {
      new import_obsidian8.Notice("Diagram is empty. Nothing to save.");
      return;
    }
    if (!this.currentFile) {
      const newFile = await this.handleNewDiagramCreation();
      if (!newFile)
        return;
      this.currentFile = newFile;
      this.titleEl.setText(`Edit Diagram: ${this.currentFile.name}`);
      const defaultWidth = this.plugin.settings.diagramSize;
      let embedLink;
      if (this.plugin.settings.useMarkdownLinks) {
        const alt = (_a = defaultWidth == null ? void 0 : defaultWidth.trim()) != null ? _a : "";
        const relativePath = this.currentFile.path;
        embedLink = `![${alt}](${relativePath})`;
      } else {
        embedLink = (defaultWidth == null ? void 0 : defaultWidth.trim()) ? `![[${this.currentFile.path}|${defaultWidth.trim()}]]` : `![[${this.currentFile.path}]]`;
      }
      setTimeout(() => {
        this.editor.replaceSelection(embedLink);
      }, 500);
    }
    try {
      await this.app.vault.modify(this.currentFile, contentToSave);
      new import_obsidian8.Notice(`\u{1F4BE} Diagram saved: ${this.currentFile.path}`);
      forceMarkdownViewUpdate(this.app, this.currentFile);
      this.isEmptyDiagram = false;
    } catch (e) {
      new import_obsidian8.Notice(`\u274C Failed to save diagram: ${this.currentFile.path}`);
      console.error("Error saving diagram:", e);
    }
  }
  decodeSvgDataUri(svgDataUri) {
    if (svgDataUri.startsWith("data:image/svg+xml;base64,")) {
      const base64Part = svgDataUri.split(",")[1];
      return Buffer.from(base64Part, "base64").toString("utf-8");
    } else if (svgDataUri.startsWith("data:image/svg+xml,")) {
      return decodeURIComponent(svgDataUri.split(",")[1]);
    } else {
      throw new Error("Invalid SVG data format received.");
    }
  }
  isSvgContentActuallyEmpty(content) {
    const emptyDrawioXmlInSvgContent = `content="&lt;mxGraphModel&gt;&lt;root&gt;&lt;mxCell id=&quot;0&quot;/&gt;&lt;mxCell id=&quot;1&quot; parent=&quot;0&quot;/&gt;&lt;/root&gt;&lt;/mxGraphModel&gt;"`;
    return content.includes(emptyDrawioXmlInSvgContent) && (content.match(/<g\b[^>]*>/g) || []).length === 1;
  }
  async handleModalCloseBasedOnContent() {
    if (!this.currentFile)
      return;
    if (this.isEmptyDiagram) {
      try {
        const pathToDelete = this.currentFile.path;
        await this.app.fileManager.trashFile(this.currentFile);
        const editorContent = this.editor.getValue();
        const linkToDeleteSimple = `![[${pathToDelete}]]`;
        const linkToDeleteEncoded = `![[${encodeURI(pathToDelete)}]]`;
        let finalContent = editorContent.replace(linkToDeleteSimple, "");
        const linkWithModifierRegex = new RegExp(`!\\[\\[${pathToDelete.replace(/[-\/\\^$*+?.()|[\]{}]/g, "\\$&")}\\|[^\\]]+\\]\\]`, "g");
        finalContent = finalContent.replace(linkWithModifierRegex, "");
        if (finalContent !== editorContent) {
          this.editor.setValue(finalContent);
        }
      } catch (e) {
        if (!(e instanceof Error && e.message.toLowerCase().includes("file already deleted"))) {
          new import_obsidian8.Notice(`\u274C Failed to delete empty diagram file: ${this.currentFile.path}`);
        }
      }
    }
  }
};

// main.ts
var DrawioPlugin = class extends import_obsidian9.Plugin {
  constructor() {
    super(...arguments);
    this.isServerOpen = null;
  }
  async onload() {
    await this.loadSettings();
    this.addSettingTab(new DrawioTab(this.app, this));
    this.registerView(
      DRAWIOVIEW,
      (leaf) => new Drawioview(leaf, this)
    );
    const userLang = (window.localStorage.getItem("language") || "en").split("-")[0];
    setLocale(userLang);
    this.addRibbonIcon("dice", t("ribonIconTitle"), async () => {
      this.activateView();
      await launchDrawioServerLogic(this);
    });
    await CenteringDiagrams(this);
    await DefaultDiagramSize(this);
    await InteractiveDiagrams(this);
    this.registerEvent(
      this.app.workspace.on("editor-menu", (menu, editor, view) => {
        const fileToEdit = findDiagramFileUnderCursor(this.app, editor, view);
        const openDrawioModal = async (file) => {
          await launchDrawioServerLogic(this);
          new DrawioEmbedModal(this.app, editor, this, file).open();
        };
        if (fileToEdit) {
          menu.addItem((item) => {
            item.setTitle(`Edit ${fileToEdit.basename}`).setIcon("pencil").setSection("drawio-actions").onClick(() => openDrawioModal(fileToEdit));
          });
        } else {
          menu.addItem((item) => {
            item.setTitle("Embed New Draw.io Diagram").setIcon("shapes").setSection("drawio-actions").onClick(() => openDrawioModal());
          });
        }
      })
    );
    this.addCommand({
      id: "drawio-create-or-edit",
      name: "Create or edit Draw.io diagram",
      editorCallback: async (editor, view) => {
        const fileToEdit = findDiagramFileUnderCursor(this.app, editor, view);
        await launchDrawioServerLogic(this);
        if (fileToEdit) {
          new DrawioEmbedModal(this.app, editor, this, fileToEdit).open();
        } else {
          new DrawioEmbedModal(this.app, editor, this).open();
        }
      }
    });
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  async onunload() {
    if (this.isServerOpen) {
      this.isServerOpen.close(() => {
        new import_obsidian9.Notice(t("StopDrawioClinetServer"));
        this.isServerOpen = null;
      });
    }
  }
  async activateView() {
    const leaf = this.app.workspace.getLeaf(false);
    if (leaf) {
      await leaf.setViewState({
        type: DRAWIOVIEW,
        active: true
      });
      this.app.workspace.revealLeaf(leaf);
    }
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJjb25zdHMudHMiLCAidmlld3MvZHJhd2lvVmlldy50cyIsICJsb2NhbGVzL2VuLmpzb24iLCAibG9jYWxlcy9ydS5qc29uIiwgImxvY2FsZXMvaTE4bi50cyIsICJ1dGlscy9mb2xkZXJFeGlzdHMudHMiLCAiaGFuZGxlcnMvU2VydmVyU3RhcnQudHMiLCAic2V0dGluZ3MvU2V0dGluZ3MudHMiLCAic2V0dGluZ3MvU2V0dGluZ3MtdGFiLnRzIiwgInV0aWxzL2NlbnRlcmluZ0RpYWdyYW1zLnRzIiwgInV0aWxzL0RlZmF1bHREaWFncmFtU2l6ZS50cyIsICJoYW5kbGVycy9nZXRGaWxlQ29udGVudC50cyIsICJ1dGlscy9maW5kRmlsZUJ5TmFtZS50cyIsICJ1dGlscy9pbnRlcmFjdGl2ZURpYWdyYW1zLnRzIiwgImhhbmRsZXJzL2ZpbmREaWFncmFtRmlsZVVuZGVyQ3Vyc29yLnRzIiwgInZpZXdzL21vZGFsRHJhd2lvLnRzIiwgInV0aWxzL2ZvcmNlTWFya2Rvd25WaWV3VXBkYXRlLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBFZGl0b3IsIE1hcmtkb3duRWRpdFZpZXcsIE1hcmtkb3duVmlldywgTWVudSwgTm90aWNlLCBQbHVnaW4sIFRGaWxlLCBXb3Jrc3BhY2VMZWFmIH0gZnJvbSAnb2JzaWRpYW4nO1xuXG5pbXBvcnQgeyBEUkFXSU9WSUVXIH0gZnJvbSAnY29uc3RzJztcbmltcG9ydCB7IERyYXdpb3ZpZXcgfSBmcm9tICd2aWV3cy9kcmF3aW9WaWV3JztcbmltcG9ydCB7IHNldExvY2FsZSwgdCB9IGZyb20gJ2xvY2FsZXMvaTE4bic7XG5pbXBvcnQgeyBTZXJ2ZXIgfSBmcm9tICdub2RlOmh0dHAnO1xuaW1wb3J0IHsgbGF1bmNoRHJhd2lvU2VydmVyTG9naWMgfSBmcm9tICdoYW5kbGVycy9TZXJ2ZXJTdGFydCc7XG5pbXBvcnQgeyBEcmF3aW9TZXR0aW5ncywgREVGQVVMVF9TRVRUSU5HUyB9IGZyb20gJ3NldHRpbmdzL1NldHRpbmdzJztcbmltcG9ydCB7IERyYXdpb1RhYiB9IGZyb20gJ3NldHRpbmdzL1NldHRpbmdzLXRhYic7XG5pbXBvcnQgeyBDZW50ZXJpbmdEaWFncmFtcyB9IGZyb20gJ3V0aWxzL2NlbnRlcmluZ0RpYWdyYW1zJztcbmltcG9ydCB7IERlZmF1bHREaWFncmFtU2l6ZSB9IGZyb20gJ3V0aWxzL0RlZmF1bHREaWFncmFtU2l6ZSc7XG5pbXBvcnQgeyBJbnRlcmFjdGl2ZURpYWdyYW1zIH0gZnJvbSAndXRpbHMvaW50ZXJhY3RpdmVEaWFncmFtcyc7XG5pbXBvcnQgeyBmaW5kRGlhZ3JhbUZpbGVVbmRlckN1cnNvciB9IGZyb20gJ2hhbmRsZXJzL2ZpbmREaWFncmFtRmlsZVVuZGVyQ3Vyc29yJztcbmltcG9ydCB7IERyYXdpb0VtYmVkTW9kYWwgfSBmcm9tICd2aWV3cy9tb2RhbERyYXdpbyc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIERyYXdpb1BsdWdpbiBleHRlbmRzIFBsdWdpbiB7XG5cbmlzU2VydmVyT3BlbjogU2VydmVyIHwgbnVsbCA9IG51bGw7XG5zZXR0aW5nczogRHJhd2lvU2V0dGluZ3M7XG5cbiAgYXN5bmMgb25sb2FkKCkge1xuXG5cdGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XG5cdHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgRHJhd2lvVGFiKHRoaXMuYXBwLCB0aGlzKSk7XG5cblx0dGhpcy5yZWdpc3RlclZpZXcoXG5cdFx0RFJBV0lPVklFVyxcblx0XHQobGVhZikgPT4gbmV3IERyYXdpb3ZpZXcobGVhZiwgdGhpcykgXG5cdClcblx0XG5cdGNvbnN0IHVzZXJMYW5nID0gKHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnbGFuZ3VhZ2UnKSB8fCAnZW4nKS5zcGxpdCgnLScpWzBdO1xuXHRzZXRMb2NhbGUodXNlckxhbmcpO1xuXG5cdHRoaXMuYWRkUmliYm9uSWNvbignZGljZScsIHQoXCJyaWJvbkljb25UaXRsZVwiKSwgYXN5bmMgKCkgPT4ge1xuXHRcdHRoaXMuYWN0aXZhdGVWaWV3KClcblx0XHRhd2FpdCBsYXVuY2hEcmF3aW9TZXJ2ZXJMb2dpYyh0aGlzKVxuXHR9KSBcblxuXHRhd2FpdCBDZW50ZXJpbmdEaWFncmFtcyh0aGlzKVxuXHRhd2FpdCBEZWZhdWx0RGlhZ3JhbVNpemUodGhpcylcblx0YXdhaXQgSW50ZXJhY3RpdmVEaWFncmFtcyh0aGlzKVxuXG5cdHRoaXMucmVnaXN0ZXJFdmVudChcblx0XHR0aGlzLmFwcC53b3Jrc3BhY2Uub24oXCJlZGl0b3ItbWVudVwiLCAobWVudTogTWVudSwgZWRpdG9yOiBFZGl0b3IsIHZpZXc6IE1hcmtkb3duVmlldykgPT4ge1xuXHRcdFx0Y29uc3QgZmlsZVRvRWRpdCA9IGZpbmREaWFncmFtRmlsZVVuZGVyQ3Vyc29yKHRoaXMuYXBwLCBlZGl0b3IsIHZpZXcpO1xuXHRcdFx0Y29uc3Qgb3BlbkRyYXdpb01vZGFsID0gYXN5bmMgKGZpbGU/OiBURmlsZSkgPT4ge1xuICAgICAgICAgICAgICAgIGF3YWl0IGxhdW5jaERyYXdpb1NlcnZlckxvZ2ljKHRoaXMpOyBcbiAgICAgICAgICAgICAgICBuZXcgRHJhd2lvRW1iZWRNb2RhbCh0aGlzLmFwcCwgZWRpdG9yLCB0aGlzLCBmaWxlKS5vcGVuKCk7XG4gICAgICAgICAgICB9O1xuXG5cdFx0XHRpZihmaWxlVG9FZGl0KSB7XG5cdFx0XHRcdG1lbnUuYWRkSXRlbSgoaXRlbSkgPT4ge1xuXHRcdFx0XHRcdGl0ZW1cblx0XHRcdFx0XHRcdC5zZXRUaXRsZShgRWRpdCAke2ZpbGVUb0VkaXQuYmFzZW5hbWV9YClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zZXRJY29uKFwicGVuY2lsXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuc2V0U2VjdGlvbihcImRyYXdpby1hY3Rpb25zXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiBvcGVuRHJhd2lvTW9kYWwoZmlsZVRvRWRpdCkpO1xuXHRcdFx0XHR9KVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0bWVudS5hZGRJdGVtKChpdGVtKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW1cbiAgICAgICAgICAgICAgICAgICAgICAgIC5zZXRUaXRsZShcIkVtYmVkIE5ldyBEcmF3LmlvIERpYWdyYW1cIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zZXRJY29uKFwic2hhcGVzXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuc2V0U2VjdGlvbihcImRyYXdpby1hY3Rpb25zXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiBvcGVuRHJhd2lvTW9kYWwoKSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXHRcdFx0fVxuXHRcdH0pXG5cdClcblxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6ICdkcmF3aW8tY3JlYXRlLW9yLWVkaXQnLFxuICAgICAgICAgICAgbmFtZTogJ0NyZWF0ZSBvciBlZGl0IERyYXcuaW8gZGlhZ3JhbScsXG4gICAgICAgICAgICBlZGl0b3JDYWxsYmFjazogYXN5bmMgKGVkaXRvcjogRWRpdG9yLCB2aWV3OiBNYXJrZG93blZpZXcpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBmaWxlVG9FZGl0ID0gZmluZERpYWdyYW1GaWxlVW5kZXJDdXJzb3IodGhpcy5hcHAsIGVkaXRvciwgdmlldyk7IFxuICAgICAgICAgICAgICAgIGF3YWl0IGxhdW5jaERyYXdpb1NlcnZlckxvZ2ljKHRoaXMpOyBcblxuICAgICAgICAgICAgICAgIGlmIChmaWxlVG9FZGl0KSB7XG4gICAgICAgICAgICAgICAgICAgIG5ldyBEcmF3aW9FbWJlZE1vZGFsKHRoaXMuYXBwLCBlZGl0b3IsIHRoaXMsIGZpbGVUb0VkaXQpLm9wZW4oKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBuZXcgRHJhd2lvRW1iZWRNb2RhbCh0aGlzLmFwcCwgZWRpdG9yLCB0aGlzKS5vcGVuKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgfVxuXG5cbmFzeW5jIGxvYWRTZXR0aW5ncygpIHtcblx0dGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MsIGF3YWl0IHRoaXMubG9hZERhdGEoKSk7XG59XG5cbmFzeW5jIHNhdmVTZXR0aW5ncygpIHtcblx0YXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcbn1cblxuICBhc3luYyBvbnVubG9hZCgpIHtcblx0aWYgKHRoaXMuaXNTZXJ2ZXJPcGVuKSB7XG4gICAgICAgIHRoaXMuaXNTZXJ2ZXJPcGVuLmNsb3NlKCgpID0+IHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UodChcIlN0b3BEcmF3aW9DbGluZXRTZXJ2ZXJcIikpO1xuICAgICAgICAgICAgdGhpcy5pc1NlcnZlck9wZW4gPSBudWxsO1xuICAgICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBhY3RpdmF0ZVZpZXcoKSB7XG5cdGNvbnN0IGxlYWYgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhZihmYWxzZSk7XG5cdGlmKGxlYWYpIHtcblx0XHRhd2FpdCBsZWFmLnNldFZpZXdTdGF0ZSh7XG5cdFx0dHlwZTogRFJBV0lPVklFVyxcblx0XHRhY3RpdmU6IHRydWUsXG4gICAgfSk7XG4gICAgdGhpcy5hcHAud29ya3NwYWNlLnJldmVhbExlYWYobGVhZik7XG5cdH1cbiAgfVxufSIsICJleHBvcnQgY29uc3QgRFJBV0lPVklFVyA9ICdkcmF3aW92aWV3JzsiLCAiaW1wb3J0IHsgQXBwLCBGaWxlU3lzdGVtQWRhcHRlciwgSXRlbVZpZXcsIFRGaWxlLCBXb3Jrc3BhY2VMZWFmIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5cclxuaW1wb3J0IHsgRFJBV0lPVklFVyB9IGZyb20gJ2NvbnN0cyc7XHJcbmltcG9ydCB7IHQgfSBmcm9tICdsb2NhbGVzL2kxOG4nO1xyXG5pbXBvcnQgRHJhd2lvUGx1Z2luIGZyb20gJ21haW4nOyAvLyBNYWtlIHN1cmUgdG8gaW1wb3J0IERyYXdpb1BsdWdpblxyXG5pbXBvcnQgeyBERUZBVUxUX1NFVFRJTkdTIH0gZnJvbSAnc2V0dGluZ3MvU2V0dGluZ3MnO1xyXG5pbXBvcnQgeyBmb2xkZXJFeGlzdHMgfSBmcm9tICd1dGlscy9mb2xkZXJFeGlzdHMnO1xyXG5cclxuZXhwb3J0IGNsYXNzIERyYXdpb3ZpZXcgZXh0ZW5kcyBJdGVtVmlldyB7XHJcbiAgICBwdWJsaWMgaWZyYW1lOiBIVE1MSUZyYW1lRWxlbWVudCB8IG51bGwgPSBudWxsO1xyXG4gICAgcHJpdmF0ZSBtZXNzYWdlSGFuZGxlcjogKGV2ZW50OiBNZXNzYWdlRXZlbnQpID0+IHZvaWQ7XHJcbiAgICBwdWJsaWMgcGx1Z2luOiBEcmF3aW9QbHVnaW47XHJcblxyXG4gICAgY29uc3RydWN0b3IobGVhZjogV29ya3NwYWNlTGVhZiwgcGx1Z2luOiBEcmF3aW9QbHVnaW4pIHtcclxuICAgICAgICBzdXBlcihsZWFmKTtcclxuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuICAgICAgICB0aGlzLm1lc3NhZ2VIYW5kbGVyID0gdGhpcy5saXN0ZW5kcmF3aW9tZXNzYWdlLmJpbmQodGhpcyk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0Vmlld1R5cGUoKSB7XHJcbiAgICAgICAgcmV0dXJuIERSQVdJT1ZJRVc7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0RGlzcGxheVRleHQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHQoXCJEcmF3SW9WaWV3TmFtZVwiKTtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBvbk9wZW4oKSB7XHJcbiAgICAgICAgY29uc3QgY29udGFpbmVyID0gdGhpcy5jb250YWluZXJFbC5jaGlsZHJlblsxXTtcclxuXHJcbiAgICAgICAgY29udGFpbmVyLmVtcHR5KCk7XHJcbiAgICAgICAgY29udGFpbmVyLmNyZWF0ZUVsKCdpZnJhbWUnLCB7YXR0cjoge2lkOiAnZHJhd2lvaWZyYW1lJywgc3JjOiBgaHR0cDovL2xvY2FsaG9zdDoke3RoaXMucGx1Z2luLnNldHRpbmdzLnBvcnR9P2VtYmVkPTEmcHJvdG89anNvbiZ1aT1kYXJrYH19KVxyXG4gICAgICAgICAgLmFkZENsYXNzKCdkcmF3aW9JZnJhbWUnKVxyXG4gICAgICAgIHRoaXMuaWZyYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RyYXdpb2lmcmFtZScpIGFzIEhUTUxJRnJhbWVFbGVtZW50O1xyXG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgdGhpcy5tZXNzYWdlSGFuZGxlcik7XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgbGlzdGVuZHJhd2lvbWVzc2FnZShldmVudDogTWVzc2FnZUV2ZW50KSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3QgbXNnID0gSlNPTi5wYXJzZShldmVudC5kYXRhKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHN3aXRjaCAobXNnLmV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdpbml0JzpcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmlmcmFtZT8uY29udGVudFdpbmRvdz8ucG9zdE1lc3NhZ2UoSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb246ICdsb2FkJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgeG1sOiAnPG14R3JhcGhNb2RlbD48cm9vdD4uLi48L3Jvb3Q+PC9teEdyYXBoTW9kZWw+JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICdleGFtcGxlLmRyYXdpbydcclxuICAgICAgICAgICAgICAgICAgICB9KSwgYGh0dHA6Ly9sb2NhbGhvc3Q6JHt0aGlzLnBsdWdpbi5zZXR0aW5ncy5wb3J0fWApO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgJ3NhdmUnOlxyXG4gICAgICAgICAgICAgICAgdGhpcy5pZnJhbWU/LmNvbnRlbnRXaW5kb3c/LnBvc3RNZXNzYWdlKEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgICAgICAgICAgICBhY3Rpb246ICdleHBvcnQnLFxyXG4gICAgICAgICAgICAgICAgICAgIGZvcm1hdDogXCJ4bWxzdmdcIixcclxuICAgICAgICAgICAgICAgICAgICB4bWw6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgfSksIGBodHRwOi8vbG9jYWxob3N0OiR7dGhpcy5wbHVnaW4uc2V0dGluZ3MucG9ydH1gKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnXHUwNDE0XHUwNDM4XHUwNDMwXHUwNDMzXHUwNDQwXHUwNDMwXHUwNDNDXHUwNDNDXHUwNDMwIFx1MDQ0MVx1MDQzRVx1MDQ0NVx1MDQ0MFx1MDQzMFx1MDQzRFx1MDQzNVx1MDQzRFx1MDQzMDonLCBtc2cpOyAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgXCJleHBvcnRcIjoge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHN2Z0Jhc2U2NCA9IG1zZy5kYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHN2ZzY0RGF0YSA9IHN2Z0Jhc2U2NC5yZXBsYWNlKC9eZGF0YTppbWFnZVxcL3N2Z1xcK3htbDtiYXNlNjQsLywgJycpXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3ZnQ29udGVudCA9IGF0b2Ioc3ZnNjREYXRhKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB0aW1lc3RhbXAgPSBgJHtub3cuZ2V0RnVsbFllYXIoKX0keyhub3cuZ2V0TW9udGgoKSArIDEpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKX0ke25vdy5nZXREYXRlKCkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpfSR7bm93LmdldEhvdXJzKCkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpfSR7bm93LmdldE1pbnV0ZXMoKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyl9JHtub3cuZ2V0U2Vjb25kcygpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKX1gO1xyXG4gICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIGlmKGZvbGRlckV4aXN0cyh0aGlzLmFwcCwgdGhpcy5wbHVnaW4uc2V0dGluZ3MuRm9sZGVyKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFwcC52YXVsdC5jcmVhdGUoYCR7dGhpcy5wbHVnaW4uc2V0dGluZ3MuRm9sZGVyfS9kcmF3aW9fJHt0aW1lc3RhbXB9LmRyYXdpby5zdmdgLCBzdmdDb250ZW50KVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwLnZhdWx0LmNyZWF0ZShgL2RyYXdpb18ke3RpbWVzdGFtcH0uZHJhd2lvLnN2Z2AsIHN2Z0NvbnRlbnQpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSAnZXhpdCc6XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1x1MDQyMFx1MDQzNVx1MDQzNFx1MDQzMFx1MDQzQVx1MDQ0Mlx1MDQzRVx1MDQ0MCBcdTA0MzdcdTA0MzBcdTA0M0FcdTA0NDBcdTA0NEJcdTA0NDInKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgY29uc29sZS53YXJuKCdcdTA0MURcdTA0MzVcdTA0M0FcdTA0M0VcdTA0NDBcdTA0NDBcdTA0MzVcdTA0M0FcdTA0NDJcdTA0M0RcdTA0NEJcdTA0MzkgSlNPTiBcdTA0MzIgXHUwNDQxXHUwNDNFXHUwNDNFXHUwNDMxXHUwNDQ5XHUwNDM1XHUwNDNEXHUwNDM4XHUwNDM4OicsIGV2ZW50LmRhdGEpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBvbkNsb3NlKCkge1xyXG4gICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgdGhpcy5tZXNzYWdlSGFuZGxlcik7XHJcbiAgICB9XHJcbn0iLCAie1xyXG4gICAgXCJEcmF3SW9WaWV3TmFtZVwiOiBcImRyYXcuaW8gZWRpdG9yXCIsXHJcbiAgICBcInJpYm9uSWNvblRpdGxlXCI6IFwib3BlbiBkcmF3LmlvIGVkaXRvclwiLFxyXG4gICAgXCJTdGFydERyYXdpb0NsaWVudFNldmVyXCI6IFwiRHJhdy5pbyBzZXJ2ZXIgc3RhcnRlZCBvbiBwb3J0XCIsXHJcbiAgICBcIlN0b3BEcmF3aW9DbGluZXRTZXJ2ZXJcIjogXCJEcmF3LmlvIHNlcnZlciBzdG9wcGVkXCJcclxufVxyXG4iLCAie1xyXG4gICAgXCJEcmF3SW9WaWV3TmFtZVwiOiBcIlx1MDQyMFx1MDQzNVx1MDQzNFx1MDQzMFx1MDQzQVx1MDQ0Mlx1MDQzRVx1MDQ0MCBkcmF3LmlvXCIsXHJcbiAgICBcInJpYm9uSWNvblRpdGxlXCI6IFwiXHUwNDFFXHUwNDQyXHUwNDNBXHUwNDQwXHUwNDRCXHUwNDQyXHUwNDRDIFx1MDQ0MFx1MDQzNVx1MDQzNFx1MDQzMFx1MDQzQVx1MDQ0Mlx1MDQzRVx1MDQ0MCBkcmF3LmlvXCIsXHJcbiAgICBcIlN0YXJ0RHJhd2lvQ2xpZW50U2V2ZXJcIjogXCJcdTA0MjFcdTA0MzVcdTA0NDBcdTA0MzVcdTA0MzJcdTA0MzVcdTA0NDAgXHUwNDM3XHUwNDMwXHUwNDNGXHUwNDQzXHUwNDQxXHUwNDQyXHUwNDM4XHUwNDNCXHUwNDMwIFx1MDQzRFx1MDQzMCBcdTA0M0ZcdTA0M0VcdTA0NDBcdTA0NDJcdTA0NDNcIixcclxuICAgIFwiU3RvcERyYXdpb0NsaW5ldFNlcnZlclwiOiBcIlx1MDQyMVx1MDQzNVx1MDQ0MFx1MDQzNVx1MDQzMlx1MDQ0MCBkcmF3aW8gXHUwNDNFXHUwNDQxXHUwNDQyXHUwNDMwXHUwNDNEXHUwNDNFXHUwNDMyXHUwNDNCXHUwNDM1XHUwNDNEXCJcclxufVxyXG4iLCAiaW1wb3J0IGVuIGZyb20gJy4vZW4uanNvbic7XHJcbmltcG9ydCBydSBmcm9tICcuL3J1Lmpzb24nO1xyXG5cclxudHlwZSBUcmFuc2xhdGlvbnMgPSB0eXBlb2YgZW47XHJcblxyXG5jb25zdCBsb2NhbGVzOiBSZWNvcmQ8c3RyaW5nLCBUcmFuc2xhdGlvbnM+ID0ge1xyXG4gIGVuLFxyXG4gIHJ1LFxyXG59O1xyXG5cclxubGV0IGN1cnJlbnRMb2NhbGU6IHN0cmluZyA9IFwiZW5cIjtcclxubGV0IHRyYW5zbGF0aW9uczogVHJhbnNsYXRpb25zID0gZW47XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gc2V0TG9jYWxlKGxvY2FsZTogc3RyaW5nKSB7XHJcbiAgY3VycmVudExvY2FsZSA9IGxvY2FsZSBpbiBsb2NhbGVzID8gbG9jYWxlIDogXCJlblwiO1xyXG4gIHRyYW5zbGF0aW9ucyA9IGxvY2FsZXNbY3VycmVudExvY2FsZV07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB0KGtleToga2V5b2YgVHJhbnNsYXRpb25zKTogc3RyaW5nIHtcclxuICByZXR1cm4gdHJhbnNsYXRpb25zW2tleV0gfHwga2V5O1xyXG59IiwgImltcG9ydCB7IEFwcCwgVEZvbGRlciwgbm9ybWFsaXplUGF0aCB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGZvbGRlckV4aXN0cyhhcHA6IEFwcCwgcGF0aDogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgY29uc3Qgbm9ybWFsaXplZCA9IG5vcm1hbGl6ZVBhdGgocGF0aCk7XHJcbiAgY29uc3QgZm9sZGVyID0gYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChub3JtYWxpemVkKTtcclxuXHJcbiAgcmV0dXJuIGZvbGRlciBpbnN0YW5jZW9mIFRGb2xkZXI7XHJcbn1cclxuIiwgImltcG9ydCB7IEluY29taW5nTWVzc2FnZSwgU2VydmVyLCBTZXJ2ZXJSZXNwb25zZSB9IGZyb20gXCJodHRwXCI7XHJcbmltcG9ydCB7IHQgfSBmcm9tIFwibG9jYWxlcy9pMThuXCI7XHJcbmltcG9ydCBEcmF3aW9QbHVnaW4gZnJvbSBcIm1haW5cIjtcclxuaW1wb3J0IHsgQXBwLCBOb3RpY2UgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuXHJcbmNvbnN0IGh0dHAgPSByZXF1aXJlKCdodHRwJyk7XHJcbmNvbnN0IGZzID0gcmVxdWlyZSgnZnMnKTtcclxuY29uc3QgcGF0aCA9IHJlcXVpcmUoJ3BhdGgnKTtcclxuXHJcblxyXG5mdW5jdGlvbiBnZXREcmF3aW9QYXRocyhhcHA6IEFwcCwgbWFuaWZlc3REaXI6IHN0cmluZykge1xyXG4gICAgY29uc3QgdmF1bHRCYXNlUGF0aCA9IChhcHAudmF1bHQuYWRhcHRlciBhcyBhbnkpLmJhc2VQYXRoIGFzIHN0cmluZztcclxuICAgIGNvbnN0IHBsdWdpbkRpciA9IHBhdGguam9pbih2YXVsdEJhc2VQYXRoLCBtYW5pZmVzdERpcik7XHJcbiAgICBjb25zdCB3ZWJBcHBQYXRoID0gcGF0aC5qb2luKHBsdWdpbkRpciwgXCJ3ZWJhcHBcIik7XHJcbiAgICByZXR1cm4geyB2YXVsdEJhc2VQYXRoLCBwbHVnaW5EaXIsIHdlYkFwcFBhdGggfTtcclxufVxyXG5cclxuZnVuY3Rpb24gc2VydmVyU3RhcnQocGx1Z2luOiBEcmF3aW9QbHVnaW4sIHdlYkFwcFBhdGg6IHN0cmluZywgcG9ydDogbnVtYmVyKTogUHJvbWlzZTxTZXJ2ZXI+IHtcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgICAgY29uc3Qgc2VydmVyID0gaHR0cC5jcmVhdGVTZXJ2ZXIoKHJlcTogSW5jb21pbmdNZXNzYWdlLCByZXM6IFNlcnZlclJlc3BvbnNlKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlcXVlc3RVcmwgPSBuZXcgVVJMKHJlcS51cmwgfHwgJycsIGBodHRwOi8vJHtyZXEuaGVhZGVycy5ob3N0fWApO1xyXG4gICAgICAgICAgICBjb25zdCBmaWxlUGF0aCA9IHBhdGguam9pbihcclxuICAgICAgICAgICAgICB3ZWJBcHBQYXRoLFxyXG4gICAgICAgICAgICAgIHJlcXVlc3RVcmwucGF0aG5hbWUgPT09ICcvJyA/ICdpbmRleC5odG1sJyA6IHJlcXVlc3RVcmwucGF0aG5hbWVcclxuICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgICAgIGlmICghZmlsZVBhdGguc3RhcnRzV2l0aCh3ZWJBcHBQYXRoKSkge1xyXG4gICAgICAgICAgICAgICAgcmVzLndyaXRlSGVhZCg0MDMsIHsgJ0NvbnRlbnQtVHlwZSc6ICd0ZXh0L3BsYWluJyB9KTtcclxuICAgICAgICAgICAgICAgIHJlcy5lbmQoJzQwMyBGb3JiaWRkZW4nKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZnMucmVhZEZpbGUoZmlsZVBhdGgsIChlcnI6IE5vZGVKUy5FcnJub0V4Y2VwdGlvbiB8IG51bGwsIGRhdGE6IHN0cmluZykgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlcnIuY29kZSA9PT0gJ0VOT0VOVCcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzLndyaXRlSGVhZCg0MDQsIHsgJ0NvbnRlbnQtVHlwZSc6ICd0ZXh0L3BsYWluJyB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzLmVuZCgnNDA0IE5vdCBGb3VuZCcpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcy53cml0ZUhlYWQoNTAwLCB7ICdDb250ZW50LVR5cGUnOiAndGV4dC9wbGFpbicgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcy5lbmQoYDUwMCBJbnRlcm5hbCBTZXJ2ZXIgRXJyb3I6ICR7ZXJyLm1lc3NhZ2V9YCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBleHQgPSBwYXRoLmV4dG5hbWUoZmlsZVBhdGgpLnRvTG93ZXJDYXNlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnRlbnRUeXBlID0gJ2FwcGxpY2F0aW9uL29jdGV0LXN0cmVhbSc7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoZXh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJy5odG1sJzogY29udGVudFR5cGUgPSAndGV4dC9odG1sJzsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJy5qcyc6IGNvbnRlbnRUeXBlID0gJ2FwcGxpY2F0aW9uL2phdmFzY3JpcHQnOyBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnLmNzcyc6IGNvbnRlbnRUeXBlID0gJ3RleHQvY3NzJzsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJy5qc29uJzogY29udGVudFR5cGUgPSAnYXBwbGljYXRpb24vanNvbic7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICcucG5nJzogY29udGVudFR5cGUgPSAnaW1hZ2UvcG5nJzsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJy5qcGcnOiBjb250ZW50VHlwZSA9ICdpbWFnZS9qcGVnJzsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJy5naWYnOiBjb250ZW50VHlwZSA9ICdpbWFnZS9naWYnOyBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnLnN2Zyc6IGNvbnRlbnRUeXBlID0gJ2ltYWdlL3N2Zyt4bWwnOyBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnLndvZmYnOiBjb250ZW50VHlwZSA9ICdmb250L3dvZmYnOyBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnLndvZmYyJzogY29udGVudFR5cGUgPSAnZm9udC93b2ZmMic7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICcudHRmJzogY29udGVudFR5cGUgPSAnZm9udC90dGYnOyBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnLmljbyc6IGNvbnRlbnRUeXBlID0gJ2ltYWdlL3gtaWNvbic7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXMud3JpdGVIZWFkKDIwMCwgeyAnQ29udGVudC1UeXBlJzogY29udGVudFR5cGUgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzLmVuZChkYXRhKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHNlcnZlci5saXN0ZW4ocG9ydCwgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBwb3J0ID0gcGx1Z2luLnNldHRpbmdzLnBvcnQ7XHJcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoYCR7dChcIlN0YXJ0RHJhd2lvQ2xpZW50U2V2ZXJcIil9ICR7cG9ydH1gKTtcclxuICAgICAgICAgICAgcmVzb2x2ZShzZXJ2ZXIpO1xyXG4gICAgICAgIH0pLm9uKCdlcnJvcicsIChlcnI6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZXJyLmNvZGUgPT09ICdFQUREUklOVVNFJykge1xyXG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZShgXHUyNzRDIFx1MDQxRlx1MDQzRVx1MDQ0MFx1MDQ0MiAke3BvcnR9IFx1MDQ0M1x1MDQzNlx1MDQzNSBcdTA0MzdcdTA0MzBcdTA0M0RcdTA0NEZcdTA0NDIuIFx1MDQyMVx1MDQzNVx1MDQ0MFx1MDQzMlx1MDQzNVx1MDQ0MCBEcmF3LmlvIFx1MDQzRFx1MDQzNSBcdTA0MzdcdTA0MzBcdTA0M0ZcdTA0NDNcdTA0NDlcdTA0MzVcdTA0M0QuYCk7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGBcdTA0MUZcdTA0M0VcdTA0NDBcdTA0NDIgJHtwb3J0fSBcdTA0NDNcdTA0MzZcdTA0MzUgXHUwNDM3XHUwNDMwXHUwNDNEXHUwNDRGXHUwNDQyLmApO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZShgXHUyNzRDIFx1MDQxRFx1MDQzNSBcdTA0NDNcdTA0MzRcdTA0MzBcdTA0M0JcdTA0M0VcdTA0NDFcdTA0NEMgXHUwNDM3XHUwNDMwXHUwNDNGXHUwNDQzXHUwNDQxXHUwNDQyXHUwNDM4XHUwNDQyXHUwNDRDIFx1MDQ0MVx1MDQzNVx1MDQ0MFx1MDQzMlx1MDQzNVx1MDQ0MCBEcmF3LmlvOiAke2Vyci5tZXNzYWdlfWApO1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihgXHUwNDFEXHUwNDM1IFx1MDQ0M1x1MDQzNFx1MDQzMFx1MDQzQlx1MDQzRVx1MDQ0MVx1MDQ0QyBcdTA0MzdcdTA0MzBcdTA0M0ZcdTA0NDNcdTA0NDFcdTA0NDJcdTA0MzhcdTA0NDJcdTA0NEMgXHUwNDQxXHUwNDM1XHUwNDQwXHUwNDMyXHUwNDM1XHUwNDQwIERyYXcuaW86YCwgZXJyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZWplY3QoZXJyKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbGF1bmNoRHJhd2lvU2VydmVyTG9naWMocGx1Z2luOiBEcmF3aW9QbHVnaW4pOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIGlmIChwbHVnaW4uaXNTZXJ2ZXJPcGVuKSByZXR1cm47XHJcblxyXG4gICAgY29uc3QgUE9SVCA9IHBsdWdpbi5zZXR0aW5ncy5wb3J0XHJcblxyXG4gICAgY29uc3QgeyB3ZWJBcHBQYXRoIH0gPSBnZXREcmF3aW9QYXRocyhwbHVnaW4uYXBwLCBwbHVnaW4ubWFuaWZlc3QuZGlyISk7XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgICBwbHVnaW4uaXNTZXJ2ZXJPcGVuID0gYXdhaXQgc2VydmVyU3RhcnQocGx1Z2luLCB3ZWJBcHBQYXRoLCBOdW1iZXIoUE9SVCkpO1xyXG4gICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKChyZXMpID0+IHNldFRpbWVvdXQocmVzLCAxMDAwKSk7XHJcbiAgICAgICAgY29uc29sZS5sb2cocGx1Z2luLnNldHRpbmdzLnBvcnQpXHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIHBsdWdpbi5pc1NlcnZlck9wZW4gPSBudWxsO1xyXG4gICAgfVxyXG59IiwgImltcG9ydCB7IFRGb2xkZXIgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgRHJhd2lvU2V0dGluZ3Mge1xyXG4gIHBvcnQ6IHN0cmluZztcclxuICBjZW50ZXJpbmdEaWFncmFtOiBib29sZWFuO1xyXG4gIHBlcmNlbnRTaXplOiBib29sZWFuO1xyXG4gIGludGVyYWN0aXZlRGlhZ3JhbTogYm9vbGVhbjtcclxuICB1c2VNYXJrZG93bkxpbmtzOiBib29sZWFuO1xyXG4gIEZvbGRlcjogc3RyaW5nO1xyXG4gIGRpYWdyYW1TaXplOiBzdHJpbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBERUZBVUxUX1NFVFRJTkdTOiBQYXJ0aWFsPERyYXdpb1NldHRpbmdzPiA9IHtcclxuICBwb3J0OiAnMTcxNycsXHJcbiAgY2VudGVyaW5nRGlhZ3JhbTogdHJ1ZSxcclxuICBwZXJjZW50U2l6ZTogdHJ1ZSxcclxuICBpbnRlcmFjdGl2ZURpYWdyYW06IHRydWUsXHJcbiAgdXNlTWFya2Rvd25MaW5rczogZmFsc2UsXHJcbiAgRm9sZGVyOiAnZHJhd2lvJyxcclxuICBkaWFncmFtU2l6ZTogJycsXHJcbn07IiwgImltcG9ydCBEcmF3aW9QbHVnaW4gZnJvbSBcIm1haW5cIjtcclxuaW1wb3J0IHsgQXBwLCBEcm9wZG93bkNvbXBvbmVudCwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZywgVEZvbGRlciB9IGZyb20gJ29ic2lkaWFuJztcclxuXHJcbmV4cG9ydCBjbGFzcyBEcmF3aW9UYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcclxuICBwbHVnaW46IERyYXdpb1BsdWdpbjtcclxuXHJcbiAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogRHJhd2lvUGx1Z2luKSB7XHJcbiAgICBzdXBlcihhcHAsIHBsdWdpbik7XHJcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuICB9XHJcblxyXG4gIGRpc3BsYXkoKTogdm9pZCB7XHJcbiAgICBsZXQgeyBjb250YWluZXJFbCB9ID0gdGhpcztcclxuXHJcbiAgICBjb250YWluZXJFbC5lbXB0eSgpO1xyXG5cclxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAuc2V0TmFtZSgnU2V0IHBvcnQnKVxyXG4gICAgICAuc2V0RGVzYygnU2V0IHBvcnQnKVxyXG4gICAgICAuYWRkVGV4dCgodGV4dCkgPT5cclxuICAgICAgICB0ZXh0XHJcbiAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJzE3MTcnKVxyXG4gICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnBvcnQpXHJcbiAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnBvcnQgPSB2YWx1ZTtcclxuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICApO1xyXG5cclxuICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgIC5zZXROYW1lKCdDZW50ZXJpbmcgRGlhZ3JhbScpXHJcbiAgICAgIC5zZXREZXNjKCdJZiBhY3RpdmUgYWxsIGRpYWdyYW0gd2lsbCBiZSBwb3NpdGlvbiB0byBjZW50ZXInKVxyXG4gICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+IFxyXG4gICAgICAgIHRvZ2dsZVxyXG4gICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmNlbnRlcmluZ0RpYWdyYW0pXHJcbiAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmNlbnRlcmluZ0RpYWdyYW0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICApO1xyXG5cclxuICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgIC5zZXROYW1lKCdQZXJjZW50IHNpemUnKVxyXG4gICAgICAuc2V0RGVzYygnUGVyY2VudCBTaXplJylcclxuICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PiBcclxuICAgICAgICB0b2dnbGVcclxuICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5wZXJjZW50U2l6ZSlcclxuICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucGVyY2VudFNpemUgPSB2YWx1ZTtcclxuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICApO1xyXG5cclxuICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgIC5zZXROYW1lKCdJbnRlcmFjdGl2ZSBkaWFncmFtcycpXHJcbiAgICAgIC5zZXREZXNjKCdJbnRlcmFjdGl2ZSBkaWFncmFtcycpXHJcbiAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT4gXHJcbiAgICAgICAgdG9nZ2xlXHJcbiAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuaW50ZXJhY3RpdmVEaWFncmFtKVxyXG4gICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5pbnRlcmFjdGl2ZURpYWdyYW0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICApO1xyXG5cclxuICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgIC5zZXROYW1lKCdVc2UgbWFya2Rvd24gTGlua3MnKVxyXG4gICAgICAuc2V0RGVzYygnSWYgZW5hYmxlIGxpbmsgd2lsbCBiZSBtYXJrZG93biBsaW5rIHN0eWxlJylcclxuICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PiBcclxuICAgICAgICB0b2dnbGVcclxuICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy51c2VNYXJrZG93bkxpbmtzKVxyXG4gICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy51c2VNYXJrZG93bkxpbmtzID0gdmFsdWU7XHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgKTtcclxuXHJcbiAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAuc2V0TmFtZSgnU2VsZWN0IGZvbGRlcicpXHJcbiAgICAgIC5zZXREZXNjKCdTZWxlY3QgZm9sZGVyIHRoYXQgc2F2ZSBkaWFncmFtcycpXHJcbiAgICAgIC5hZGREcm9wZG93bihkcm9wZG93biA9PiB7XHJcbiAgICAgICAgY29uc3QgZm9sZGVycyA9IHRoaXMuYXBwLnZhdWx0LmdldEFsbExvYWRlZEZpbGVzKCkuZmlsdGVyKGZpbGUgPT4gZmlsZSBpbnN0YW5jZW9mIFRGb2xkZXIpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGZvbGRlcnMuZm9yRWFjaCgoZm9sZGVyOiBURm9sZGVyKSA9PiB7XHJcbiAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbihmb2xkZXIucGF0aCwgZm9sZGVyLnBhdGgpO1xyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIGRyb3Bkb3duLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLkZvbGRlcik7XHJcblxyXG4gICAgICAgIGRyb3Bkb3duLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5Gb2xkZXIgPSB2YWx1ZTtcclxuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgICAgKTtcclxuXHJcbiAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAuc2V0TmFtZSgnZGlhZ3JhbSB3aWR0aCcpXHJcbiAgICAgIC5zZXREZXNjKCdTZXQgZGVmYXVsdCBkaWFncmFtIHNpemUnKVxyXG4gICAgICAuYWRkVGV4dCgodGV4dCkgPT5cclxuICAgICAgICB0ZXh0XHJcbiAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJzEwMCUnKVxyXG4gICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmRpYWdyYW1TaXplKVxyXG4gICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5kaWFncmFtU2l6ZSA9IHZhbHVlO1xyXG4gICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgIH0pXHJcbiAgICAgICk7XHJcbiAgfVxyXG59IiwgImltcG9ydCBEcmF3aW9QbHVnaW4gZnJvbSBcIm1haW5cIjtcclxuaW1wb3J0IHsgTWFya2Rvd25Qb3N0UHJvY2Vzc29yIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gQ2VudGVyaW5nRGlhZ3JhbXMocGx1Z2luOiBEcmF3aW9QbHVnaW4pIHtcclxuICAgIGlmKCFwbHVnaW4uc2V0dGluZ3MuY2VudGVyaW5nRGlhZ3JhbSkge1xyXG4gICAgICAgIHJldHVyblxyXG4gICAgfSBlbHNlIHtcclxuICBwbHVnaW4ucmVnaXN0ZXJNYXJrZG93blBvc3RQcm9jZXNzb3IoKGVsLCBjdHgpID0+IHtcclxuICBjb25zdCBlbWJlZHMgPSBlbC5xdWVyeVNlbGVjdG9yQWxsKCdzcGFuLmludGVybmFsLWVtYmVkW3NyYyQ9XCIuZHJhd2lvLnN2Z1wiXScpO1xyXG5cclxuICBlbWJlZHMuZm9yRWFjaCgoZW1iZWQpID0+IHtcclxuICAgIGNvbnN0IHdyYXBwZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIHdyYXBwZXIuc3R5bGUudGV4dEFsaWduID0gJ2NlbnRlcic7XHJcbiAgICB3cmFwcGVyLnN0eWxlLndpZHRoID0gJzEwMCUnO1xyXG5cclxuICAgIC8vIFx1MDQxRFx1MDQzMFx1MDQzOVx1MDQ0Mlx1MDQzOCA8aW1nPiBcdTA0MzJcdTA0M0RcdTA0NDNcdTA0NDJcdTA0NDBcdTA0MzggPHNwYW4+XHJcbiAgICBjb25zdCBpbWcgPSBlbWJlZC5xdWVyeVNlbGVjdG9yKCdpbWcnKTtcclxuICAgIGlmIChpbWcpIHtcclxuICAgICAgaW1nLnN0eWxlLndpZHRoID0gJzEwMCUnO1xyXG4gICAgICBpbWcuc3R5bGUuaGVpZ2h0ID0gJ2F1dG8nOyAvLyBcdTA0NDdcdTA0NDJcdTA0M0VcdTA0MzFcdTA0NEIgXHUwNDNEXHUwNDM1IFx1MDQzOFx1MDQ0MVx1MDQzQVx1MDQzMFx1MDQzNlx1MDQzMFx1MDQzQlx1MDQzRVx1MDQ0MVx1MDQ0QyBcdTA0MzhcdTA0MzdcdTA0M0VcdTA0MzFcdTA0NDBcdTA0MzBcdTA0MzZcdTA0MzVcdTA0M0RcdTA0MzhcdTA0MzVcclxuICAgICAgaW1nLnN0eWxlLm1heFdpZHRoID0gJzEwMCUnOyAvLyBcdTA0M0RcdTA0MzAgXHUwNDMyXHUwNDQxXHUwNDRGXHUwNDNBXHUwNDM4XHUwNDM5IFx1MDQ0MVx1MDQzQlx1MDQ0M1x1MDQ0N1x1MDQzMFx1MDQzOVxyXG4gICAgfVxyXG5cclxuICAgIC8vIFx1MDQxRVx1MDQzMVx1MDQzNVx1MDQ0MFx1MDQzRFx1MDQ0M1x1MDQ0Mlx1MDQ0QyA8c3Bhbj4gXHUwNDMyIDxkaXY+XHJcbiAgICBpZiAoZW1iZWQucGFyZW50RWxlbWVudCAmJiBlbWJlZC5wYXJlbnRFbGVtZW50LnRhZ05hbWUgPT09ICdESVYnKSByZXR1cm47XHJcbiAgICBlbWJlZC5wYXJlbnRFbGVtZW50Py5pbnNlcnRCZWZvcmUod3JhcHBlciwgZW1iZWQpO1xyXG4gICAgd3JhcHBlci5hcHBlbmRDaGlsZChlbWJlZCk7XHJcbiAgfSk7XHJcbn0pO1xyXG5cclxuICAgIH07XHJcbn0iLCAiaW1wb3J0IERyYXdpb1BsdWdpbiBmcm9tIFwibWFpblwiO1xyXG5pbXBvcnQgeyBNYXJrZG93blBvc3RQcm9jZXNzb3IgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBEZWZhdWx0RGlhZ3JhbVNpemUocGx1Z2luOiBEcmF3aW9QbHVnaW4pIHtcclxuICAgIGlmKCFwbHVnaW4uc2V0dGluZ3MucGVyY2VudFNpemUpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHBsdWdpbi5yZWdpc3Rlck1hcmtkb3duUG9zdFByb2Nlc3NvcigoZWwsIGN0eCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBlbWJlZHMgPSBlbC5xdWVyeVNlbGVjdG9yQWxsKCdzcGFuLmludGVybmFsLWVtYmVkW3NyYyQ9XCIuZHJhd2lvLnN2Z1wiXScpO1xyXG4gICAgICAgICAgICBlbWJlZHMuZm9yRWFjaCgoZW1iZWQpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHdpZHRoID0gZW1iZWQuZ2V0QXR0cmlidXRlKCdhbHQnKVxyXG5cclxuICAgICAgICAgICAgICAgIGNvbnN0IHBlcmNlbnRwYXR0ZXJuID0gL14oMTAwfFsxLTldP1xcZCklJC87XHJcblxyXG4gICAgICAgICAgICAgICAgaWYocGVyY2VudHBhdHRlcm4udGVzdCh3aWR0aCA/PyAnJykpIHtcclxuICAgICAgICAgICAgICAgICAgICBlbWJlZC5zZXRBdHRyaWJ1dGUoJ3dpZHRoJywgd2lkdGghKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0pXHJcbiAgICB9fSIsICJpbXBvcnQgRHJhd2lvUGx1Z2luIGZyb20gJ21haW4nO1xuaW1wb3J0IHsgVEZpbGUsIFZhdWx0LCBBcHAgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBmaW5kRmlsZUJ5TmFtZSB9IGZyb20gJ3V0aWxzL2ZpbmRGaWxlQnlOYW1lJztcblxuZXhwb3J0IGZ1bmN0aW9uIGdldEZpbGVDb250ZW50KGVsZW1lbnQ6IEVsZW1lbnQsIGFwcDogQXBwKTogVEZpbGUgfCBudWxsIHtcblxuICAgIGNvbnN0IHNyYyA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKFwic3JjXCIpO1xuICAgIGlmICghc3JjKSByZXR1cm4gbnVsbDtcblxuICAgIGNvbnN0IGZpbGVuYW1lID0gc3JjLnNwbGl0KCcvJykucG9wKCk7XG4gICAgXG4gICAgaWYgKCFmaWxlbmFtZSkgcmV0dXJuIG51bGw7XG5cbiAgICBjb25zdCBmaWxlID0gZmluZEZpbGVCeU5hbWUoZmlsZW5hbWUsIGFwcCk7XG5cbiAgICByZXR1cm4gZmlsZSBpbnN0YW5jZW9mIFRGaWxlID8gZmlsZSA6IG51bGw7XG59IiwgImltcG9ydCB7IFRGaWxlLCBWYXVsdCwgQXBwIH0gZnJvbSAnb2JzaWRpYW4nO1xuXG5leHBvcnQgZnVuY3Rpb24gZmluZEZpbGVCeU5hbWUoZmlsZU5hbWU6IHN0cmluZywgYXBwOiBBcHApOiBURmlsZSB8IG51bGwge1xuICAgIGNvbnN0IGZpbGVzID0gYXBwLnZhdWx0LmdldEZpbGVzKCk7XG4gICAgZm9yIChjb25zdCBmaWxlIG9mIGZpbGVzKSB7XG4gICAgICAgIGlmIChmaWxlLm5hbWUgPT09IGZpbGVOYW1lKSB7XG4gICAgICAgICAgICByZXR1cm4gZmlsZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbn1cbiIsICJcbmltcG9ydCB7IGdldEZpbGVDb250ZW50IH0gZnJvbSBcImhhbmRsZXJzL2dldEZpbGVDb250ZW50XCI7XG5pbXBvcnQgRHJhd2lvUGx1Z2luIGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBNYXJrZG93blBvc3RQcm9jZXNzb3JDb250ZXh0LCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gSW50ZXJhY3RpdmVEaWFncmFtcyhwbHVnaW46IERyYXdpb1BsdWdpbikge1xuXHRpZiAoIXBsdWdpbi5zZXR0aW5ncy5pbnRlcmFjdGl2ZURpYWdyYW0pIHJldHVybjtcblxuXHRwbHVnaW4ucmVnaXN0ZXJNYXJrZG93blBvc3RQcm9jZXNzb3IoYXN5bmMgKGVsLCBjdHg6IE1hcmtkb3duUG9zdFByb2Nlc3NvckNvbnRleHQpID0+IHtcblx0XHRjb25zdCBlbWJlZHMgPSBlbC5xdWVyeVNlbGVjdG9yQWxsKCdzcGFuLmludGVybmFsLWVtYmVkW3NyYyQ9XCIuZHJhd2lvLnN2Z1wiXScpO1xuXHRcdGZvciAoY29uc3QgZW1iZWQgb2YgZW1iZWRzKSB7XG5cblx0XHRcdGVtYmVkLmFkZENsYXNzKCdkcmF3aW8tY29udGFpbmVyJylcblx0XHRcdGNvbnN0IGZpbGUgPSBnZXRGaWxlQ29udGVudChlbWJlZCwgcGx1Z2luLmFwcCk7XG5cblx0XHRcdGlmICghKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkpIGNvbnRpbnVlO1xuXG5cdFx0XHRjb25zdCBkYXRhID0gYXdhaXQgcGx1Z2luLmFwcC52YXVsdC5yZWFkKGZpbGUpO1xuXG5cdFx0XHRjb25zdCBpbWcgPSBlbWJlZC5xdWVyeVNlbGVjdG9yKCdpbWcnKTtcblxuXHRcdFx0bGV0IGltZ1NpemVlID0gbnVsbDtcblxuXHRcdFx0aWYoaW1nLmhhc0F0dHJpYnV0ZSgnd2lkdGgnKSkge1xuXHRcdFx0XHRpbWdTaXplZSA9IGltZy5nZXRBdHRyaWJ1dGUoJ3dpZHRoJyk7XG5cdFx0XHR9IGlmIChpbWcuaGFzQXR0cmlidXRlKCdhbHQnKSAmJiBpbWcuZ2V0QXR0cmlidXRlKCdhbHQnKS5pbmNsdWRlcygnJScpKSB7XG5cdFx0XHRcdGltZ1NpemVlID0gaW1nLmdldEF0dHJpYnV0ZSgnYWx0Jylcblx0XHRcdH1cblxuXHRcdFx0Y29uc3QgdGVtcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0XHR0ZW1wLmlubmVySFRNTCA9IGRhdGE7XG5cblx0XHRcdGNvbnN0IHN2Z0VsZW1lbnQgPSB0ZW1wLnF1ZXJ5U2VsZWN0b3IoXCJzdmdcIik7XG5cdFx0XHRpZiAoIXN2Z0VsZW1lbnQpIGNvbnRpbnVlO1xuXG5cdFx0XHRpbWcucmVwbGFjZVdpdGgoc3ZnRWxlbWVudCk7XG5cblx0XHRcdHN2Z0VsZW1lbnQuYWRkQ2xhc3MoJ2RyYXdpby1zdmcnKVxuXG5cdFx0XHRpZiAoaW1nU2l6ZWUgIT09IG51bGwgJiYgIWltZ1NpemVlLmluY2x1ZGVzKCclJykpIHtcblx0XHRcdFx0c3ZnRWxlbWVudC5zZXRBdHRyaWJ1dGUoJ3dpZHRoJywgaW1nU2l6ZWUgKyAncHgnKTtcblx0XHRcdFx0c3ZnRWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2hlaWdodCcsICcxMDAlJyk7XG5cdFx0XHR9IGVsc2UgaWYgKGltZ1NpemVlICE9PSBudWxsKSB7XG5cdFx0XHRcdHN2Z0VsZW1lbnQuc2V0QXR0cmlidXRlKCd3aWR0aCcsIGltZ1NpemVlKTtcblx0XHRcdFx0c3ZnRWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2hlaWdodCcsICcxMDAlJyk7XG5cdFx0XHR9XG5cblxuXHRcdFx0aWYoZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QuY29udGFpbnMoJ3RoZW1lLWxpZ2h0JykpIHtcblx0XHRcdFx0c3ZnRWxlbWVudC5hZGRDbGFzcygnZHJhd2lvLXNjaGVtZS1saWdodCcpIFxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0c3ZnRWxlbWVudC5hZGRDbGFzcygnZHJhd2lvLXNjaGVtZS1kYXJrJylcblx0XHRcdH1cblx0XG5cdGNvbnN0IGxpbmtzID0gc3ZnRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCdhJyk7XG5cblx0Zm9yKGNvbnN0IGxpbmsgb2YgbGlua3MpIHtcblx0XHRsaW5rLmFkZENsYXNzKCdpbnRlcm5hbC1saW5rJylcblx0XG5cdFx0Y29uc3QgaHJlZkxpbmsgPSBsaW5rLmdldEF0dHJpYnV0ZSgneGxpbms6aHJlZicpO1xuXHRcdGxldCBjbGVhbkhyZWYgPSBocmVmTGluaztcblxuXHRcdGNvbnN0IG1hdGNoUm91bmQgPSBocmVmTGluay5tYXRjaCgvXFxbLio/XFxdXFwoKC4qPylcXCkvKTtcblx0XHRpZiAobWF0Y2hSb3VuZCkge1xuXHRcdFx0Y2xlYW5IcmVmID0gbWF0Y2hSb3VuZFsxXTtcblx0XHR9XG5cblx0XHRjb25zdCBtYXRjaERvdWJsZVNxdWFyZSA9IGhyZWZMaW5rLm1hdGNoKC9cXFtcXFsoLio/KVxcXVxcXS8pO1xuXHRcdGlmIChtYXRjaERvdWJsZVNxdWFyZSkge1xuXHRcdFx0Y2xlYW5IcmVmID0gbWF0Y2hEb3VibGVTcXVhcmVbMV07XG5cdFx0fVxuXG5cdFx0bGluay5zZXRBdHRyaWJ1dGUoJ2hyZWYnLCBjbGVhbkhyZWYpO1xuXHR9XG5cdFxuXHR9XG5cdH0pO1xufSIsICJpbXBvcnQgeyBFZGl0b3IsIE1hcmtkb3duVmlldywgVEZpbGUsIEFwcCB9IGZyb20gXCJvYnNpZGlhblwiO1xuXG5leHBvcnQgZnVuY3Rpb24gZmluZERpYWdyYW1GaWxlVW5kZXJDdXJzb3IoYXBwOiBBcHAsIGVkaXRvcjogRWRpdG9yLCB2aWV3OiBNYXJrZG93blZpZXcpOiBURmlsZSB8IG51bGwge1xuICAgIGNvbnN0IGN1cnNvciA9IGVkaXRvci5nZXRDdXJzb3IoKTtcbiAgICBjb25zdCBsaW5lID0gZWRpdG9yLmdldExpbmUoY3Vyc29yLmxpbmUpO1xuXG4gICAgY29uc3QgbGlua1JlZ2V4ID0gLyFcXFtcXFsoW158XFxdXStcXC4oPzpkcmF3aW9cXC5zdmd8ZHJhd2lvKSlbXlxcXV0qXFxdXFxdL2c7XG4gICAgbGV0IGV4ZWNNYXRjaDtcblxuICAgIHdoaWxlICgoZXhlY01hdGNoID0gbGlua1JlZ2V4LmV4ZWMobGluZSkpICE9PSBudWxsKSB7XG4gICAgICAgIGNvbnN0IGZ1bGxNYXRjaFRleHQgPSBleGVjTWF0Y2hbMF07XG4gICAgICAgIGNvbnN0IGxpbmtUZXh0ID0gZXhlY01hdGNoWzFdO1xuICAgICAgICBjb25zdCBzdGFydEluZGV4ID0gZXhlY01hdGNoLmluZGV4O1xuICAgICAgICBjb25zdCBlbmRJbmRleCA9IHN0YXJ0SW5kZXggKyBmdWxsTWF0Y2hUZXh0Lmxlbmd0aDtcblxuICAgICAgICBpZiAoY3Vyc29yLmNoID49IHN0YXJ0SW5kZXggJiYgY3Vyc29yLmNoIDw9IGVuZEluZGV4KSB7XG4gICAgICAgICAgICBjb25zdCBsaW5rZWRGaWxlID0gYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0Rmlyc3RMaW5rcGF0aERlc3QobGlua1RleHQsIHZpZXcuZmlsZT8ucGF0aCA/PyBcIlwiKTtcbiAgICAgICAgICAgIGlmIChsaW5rZWRGaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbGlua2VkRmlsZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbn0iLCAiaW1wb3J0IHsgQXBwLCBNb2RhbCwgRWRpdG9yLCBURmlsZSwgTm90aWNlLCBNYXJrZG93blZpZXcgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgRHJhd2lvUGx1Z2luIGZyb20gJy4uL21haW4nO1xuaW1wb3J0IHsgZm9yY2VNYXJrZG93blZpZXdVcGRhdGUgfSBmcm9tICcuLi91dGlscy9mb3JjZU1hcmtkb3duVmlld1VwZGF0ZSc7XG5cbmV4cG9ydCBjbGFzcyBEcmF3aW9FbWJlZE1vZGFsIGV4dGVuZHMgTW9kYWwge1xuICAgIHByaXZhdGUgZWRpdG9yOiBFZGl0b3I7XG4gICAgcHJpdmF0ZSBjdXJyZW50RmlsZTogVEZpbGUgfCBudWxsID0gbnVsbDtcbiAgICBwcml2YXRlIGlmcmFtZTogSFRNTElGcmFtZUVsZW1lbnQgfCBudWxsID0gbnVsbDtcbiAgICBwcml2YXRlIG1lc3NhZ2VIYW5kbGVyOiAoKGV2ZW50OiBNZXNzYWdlRXZlbnQpID0+IFByb21pc2U8dm9pZD4pIHwgbnVsbCA9IG51bGw7XG4gICAgcHJpdmF0ZSBwbHVnaW46IERyYXdpb1BsdWdpbjtcbiAgICBwcml2YXRlIGlzRW1wdHlEaWFncmFtOiBib29sZWFuID0gdHJ1ZTtcblxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBlZGl0b3I6IEVkaXRvciwgcGx1Z2luOiBEcmF3aW9QbHVnaW4sIGZpbGVUb0VkaXQ6IFRGaWxlIHwgbnVsbCA9IG51bGwpIHtcbiAgICAgICAgc3VwZXIoYXBwKTtcbiAgICAgICAgdGhpcy5lZGl0b3IgPSBlZGl0b3I7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgICAgICB0aGlzLmN1cnJlbnRGaWxlID0gZmlsZVRvRWRpdDtcbiAgICAgICAgdGhpcy5tb2RhbEVsLmFkZENsYXNzKFwiZHJhd2lvLWVtYmVkLW1vZGFsXCIpO1xuXG4gICAgICAgIGNvbnN0IG1vZGFsQmcgPSB0aGlzLmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbC1iZycpO1xuICAgICAgICBpZiAobW9kYWxCZykge1xuICAgICAgICAgICAgdGhpcy5zY29wZS5yZWdpc3RlcihbXSwgXCJFc2NhcGVcIiwgKCkgPT4gZmFsc2UpO1xuICAgICAgICAgICAgbW9kYWxCZy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiBlLnN0b3BQcm9wYWdhdGlvbigpLCB0cnVlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGFzeW5jIG9uT3BlbigpIHtcbiAgICAgICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XG4gICAgICAgIGNvbnRlbnRFbC5lbXB0eSgpO1xuXG4gICAgICAgIHRoaXMudGl0bGVFbC5zZXRUZXh0KHRoaXMuY3VycmVudEZpbGUgPyBgRWRpdCBEaWFncmFtOiAke3RoaXMuY3VycmVudEZpbGUubmFtZX1gIDogXCJDcmVhdGUgTmV3IERpYWdyYW1cIik7XG5cbiAgICAgICAgaWYgKHRoaXMuY3VycmVudEZpbGUpIHtcbiAgICAgICAgICAgIHRoaXMuaXNFbXB0eURpYWdyYW0gPSBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGlzRGFya1RoZW1lID0gZG9jdW1lbnQuYm9keS5oYXNDbGFzcyhcInRoZW1lLWRhcmtcIik7XG4gICAgICAgIGNvbnN0IGRyYXdpb1VybCA9IGBodHRwOi8vbG9jYWxob3N0OiR7dGhpcy5wbHVnaW4uc2V0dGluZ3MucG9ydH0vP2VtYmVkPTEmcHJvdG89anNvbiZsaWJyYXJpZXM9MSZzcGluPTEmc3BsYXNoPTBgICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgKGlzRGFya1RoZW1lID8gYCZ1aT1kYXJrJmRhcms9MWAgOiBgJnVpPWF0bGFzYCk7XG5cbiAgICAgICAgdGhpcy5pZnJhbWUgPSBjb250ZW50RWwuY3JlYXRlRWwoXCJpZnJhbWVcIiwgeyBhdHRyOiB7IHNyYzogZHJhd2lvVXJsIH0gfSk7XG4gICAgICAgIHRoaXMuaWZyYW1lLmFkZENsYXNzKCdkcmF3aW9JZnJhbWUnKTtcblxuICAgICAgICB0aGlzLm1lc3NhZ2VIYW5kbGVyID0gdGhpcy5jcmVhdGVNZXNzYWdlSGFuZGxlcigpO1xuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIm1lc3NhZ2VcIiwgdGhpcy5tZXNzYWdlSGFuZGxlcik7XG4gICAgfVxuXG4gICAgYXN5bmMgb25DbG9zZSgpIHtcbiAgICAgICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XG4gICAgICAgIGNvbnRlbnRFbC5lbXB0eSgpO1xuXG4gICAgICAgIGlmICh0aGlzLm1lc3NhZ2VIYW5kbGVyKSB7XG4gICAgICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1lc3NhZ2VcIiwgdGhpcy5tZXNzYWdlSGFuZGxlcik7XG4gICAgICAgICAgICB0aGlzLm1lc3NhZ2VIYW5kbGVyID0gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIGF3YWl0IHRoaXMuaGFuZGxlTW9kYWxDbG9zZUJhc2VkT25Db250ZW50KCk7XG5cbiAgICAgICAgdGhpcy5pZnJhbWUgPSBudWxsO1xuICAgICAgICB0aGlzLmlzRW1wdHlEaWFncmFtID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5jdXJyZW50RmlsZSA9IG51bGw7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzZW5kTWVzc2FnZVRvRHJhd2lvKG1lc3NhZ2U6IG9iamVjdCkge1xuICAgICAgICBpZiAodGhpcy5pZnJhbWUgJiYgdGhpcy5pZnJhbWUuY29udGVudFdpbmRvdykge1xuICAgICAgICAgICAgdGhpcy5pZnJhbWUuY29udGVudFdpbmRvdy5wb3N0TWVzc2FnZShKU09OLnN0cmluZ2lmeShtZXNzYWdlKSwgYGh0dHA6Ly9sb2NhbGhvc3Q6JHt0aGlzLnBsdWdpbi5zZXR0aW5ncy5wb3J0fWApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhc3luYyBoYW5kbGVOZXdEaWFncmFtQ3JlYXRpb24oKTogUHJvbWlzZTxURmlsZSB8IG51bGw+IHtcbiAgICAgICAgY29uc3QgZm9sZGVyUGF0aCA9IHRoaXMucGx1Z2luLnNldHRpbmdzLkZvbGRlcjtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0LmNyZWF0ZUZvbGRlcihmb2xkZXJQYXRoKTtcbiAgICAgICAgfSBjYXRjaCAoZTogYW55KSB7XG4gICAgICAgICAgICBpZiAoIWUubWVzc2FnZS5pbmNsdWRlcyhcIkZvbGRlciBhbHJlYWR5IGV4aXN0c1wiKSkge1xuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoXCJcdTI3NEMgQ291bGQgbm90IGNyZWF0ZSBmb2xkZXIgZm9yIG5ldyBkaWFncmFtLlwiKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgY3JlYXRpbmcgRHJhd2lvIGZvbGRlcjpcIiwgZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuICAgICAgICBjb25zdCB0aW1lc3RhbXAgPSBgJHtub3cuZ2V0RnVsbFllYXIoKX0keyhub3cuZ2V0TW9udGgoKSArIDEpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKX0ke25vdy5nZXREYXRlKCkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpfSR7bm93LmdldEhvdXJzKCkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpfSR7bm93LmdldE1pbnV0ZXMoKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyl9JHtub3cuZ2V0U2Vjb25kcygpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKX1gO1xuICAgICAgICBjb25zdCBmaWxlTmFtZSA9IGBkaWFncmFtXyR7dGltZXN0YW1wfS5kcmF3aW8uc3ZnYDtcbiAgICAgICAgY29uc3QgZnVsbFBhdGggPSBgJHtmb2xkZXJQYXRofS8ke2ZpbGVOYW1lfWA7XG4gICAgICAgIGNvbnN0IGVtcHR5U3ZnQ29udGVudCA9IGA8P3htbCB2ZXJzaW9uPVwiMS4wXCIgZW5jb2Rpbmc9XCJVVEYtOFwiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyBcIi0vL1czQy8vRFREIFNWRyAxLjEvL0VOXCIgXCJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGRcIj48c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB4bWxuczp4bGluaz1cImh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmtcIiB2ZXJzaW9uPVwiMS4xXCIgd2lkdGg9XCIxcHhcIiBoZWlnaHQ9XCIxcHhcIiB2aWV3Qm94PVwiLTAuNSAtMC41IDEgMVwiIGNvbnRlbnQ9XCImbHQ7bXhHcmFwaE1vZGVsJmd0OyZsdDtyb290Jmd0OyZsdDtteENlbGwgaWQ9JnF1b3Q7MCZxdW90Oy8mZ3Q7Jmx0O214Q2VsbCBpZD0mcXVvdDsxJnF1b3Q7IHBhcmVudD0mcXVvdDswJnF1b3Q7LyZndDsmbHQ7L3Jvb3QmZ3Q7Jmx0Oy9teEdyYXBoTW9kZWwmZ3Q7XCI+PGRlZnMvPjxnLz48L3N2Zz5gO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5hcHAudmF1bHQuY3JlYXRlKGZ1bGxQYXRoLCBlbXB0eVN2Z0NvbnRlbnQpO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKGBcdTI3NEMgRmFpbGVkIHRvIGNyZWF0ZSBuZXcgZGlhZ3JhbSBmaWxlOiAke2Z1bGxQYXRofWApO1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGNyZWF0aW5nIG5ldyBkaWFncmFtIGZpbGU6XCIsIGUpO1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZU1lc3NhZ2VIYW5kbGVyKCk6IChldmVudDogTWVzc2FnZUV2ZW50KSA9PiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgcmV0dXJuIGFzeW5jIChldmVudDogTWVzc2FnZUV2ZW50KSA9PiB7XG4gICAgICAgICAgICBpZiAoZXZlbnQub3JpZ2luICE9PSBgaHR0cDovL2xvY2FsaG9zdDoke3RoaXMucGx1Z2luLnNldHRpbmdzLnBvcnR9YCkgcmV0dXJuO1xuXG4gICAgICAgICAgICBsZXQgbXNnO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBtc2cgPSB0eXBlb2YgZXZlbnQuZGF0YSA9PT0gXCJzdHJpbmdcIiA/IEpTT04ucGFyc2UoZXZlbnQuZGF0YSkgOiBldmVudC5kYXRhO1xuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihcIkNvdWxkIG5vdCBwYXJzZSBEcmF3LmlvIG1lc3NhZ2U6XCIsIGV2ZW50LmRhdGEsIGUpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgc3dpdGNoIChtc2cuZXZlbnQpIHtcbiAgICAgICAgICAgICAgICBjYXNlIFwiaW5pdFwiOlxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmhhbmRsZUluaXRNZXNzYWdlKCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJzYXZlXCI6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VuZE1lc3NhZ2VUb0RyYXdpbyh7IGFjdGlvbjogXCJleHBvcnRcIiwgZm9ybWF0OiBcInhtbHN2Z1wiLCB4bWw6IDEsIGVtcHR5OiAxIH0pO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwiZXhwb3J0XCI6XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuaGFuZGxlRXhwb3J0TWVzc2FnZShtc2cuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJjaGFuZ2VcIjpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVDaGFuZ2VNZXNzYWdlKG1zZy54bWwpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwiZXhpdFwiOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgaGFuZGxlSW5pdE1lc3NhZ2UoKSB7XG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRGaWxlKSB7XG4gICAgICAgICAgICBjb25zdCBmaWxlQ29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQodGhpcy5jdXJyZW50RmlsZSk7XG4gICAgICAgICAgICB0aGlzLnNlbmRNZXNzYWdlVG9EcmF3aW8oeyBhY3Rpb246IFwibG9hZFwiLCB4bWw6IGZpbGVDb250ZW50LCBhdXRvc2F2ZTogMSB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGVtcHR5WG1sID0gXCI8bXhHcmFwaE1vZGVsPjxyb290PjxteENlbGwgaWQ9JzAnLz48bXhDZWxsIGlkPScxJyBwYXJlbnQ9JzAnLz48L3Jvb3Q+PC9teEdyYXBoTW9kZWw+XCI7XG4gICAgICAgICAgICB0aGlzLnNlbmRNZXNzYWdlVG9EcmF3aW8oeyBhY3Rpb246IFwibG9hZFwiLCB4bWw6IGVtcHR5WG1sLCBhdXRvc2F2ZTogMSB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgaGFuZGxlRXhwb3J0TWVzc2FnZShzdmdEYXRhVXJpOiBzdHJpbmcpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlRGlhZ3JhbUZyb21Nb2RhbChzdmdEYXRhVXJpKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGhhbmRsZUNoYW5nZU1lc3NhZ2UoeG1sQ29udGVudDogc3RyaW5nKSB7XG4gICAgICAgIGNvbnN0IGJhc2VFbXB0eVhtbCA9IFwiPG14R3JhcGhNb2RlbD48cm9vdD48bXhDZWxsIGlkPScwJy8+PG14Q2VsbCBpZD0nMScgcGFyZW50PScwJy8+PC9yb290PjwvbXhHcmFwaE1vZGVsPlwiO1xuICAgICAgICB0aGlzLmlzRW1wdHlEaWFncmFtID0gKCF4bWxDb250ZW50IHx8IHhtbENvbnRlbnQgPT09IGJhc2VFbXB0eVhtbCk7XG4gICAgfVxuXG5wcml2YXRlIGFzeW5jIHNhdmVEaWFncmFtRnJvbU1vZGFsKHN2Z0RhdGFVcmk6IHN0cmluZykge1xuICAgIGxldCBjb250ZW50VG9TYXZlOiBzdHJpbmc7XG4gICAgdHJ5IHtcbiAgICAgICAgY29udGVudFRvU2F2ZSA9IHRoaXMuZGVjb2RlU3ZnRGF0YVVyaShzdmdEYXRhVXJpKTtcbiAgICB9IGNhdGNoIChlOiBhbnkpIHtcbiAgICAgICAgbmV3IE5vdGljZShgXHUyNzRDIEZhaWxlZCB0byBkZWNvZGUgU1ZHIGNvbnRlbnQ6ICR7ZS5tZXNzYWdlfWApO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIFxuICAgIGlmICh0aGlzLmlzU3ZnQ29udGVudEFjdHVhbGx5RW1wdHkoY29udGVudFRvU2F2ZSkpIHtcbiAgICAgICAgbmV3IE5vdGljZShcIkRpYWdyYW0gaXMgZW1wdHkuIE5vdGhpbmcgdG8gc2F2ZS5cIik7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMuY3VycmVudEZpbGUpIHtcbiAgICAgICAgY29uc3QgbmV3RmlsZSA9IGF3YWl0IHRoaXMuaGFuZGxlTmV3RGlhZ3JhbUNyZWF0aW9uKCk7XG4gICAgICAgIGlmICghbmV3RmlsZSkgcmV0dXJuO1xuXG4gICAgICAgIHRoaXMuY3VycmVudEZpbGUgPSBuZXdGaWxlO1xuICAgICAgICB0aGlzLnRpdGxlRWwuc2V0VGV4dChgRWRpdCBEaWFncmFtOiAke3RoaXMuY3VycmVudEZpbGUubmFtZX1gKTsgLy8gXHUwNDFFXHUwNDMxXHUwNDNEXHUwNDNFXHUwNDMyXHUwNDNCXHUwNDRGXHUwNDM1XHUwNDNDIFx1MDQzN1x1MDQzMFx1MDQzM1x1MDQzRVx1MDQzQlx1MDQzRVx1MDQzMlx1MDQzRVx1MDQzQSBcdTA0M0VcdTA0M0FcdTA0M0RcdTA0MzBcblxuICAgICAgICBjb25zdCBkZWZhdWx0V2lkdGggPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5kaWFncmFtU2l6ZTtcbiAgICAgICAgbGV0IGVtYmVkTGluazogc3RyaW5nOyAgICAgICAgXG4gICAgICAgIFxuICAgICAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MudXNlTWFya2Rvd25MaW5rcykge1xuICAgICAgICAgICAgY29uc3QgYWx0ID0gZGVmYXVsdFdpZHRoPy50cmltKCkgPz8gXCJcIjtcbiAgICAgICAgICAgIGNvbnN0IHJlbGF0aXZlUGF0aCA9IHRoaXMuY3VycmVudEZpbGUucGF0aDtcblxuICAgICAgICAgICAgZW1iZWRMaW5rID0gYCFbJHthbHR9XSgke3JlbGF0aXZlUGF0aH0pYDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGVtYmVkTGluayA9IGRlZmF1bHRXaWR0aD8udHJpbSgpXG4gICAgICAgICAgICAgICAgPyBgIVtbJHt0aGlzLmN1cnJlbnRGaWxlLnBhdGh9fCR7ZGVmYXVsdFdpZHRoLnRyaW0oKX1dXWBcbiAgICAgICAgICAgICAgICA6IGAhW1ske3RoaXMuY3VycmVudEZpbGUucGF0aH1dXWA7XG4gICAgICAgIH1cblxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZWRpdG9yLnJlcGxhY2VTZWxlY3Rpb24oZW1iZWRMaW5rKTtcbiAgICAgICAgfSwgNTAwKTtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgICBhd2FpdCB0aGlzLmFwcC52YXVsdC5tb2RpZnkodGhpcy5jdXJyZW50RmlsZSwgY29udGVudFRvU2F2ZSk7XG4gICAgICAgIG5ldyBOb3RpY2UoYFx1RDgzRFx1RENCRSBEaWFncmFtIHNhdmVkOiAke3RoaXMuY3VycmVudEZpbGUucGF0aH1gKTtcbiAgICAgICAgZm9yY2VNYXJrZG93blZpZXdVcGRhdGUodGhpcy5hcHAsIHRoaXMuY3VycmVudEZpbGUpO1xuICAgICAgICB0aGlzLmlzRW1wdHlEaWFncmFtID0gZmFsc2U7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBuZXcgTm90aWNlKGBcdTI3NEMgRmFpbGVkIHRvIHNhdmUgZGlhZ3JhbTogJHt0aGlzLmN1cnJlbnRGaWxlLnBhdGh9YCk7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBzYXZpbmcgZGlhZ3JhbTpcIiwgZSk7XG4gICAgfVxufVxuXG4gICAgcHJpdmF0ZSBkZWNvZGVTdmdEYXRhVXJpKHN2Z0RhdGFVcmk6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIGlmIChzdmdEYXRhVXJpLnN0YXJ0c1dpdGgoXCJkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LFwiKSkge1xuICAgICAgICAgICAgY29uc3QgYmFzZTY0UGFydCA9IHN2Z0RhdGFVcmkuc3BsaXQoJywnKVsxXTtcbiAgICAgICAgICAgIHJldHVybiBCdWZmZXIuZnJvbShiYXNlNjRQYXJ0LCAnYmFzZTY0JykudG9TdHJpbmcoJ3V0Zi04Jyk7XG4gICAgICAgIH0gZWxzZSBpZiAoc3ZnRGF0YVVyaS5zdGFydHNXaXRoKFwiZGF0YTppbWFnZS9zdmcreG1sLFwiKSkge1xuICAgICAgICAgICAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChzdmdEYXRhVXJpLnNwbGl0KCcsJylbMV0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBTVkcgZGF0YSBmb3JtYXQgcmVjZWl2ZWQuXCIpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBpc1N2Z0NvbnRlbnRBY3R1YWxseUVtcHR5KGNvbnRlbnQ6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICBjb25zdCBlbXB0eURyYXdpb1htbEluU3ZnQ29udGVudCA9IGBjb250ZW50PVwiJmx0O214R3JhcGhNb2RlbCZndDsmbHQ7cm9vdCZndDsmbHQ7bXhDZWxsIGlkPSZxdW90OzAmcXVvdDsvJmd0OyZsdDtteENlbGwgaWQ9JnF1b3Q7MSZxdW90OyBwYXJlbnQ9JnF1b3Q7MCZxdW90Oy8mZ3Q7Jmx0Oy9yb290Jmd0OyZsdDsvbXhHcmFwaE1vZGVsJmd0O1wiYDtcbiAgICAgICAgcmV0dXJuIGNvbnRlbnQuaW5jbHVkZXMoZW1wdHlEcmF3aW9YbWxJblN2Z0NvbnRlbnQpICYmIChjb250ZW50Lm1hdGNoKC88Z1xcYltePl0qPi9nKSB8fCBbXSkubGVuZ3RoID09PSAxO1xuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgaGFuZGxlTW9kYWxDbG9zZUJhc2VkT25Db250ZW50KCkge1xuICAgICAgICBpZiAoIXRoaXMuY3VycmVudEZpbGUpIHJldHVybjsgLy8gXHUwNDE1XHUwNDQxXHUwNDNCXHUwNDM4IFx1MDQ0NFx1MDQzMFx1MDQzOVx1MDQzQiBcdTA0NDJcdTA0MzBcdTA0M0EgXHUwNDM4IFx1MDQzRFx1MDQzNSBcdTA0MzFcdTA0NEJcdTA0M0IgXHUwNDQxXHUwNDNFXHUwNDM3XHUwNDM0XHUwNDMwXHUwNDNELCBcdTA0MzJcdTA0NEJcdTA0NDVcdTA0M0VcdTA0MzRcdTA0MzhcdTA0M0NcblxuICAgICAgICAvLyBcdTA0MkRcdTA0NDJcdTA0MzAgXHUwNDNCXHUwNDNFXHUwNDMzXHUwNDM4XHUwNDNBXHUwNDMwIFx1MDQzRFx1MDQ0M1x1MDQzNlx1MDQzRFx1MDQzMCBcdTA0MzRcdTA0M0JcdTA0NEYgXHUwNDQxXHUwNDNCXHUwNDQzXHUwNDQ3XHUwNDMwXHUwNDRGLCBcdTA0M0FcdTA0M0VcdTA0MzNcdTA0MzRcdTA0MzAgXHUwNDNGXHUwNDNFXHUwNDNCXHUwNDRDXHUwNDM3XHUwNDNFXHUwNDMyXHUwNDMwXHUwNDQyXHUwNDM1XHUwNDNCXHUwNDRDIFx1MDQzRVx1MDQ0N1x1MDQzOFx1MDQ0MVx1MDQ0Mlx1MDQzOFx1MDQzQiAqXHUwNDQxXHUwNDQzXHUwNDQ5XHUwNDM1XHUwNDQxXHUwNDQyXHUwNDMyXHUwNDQzXHUwNDRFXHUwNDQ5XHUwNDQzXHUwNDRFKiBcdTA0MzRcdTA0MzhcdTA0MzBcdTA0MzNcdTA0NDBcdTA0MzBcdTA0M0NcdTA0M0NcdTA0NDMuXG4gICAgICAgIGlmICh0aGlzLmlzRW1wdHlEaWFncmFtKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHBhdGhUb0RlbGV0ZSA9IHRoaXMuY3VycmVudEZpbGUucGF0aDtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmFwcC5maWxlTWFuYWdlci50cmFzaEZpbGUodGhpcy5jdXJyZW50RmlsZSk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgY29uc3QgZWRpdG9yQ29udGVudCA9IHRoaXMuZWRpdG9yLmdldFZhbHVlKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgbGlua1RvRGVsZXRlU2ltcGxlID0gYCFbWyR7cGF0aFRvRGVsZXRlfV1dYDtcbiAgICAgICAgICAgICAgICBjb25zdCBsaW5rVG9EZWxldGVFbmNvZGVkID0gYCFbWyR7ZW5jb2RlVVJJKHBhdGhUb0RlbGV0ZSl9XV1gO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGxldCBmaW5hbENvbnRlbnQgPSBlZGl0b3JDb250ZW50LnJlcGxhY2UobGlua1RvRGVsZXRlU2ltcGxlLCAnJyk7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBsaW5rV2l0aE1vZGlmaWVyUmVnZXggPSBuZXcgUmVnRXhwKGAhXFxcXFtcXFxcWyR7cGF0aFRvRGVsZXRlLnJlcGxhY2UoL1stXFwvXFxcXF4kKis/LigpfFtcXF17fV0vZywgJ1xcXFwkJicpfVxcXFx8W15cXFxcXV0rXFxcXF1cXFxcXWAsICdnJyk7XG4gICAgICAgICAgICAgICAgZmluYWxDb250ZW50ID0gZmluYWxDb250ZW50LnJlcGxhY2UobGlua1dpdGhNb2RpZmllclJlZ2V4LCAnJyk7XG5cbiAgICAgICAgICAgICAgICBpZiAoZmluYWxDb250ZW50ICE9PSBlZGl0b3JDb250ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZWRpdG9yLnNldFZhbHVlKGZpbmFsQ29udGVudCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEoZSBpbnN0YW5jZW9mIEVycm9yICYmIGUubWVzc2FnZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwiZmlsZSBhbHJlYWR5IGRlbGV0ZWRcIikpKSB7XG4gICAgICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoYFx1Mjc0QyBGYWlsZWQgdG8gZGVsZXRlIGVtcHR5IGRpYWdyYW0gZmlsZTogJHt0aGlzLmN1cnJlbnRGaWxlLnBhdGh9YCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufSIsICJpbXBvcnQgeyBBcHAsIFRGaWxlLCBNYXJrZG93blZpZXcgfSBmcm9tICdvYnNpZGlhbic7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmb3JjZU1hcmtkb3duVmlld1VwZGF0ZShhcHA6IEFwcCwgZmlsZTogVEZpbGUgfCBudWxsKSB7XG4gICAgaWYgKCFmaWxlKSB7XG4gICAgICAgIGNvbnNvbGUud2FybihcImZvcmNlTWFya2Rvd25WaWV3VXBkYXRlOiBcdTA0MTJcdTA0NEJcdTA0MzdcdTA0MzJcdTA0MzBcdTA0M0RcdTA0MzAgXHUwNDQxIG51bGwgXHUwNDQ0XHUwNDMwXHUwNDM5XHUwNDNCXHUwNDNFXHUwNDNDLiBcdTA0MURcdTA0MzVcdTA0MzJcdTA0M0VcdTA0MzdcdTA0M0NcdTA0M0VcdTA0MzZcdTA0M0RcdTA0M0UgXHUwNDNFXHUwNDNGXHUwNDQwXHUwNDM1XHUwNDM0XHUwNDM1XHUwNDNCXHUwNDM4XHUwNDQyXHUwNDRDLCBcdTA0MzhcdTA0MzdcdTA0M0NcdTA0MzVcdTA0M0RcdTA0MzVcdTA0M0RcdTA0MzhcdTA0NEYgXHUwNDNBXHUwNDMwXHUwNDNBXHUwNDNFXHUwNDMzXHUwNDNFIFx1MDQ0NFx1MDQzMFx1MDQzOVx1MDQzQlx1MDQzMCBcdTA0M0VcdTA0NDJcdTA0NDFcdTA0M0JcdTA0MzVcdTA0MzZcdTA0MzhcdTA0MzJcdTA0MzBcdTA0NDJcdTA0NEMuXCIpO1xuICAgICAgICByZXR1cm47IFxuICAgIH1cbiAgICBjb25zdCBkaWFncmFtRmlsZTogVEZpbGUgPSBmaWxlOyBcblxuICAgIGNvbnN0IGxlYXZlcyA9IGFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFwibWFya2Rvd25cIik7XG4gICAgZm9yIChjb25zdCBsZWFmIG9mIGxlYXZlcykge1xuICAgICAgICBjb25zdCBtZFZpZXcgPSBsZWFmLnZpZXcgYXMgTWFya2Rvd25WaWV3O1xuICAgICAgICBpZiAoIW1kVmlldyB8fCAhbWRWaWV3LmZpbGUpIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGN1cnJlbnRWaWV3RmlsZTogVEZpbGUgPSBtZFZpZXcuZmlsZTsgXG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGxldCBuZWVkc1JlYnVpbGQgPSBmYWxzZTtcbiAgICAgICAgICAgIGlmICghY3VycmVudFZpZXdGaWxlIHx8ICFjdXJyZW50Vmlld0ZpbGUucGF0aCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihgZm9yY2VNYXJrZG93blZpZXdVcGRhdGU6IGN1cnJlbnRWaWV3RmlsZSBcdTA0MzhcdTA0M0JcdTA0MzggXHUwNDM1XHUwNDMzXHUwNDNFIFx1MDQzRlx1MDQ0M1x1MDQ0Mlx1MDQ0QyBcdTA0NDFcdTA0NDJcdTA0MzBcdTA0M0IgbnVsbC91bmRlZmluZWQgXHUwNDM0XHUwNDNCXHUwNDRGIFx1MDQzQlx1MDQzOFx1MDQ0MVx1MDQ0Mlx1MDQzMCAke2xlYWZ9LiBcdTA0MUZcdTA0NDBcdTA0M0VcdTA0M0ZcdTA0NDNcdTA0NDFcdTA0M0FcdTA0MzBcdTA0MzVcdTA0M0MgXHUwNDNGXHUwNDM1XHUwNDQwXHUwNDM1XHUwNDQxXHUwNDQyXHUwNDQwXHUwNDNFXHUwNDM5XHUwNDNBXHUwNDQzLmApO1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlOyBcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGN1cnJlbnRWaWV3RmlsZS5wYXRoID09PSBkaWFncmFtRmlsZS5wYXRoKSB7XG4gICAgICAgICAgICAgICAgbmVlZHNSZWJ1aWxkID0gdHJ1ZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZUNvbnRlbnQgPSBhd2FpdCBhcHAudmF1bHQuY2FjaGVkUmVhZChjdXJyZW50Vmlld0ZpbGUpO1xuICAgICAgICAgICAgICAgIGlmIChmaWxlQ29udGVudC5pbmNsdWRlcyhkaWFncmFtRmlsZS5uYW1lKSB8fCBmaWxlQ29udGVudC5pbmNsdWRlcyhlbmNvZGVVUkkoZGlhZ3JhbUZpbGUubmFtZSkpKSB7XG4gICAgICAgICAgICAgICAgICAgIG5lZWRzUmVidWlsZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAobmVlZHNSZWJ1aWxkKSB7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiAobGVhZiBhcyBhbnkpLnJlYnVpbGRWaWV3ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IChsZWFmIGFzIGFueSkucmVidWlsZFZpZXcoKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB2aWV3U3RhdGUgPSBsZWFmLmdldFZpZXdTdGF0ZSgpO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCBsZWFmLnNldFZpZXdTdGF0ZSh7IHR5cGU6ICdlbXB0eScgfSk7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IGxlYWYuc2V0Vmlld1N0YXRlKHZpZXdTdGF0ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgY29uc3QgY3VycmVudFZpZXdGaWxlUGF0aEZvckxvZyA9IGN1cnJlbnRWaWV3RmlsZT8ucGF0aCA/PyAndW5rbm93biBmaWxlIChubyBwYXRoKSc7XG4gICAgICAgICAgICBjb25zdCBkaWFncmFtRmlsZVBhdGhGb3JMb2cgPSBkaWFncmFtRmlsZT8ucGF0aCA/PyAndW5rbm93biBkaWFncmFtIHBhdGgnOyBcblxuICAgICAgICAgICAgY29uc29sZS53YXJuKGBcdTA0MURcdTA0MzUgXHUwNDQzXHUwNDM0XHUwNDMwXHUwNDNCXHUwNDNFXHUwNDQxXHUwNDRDIFx1MDQzRVx1MDQzMVx1MDQzRFx1MDQzRVx1MDQzMlx1MDQzOFx1MDQ0Mlx1MDQ0QyBcdTA0M0ZcdTA0NDBcdTA0MzVcdTA0MzRcdTA0NDFcdTA0NDJcdTA0MzBcdTA0MzJcdTA0M0JcdTA0MzVcdTA0M0RcdTA0MzhcdTA0MzUgXHUwNDM0XHUwNDNCXHUwNDRGICR7Y3VycmVudFZpZXdGaWxlUGF0aEZvckxvZ30gXHUwNDNFXHUwNDQyXHUwNDNEXHUwNDNFXHUwNDQxXHUwNDM4XHUwNDQyXHUwNDM1XHUwNDNCXHUwNDRDXHUwNDNEXHUwNDNFIFx1MDQzOFx1MDQzN1x1MDQzQ1x1MDQzNVx1MDQzRFx1MDQzNVx1MDQzRFx1MDQzOFx1MDQzOSBcdTA0MzIgJHtkaWFncmFtRmlsZVBhdGhGb3JMb2d9OmAsIGVycik7XG4gICAgICAgIH1cbiAgICB9XG59Il0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLElBQUFBLG1CQUFtRzs7O0FDQTVGLElBQU0sYUFBYTs7O0FDQTFCLElBQUFDLG1CQUF1RTs7O0FDQXZFO0FBQUEsRUFDSSxnQkFBa0I7QUFBQSxFQUNsQixnQkFBa0I7QUFBQSxFQUNsQix3QkFBMEI7QUFBQSxFQUMxQix3QkFBMEI7QUFDOUI7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Q1AsaUJBQ0ssU0FBUywyQkFBMkIsRUFDcEMsUUFBUSxRQUFRLEVBQ2hCLFdBQVcsZ0JBQWdCLEVBQzNCLFFBQVEsTUFBTSxnQkFBZ0IsQ0FBQztBQUFBLFVBQ3BDLENBQUM7QUFBQSxRQUNsQjtBQUFBLE1BQ0QsQ0FBQztBQUFBLElBQ0Y7QUFFTyxTQUFLLFdBQVc7QUFBQSxNQUNaLElBQUk7QUFBQSxNQUNKLE1BQU07QUFBQSxNQUNOLGdCQUFnQixPQUFPLFFBQWdCLFNBQXVCO0FBQzFELGNBQU0sYUFBYSwyQkFBMkIsS0FBSyxLQUFLLFFBQVEsSUFBSTtBQUNwRSxjQUFNLHdCQUF3QixJQUFJO0FBRWxDLFlBQUksWUFBWTtBQUNaLGNBQUksaUJBQWlCLEtBQUssS0FBSyxRQUFRLE1BQU0sVUFBVSxFQUFFLEtBQUs7QUFBQSxRQUNsRSxPQUFPO0FBQ0gsY0FBSSxpQkFBaUIsS0FBSyxLQUFLLFFBQVEsSUFBSSxFQUFFLEtBQUs7QUFBQSxRQUN0RDtBQUFBLE1BQ0o7QUFBQSxJQUNKLENBQUM7QUFBQSxFQUNQO0FBQUEsRUFHRixNQUFNLGVBQWU7QUFDcEIsU0FBSyxXQUFXLE9BQU8sT0FBTyxDQUFDLEdBQUcsa0JBQWtCLE1BQU0sS0FBSyxTQUFTLENBQUM7QUFBQSxFQUMxRTtBQUFBLEVBRUEsTUFBTSxlQUFlO0FBQ3BCLFVBQU0sS0FBSyxTQUFTLEtBQUssUUFBUTtBQUFBLEVBQ2xDO0FBQUEsRUFFRSxNQUFNLFdBQVc7QUFDbEIsUUFBSSxLQUFLLGNBQWM7QUFDaEIsV0FBSyxhQUFhLE1BQU0sTUFBTTtBQUMxQixZQUFJLHdCQUFPLEVBQUUsd0JBQXdCLENBQUM7QUFDdEMsYUFBSyxlQUFlO0FBQUEsTUFDeEIsQ0FBQztBQUFBLElBQ0w7QUFBQSxFQUNGO0FBQUEsRUFFQSxNQUFNLGVBQWU7QUFDdEIsVUFBTSxPQUFPLEtBQUssSUFBSSxVQUFVLFFBQVEsS0FBSztBQUM3QyxRQUFHLE1BQU07QUFDUixZQUFNLEtBQUssYUFBYTtBQUFBLFFBQ3hCLE1BQU07QUFBQSxRQUNOLFFBQVE7QUFBQSxNQUNOLENBQUM7QUFDRCxXQUFLLElBQUksVUFBVSxXQUFXLElBQUk7QUFBQSxJQUNyQztBQUFBLEVBQ0M7QUFDRjsiLAogICJuYW1lcyI6IFsiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJwYXRoIiwgImltcG9ydF9vYnNpZGlhbiIsICJwb3J0IiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iXQp9Cg==
