/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => DrawioPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian9 = require("obsidian");

// consts.ts
var DRAWIOVIEW = "drawioview";

// views/drawioView.ts
var import_obsidian2 = require("obsidian");

// locales/en.json
var en_default = {
  DrawIoViewName: "draw.io editor",
  ribonIconTitle: "open draw.io editor",
  StartDrawioClientSever: "Draw.io server started on port",
  StopDrawioClinetServer: "Draw.io server stopped"
};

// locales/ru.json
var ru_default = {
  DrawIoViewName: "\u0420\u0435\u0434\u0430\u043A\u0442\u043E\u0440 draw.io",
  ribonIconTitle: "\u041E\u0442\u043A\u0440\u044B\u0442\u044C \u0440\u0435\u0434\u0430\u043A\u0442\u043E\u0440 draw.io",
  StartDrawioClientSever: "\u0421\u0435\u0440\u0435\u0432\u0435\u0440 \u0437\u0430\u043F\u0443\u0441\u0442\u0438\u043B\u0430 \u043D\u0430 \u043F\u043E\u0440\u0442\u0443",
  StopDrawioClinetServer: "\u0421\u0435\u0440\u0435\u0432\u0440 drawio \u043E\u0441\u0442\u0430\u043D\u043E\u0432\u043B\u0435\u043D"
};

// locales/i18n.ts
var locales = {
  en: en_default,
  ru: ru_default
};
var currentLocale = "en";
var translations = en_default;
function setLocale(locale) {
  currentLocale = locale in locales ? locale : "en";
  translations = locales[currentLocale];
}
function t(key) {
  return translations[key] || key;
}

// utils/folderExists.ts
var import_obsidian = require("obsidian");
function folderExists(app, path2) {
  const normalized = (0, import_obsidian.normalizePath)(path2);
  const folder = app.vault.getAbstractFileByPath(normalized);
  return folder instanceof import_obsidian.TFolder;
}

// views/drawioView.ts
var Drawioview = class extends import_obsidian2.ItemView {
  constructor(leaf, plugin) {
    super(leaf);
    this.iframe = null;
    this.plugin = plugin;
    this.messageHandler = this.listendrawiomessage.bind(this);
  }
  getViewType() {
    return DRAWIOVIEW;
  }
  getDisplayText() {
    return t("DrawIoViewName");
  }
  async onOpen() {
    const container = this.containerEl.children[1];
    container.empty();
    container.createEl("iframe", { attr: { id: "drawioiframe", src: `http://localhost:${this.plugin.settings.port}?embed=1&proto=json&ui=dark` } }).addClass("drawioIframe");
    this.iframe = document.getElementById("drawioiframe");
    window.addEventListener("message", this.messageHandler);
  }
  async listendrawiomessage(event) {
    var _a, _b, _c, _d;
    try {
      const msg = JSON.parse(event.data);
      switch (msg.event) {
        case "init":
          (_b = (_a = this.iframe) == null ? void 0 : _a.contentWindow) == null ? void 0 : _b.postMessage(JSON.stringify({
            action: "load",
            xml: "<mxGraphModel><root>...</root></mxGraphModel>",
            title: "example.drawio"
          }), `http://localhost:${this.plugin.settings.port}`);
          break;
        case "save":
          (_d = (_c = this.iframe) == null ? void 0 : _c.contentWindow) == null ? void 0 : _d.postMessage(JSON.stringify({
            action: "export",
            format: "xmlsvg",
            xml: 1
          }), `http://localhost:${this.plugin.settings.port}`);
          break;
        case "export": {
          const svgBase64 = msg.data;
          const svg64Data = svgBase64.replace(/^data:image\/svg\+xml;base64,/, "");
          const svgContent = atob(svg64Data);
          const now = new Date();
          const timestamp = `${now.getFullYear()}${(now.getMonth() + 1).toString().padStart(2, "0")}${now.getDate().toString().padStart(2, "0")}${now.getHours().toString().padStart(2, "0")}${now.getMinutes().toString().padStart(2, "0")}${now.getSeconds().toString().padStart(2, "0")}`;
          if (folderExists(this.app, this.plugin.settings.Folder)) {
            this.app.vault.create(`${this.plugin.settings.Folder}/drawio_${timestamp}.drawio.svg`, svgContent);
          } else {
            this.app.vault.create(`/drawio_${timestamp}.drawio.svg`, svgContent);
          }
          break;
        }
        case "exit":
          break;
      }
    } catch (e) {
      console.warn("\u041D\u0435\u043A\u043E\u0440\u0440\u0435\u043A\u0442\u043D\u044B\u0439 JSON \u0432 \u0441\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u0438:", event.data);
    }
  }
  async onClose() {
    window.removeEventListener("message", this.messageHandler);
  }
};

// handlers/ServerStart.ts
var import_obsidian3 = require("obsidian");
var http = require("http");
var fs = require("fs");
var path = require("path");
function getDrawioPaths(app, manifestDir) {
  const vaultBasePath = app.vault.adapter.basePath;
  const pluginDir = path.join(vaultBasePath, manifestDir);
  const webAppPath = path.join(pluginDir, "webapp");
  return { vaultBasePath, pluginDir, webAppPath };
}
function serverStart(plugin, webAppPath, port) {
  return new Promise((resolve, reject) => {
    const server = http.createServer((req, res) => {
      const requestUrl = new URL(req.url || "", `http://${req.headers.host}`);
      const filePath = path.join(
        webAppPath,
        requestUrl.pathname === "/" ? "index.html" : requestUrl.pathname
      );
      if (!filePath.startsWith(webAppPath)) {
        res.writeHead(403, { "Content-Type": "text/plain" });
        res.end("403 Forbidden");
        return;
      }
      fs.readFile(filePath, (err, data) => {
        if (err) {
          if (err.code === "ENOENT") {
            res.writeHead(404, { "Content-Type": "text/plain" });
            res.end("404 Not Found");
          } else {
            res.writeHead(500, { "Content-Type": "text/plain" });
            res.end(`500 Internal Server Error: ${err.message}`);
          }
        } else {
          const ext = path.extname(filePath).toLowerCase();
          let contentType = "application/octet-stream";
          switch (ext) {
            case ".html":
              contentType = "text/html";
              break;
            case ".js":
              contentType = "application/javascript";
              break;
            case ".css":
              contentType = "text/css";
              break;
            case ".json":
              contentType = "application/json";
              break;
            case ".png":
              contentType = "image/png";
              break;
            case ".jpg":
              contentType = "image/jpeg";
              break;
            case ".gif":
              contentType = "image/gif";
              break;
            case ".svg":
              contentType = "image/svg+xml";
              break;
            case ".woff":
              contentType = "font/woff";
              break;
            case ".woff2":
              contentType = "font/woff2";
              break;
            case ".ttf":
              contentType = "font/ttf";
              break;
            case ".ico":
              contentType = "image/x-icon";
              break;
          }
          res.writeHead(200, { "Content-Type": contentType });
          res.end(data);
        }
      });
    });
    server.listen(port, () => {
      const port2 = plugin.settings.port;
      new import_obsidian3.Notice(`${t("StartDrawioClientSever")} ${port2}`);
      resolve(server);
    }).on("error", (err) => {
      if (err.code === "EADDRINUSE") {
        new import_obsidian3.Notice(`\u274C \u041F\u043E\u0440\u0442 ${port} \u0443\u0436\u0435 \u0437\u0430\u043D\u044F\u0442. \u0421\u0435\u0440\u0432\u0435\u0440 Draw.io \u043D\u0435 \u0437\u0430\u043F\u0443\u0449\u0435\u043D.`);
        console.error(`\u041F\u043E\u0440\u0442 ${port} \u0443\u0436\u0435 \u0437\u0430\u043D\u044F\u0442.`);
      } else {
        new import_obsidian3.Notice(`\u274C \u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0437\u0430\u043F\u0443\u0441\u0442\u0438\u0442\u044C \u0441\u0435\u0440\u0432\u0435\u0440 Draw.io: ${err.message}`);
        console.error(`\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0437\u0430\u043F\u0443\u0441\u0442\u0438\u0442\u044C \u0441\u0435\u0440\u0432\u0435\u0440 Draw.io:`, err);
      }
      reject(err);
    });
  });
}
async function launchDrawioServerLogic(plugin) {
  if (plugin.isServerOpen)
    return;
  const PORT = plugin.settings.port;
  const { webAppPath } = getDrawioPaths(plugin.app, plugin.manifest.dir);
  try {
    plugin.isServerOpen = await serverStart(plugin, webAppPath, Number(PORT));
    await new Promise((res) => setTimeout(res, 1e3));
    console.log(plugin.settings.port);
  } catch (error) {
    plugin.isServerOpen = null;
  }
}

// settings/Settings.ts
var DEFAULT_SETTINGS = {
  port: "1717",
  centeringDiagram: true,
  percentSize: true,
  interactiveDiagram: true,
  useMarkdownLinks: false,
  Folder: "drawio",
  diagramSize: ""
};

// settings/Settings-tab.ts
var import_obsidian4 = require("obsidian");
var DrawioTab = class extends import_obsidian4.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    let { containerEl } = this;
    containerEl.empty();
    new import_obsidian4.Setting(containerEl).setName("Set port").setDesc("Set port").addText(
      (text) => text.setPlaceholder("1717").setValue(this.plugin.settings.port).onChange(async (value) => {
        this.plugin.settings.port = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian4.Setting(containerEl).setName("Centering Diagram").setDesc("If active all diagram will be position to center").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.centeringDiagram).onChange(async (value) => {
        this.plugin.settings.centeringDiagram = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian4.Setting(containerEl).setName("Percent size").setDesc("Percent Size").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.percentSize).onChange(async (value) => {
        this.plugin.settings.percentSize = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian4.Setting(containerEl).setName("Interactive diagrams").setDesc("Interactive diagrams").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.interactiveDiagram).onChange(async (value) => {
        this.plugin.settings.interactiveDiagram = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian4.Setting(containerEl).setName("Use markdown Links").setDesc("If enable link will be markdown link style").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.useMarkdownLinks).onChange(async (value) => {
        this.plugin.settings.useMarkdownLinks = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian4.Setting(containerEl).setName("Select folder").setDesc("Select folder that save diagrams").addDropdown(
      (dropdown) => {
        const folders = this.app.vault.getAllLoadedFiles().filter((file) => file instanceof import_obsidian4.TFolder);
        folders.forEach((folder) => {
          dropdown.addOption(folder.path, folder.path);
        });
        dropdown.setValue(this.plugin.settings.Folder);
        dropdown.onChange(async (value) => {
          this.plugin.settings.Folder = value;
          await this.plugin.saveSettings();
        });
      }
    );
    new import_obsidian4.Setting(containerEl).setName("diagram width").setDesc("Set default diagram size").addText(
      (text) => text.setPlaceholder("100%").setValue(this.plugin.settings.diagramSize).onChange(async (value) => {
        this.plugin.settings.diagramSize = value;
        await this.plugin.saveSettings();
      })
    );
  }
};

// utils/centeringDiagrams.ts
async function CenteringDiagrams(plugin) {
  if (!plugin.settings.centeringDiagram) {
    return;
  } else {
    plugin.registerMarkdownPostProcessor((el, ctx) => {
      const embeds = el.querySelectorAll('span.internal-embed[src$=".drawio.svg"]');
      embeds.forEach((embed) => {
        var _a;
        const wrapper = document.createElement("div");
        wrapper.style.textAlign = "center";
        wrapper.style.width = "100%";
        const img = embed.querySelector("img");
        if (img) {
          img.style.width = "100%";
          img.style.height = "auto";
          img.style.maxWidth = "100%";
        }
        if (embed.parentElement && embed.parentElement.tagName === "DIV")
          return;
        (_a = embed.parentElement) == null ? void 0 : _a.insertBefore(wrapper, embed);
        wrapper.appendChild(embed);
      });
    });
  }
  ;
}

// utils/DefaultDiagramSize.ts
async function DefaultDiagramSize(plugin) {
  if (!plugin.settings.percentSize) {
    return;
  } else {
    plugin.registerMarkdownPostProcessor((el, ctx) => {
      const embeds = el.querySelectorAll('span.internal-embed[src$=".drawio.svg"]');
      embeds.forEach((embed) => {
        const width = embed.getAttribute("alt");
        const percentpattern = /^(100|[1-9]?\d)%$/;
        if (percentpattern.test(width != null ? width : "")) {
          embed.setAttribute("width", width);
        }
      });
    });
  }
}

// handlers/externalTooltip.ts
var ExternalTooltip = class {
  constructor() {
    this.hideTimeout = null;
    this.tooltipElement = document.createElement("div");
    this.tooltipElement.classList.add("drawio-custom-tooltip");
    this.tooltipElement.style.position = "absolute";
    this.tooltipElement.style.display = "none";
    this.tooltipElement.style.zIndex = "9999";
    this.tooltipElement.addEventListener("mouseenter", () => {
      if (this.hideTimeout) {
        clearTimeout(this.hideTimeout);
        this.hideTimeout = null;
      }
    });
    this.tooltipElement.addEventListener("mouseleave", () => {
      this.hide();
    });
    document.body.appendChild(this.tooltipElement);
  }
  show(text, event) {
    if (!document.body.contains(this.tooltipElement)) {
      document.body.appendChild(this.tooltipElement);
    }
    this.tooltipElement.textContent = text;
    this.tooltipElement.style.display = "block";
    this.updatePosition(event);
  }
  hide(delay = 100) {
    if (this.hideTimeout) {
      clearTimeout(this.hideTimeout);
    }
    this.hideTimeout = setTimeout(() => {
      this.tooltipElement.style.display = "none";
    }, delay);
  }
  updatePosition(event) {
    const offsetX = 15;
    const offsetY = 15;
    let newLeft = event.clientX + window.scrollX + offsetX;
    let newTop = event.clientY + window.scrollY + offsetY;
    const tooltipWidth = this.tooltipElement.offsetWidth;
    const tooltipHeight = this.tooltipElement.offsetHeight;
    const viewportWidth = window.innerWidth;
    const viewportHeight = window.innerHeight;
    if (newLeft + tooltipWidth > viewportWidth + window.scrollX) {
      newLeft = event.clientX + window.scrollX - tooltipWidth - offsetX;
    }
    if (newTop + tooltipHeight > viewportHeight + window.scrollY) {
      newTop = event.clientY + window.scrollY - tooltipHeight - offsetY;
    }
    newLeft = Math.max(newLeft, window.scrollX + offsetX);
    newTop = Math.max(newTop, window.scrollY + offsetY);
    this.tooltipElement.style.left = `${newLeft}px`;
    this.tooltipElement.style.top = `${newTop}px`;
  }
};

// handlers/getFileContent.ts
var import_obsidian5 = require("obsidian");

// utils/findFileByName.ts
function findFileByName(fileName, app) {
  const files = app.vault.getFiles();
  for (const file of files) {
    if (file.name === fileName) {
      return file;
    }
  }
  return null;
}

// handlers/getFileContent.ts
function getFileContent(element, app) {
  const src = element.getAttribute("src");
  if (!src)
    return null;
  const filename = src.split("/").pop();
  if (!filename)
    return null;
  const file = findFileByName(filename, app);
  return file instanceof import_obsidian5.TFile ? file : null;
}

// utils/interactiveDiagrams.ts
var import_obsidian6 = require("obsidian");
var tooltip = new ExternalTooltip();
async function InteractiveDiagrams(plugin) {
  if (!plugin.settings.interactiveDiagram)
    return;
  plugin.registerMarkdownPostProcessor(async (el, ctx) => {
    const embeds = el.querySelectorAll('span.internal-embed[src$=".drawio.svg"]');
    for (const embed of embeds) {
      embed.addClass("drawio-container");
      const file = getFileContent(embed, plugin.app);
      if (!(file instanceof import_obsidian6.TFile))
        continue;
      const data = await plugin.app.vault.read(file);
      const img = embed.querySelector("img");
      let imgSizee = null;
      if (img.hasAttribute("width")) {
        imgSizee = img.getAttribute("width");
      }
      if (img.hasAttribute("alt") && img.getAttribute("alt").includes("%")) {
        imgSizee = img.getAttribute("alt");
      }
      const temp = document.createElement("div");
      temp.innerHTML = data;
      const svgElement = temp.querySelector("svg");
      if (!svgElement)
        continue;
      img.replaceWith(svgElement);
      svgElement.addClass("drawio-svg");
      if (imgSizee !== null && !imgSizee.includes("%")) {
        svgElement.setAttribute("width", imgSizee + "px");
        svgElement.setAttribute("height", "100%");
      } else if (imgSizee !== null) {
        svgElement.setAttribute("width", imgSizee);
        svgElement.setAttribute("height", "100%");
      }
      if (document.body.classList.contains("theme-light")) {
        svgElement.addClass("drawio-scheme-light");
      } else {
        svgElement.addClass("drawio-scheme-dark");
      }
      const links = svgElement.querySelectorAll("a");
      for (const link of links) {
        const hrefLink = link.getAttribute("xlink:href");
        let cleanHref = hrefLink;
        const externalLinks = hrefLink.match(/^https?:\/\//);
        if (externalLinks) {
          cleanHref = externalLinks.input;
          link.addClass("external-link");
          const moveHandler = tooltip.updatePosition.bind(tooltip);
          link.addEventListener("mouseenter", (event) => {
            tooltip.show(cleanHref, event);
            document.addEventListener("mousemove", moveHandler);
          });
          link.addEventListener("mouseleave", () => {
            tooltip.hide();
            document.removeEventListener("mousemove", moveHandler);
          });
        }
        ;
        const matchRound = hrefLink.match(/\[.*?\]\((.*?)\)/);
        if (matchRound) {
          cleanHref = matchRound[1];
          link.addClass("internal-link");
        }
        const matchDoubleSquare = hrefLink.match(/\[\[(.*?)\]\]/);
        if (matchDoubleSquare) {
          cleanHref = matchDoubleSquare[1];
          link.addClass("internal-link");
        }
        link.setAttribute("href", cleanHref);
      }
    }
  });
}

// handlers/findDiagramFileUnderCursor.ts
var import_obsidian7 = require("obsidian");
function findDiagramFileUnderCursor(app, editor, view) {
  var _a, _b;
  const cursor = editor.getCursor();
  const line = editor.getLine(cursor.line);
  const linkRegex = /!\[\[([^|\]]+\.(?:drawio\.svg|drawio))[^\]]*\]\]/g;
  let execMatch;
  while ((execMatch = linkRegex.exec(line)) !== null) {
    const fullMatchText = execMatch[0];
    const linkText = execMatch[1];
    const startIndex = execMatch.index;
    const endIndex = startIndex + fullMatchText.length;
    if (cursor.ch >= startIndex && cursor.ch <= endIndex) {
      const linkedFile = app.metadataCache.getFirstLinkpathDest(linkText, (_b = (_a = view.file) == null ? void 0 : _a.path) != null ? _b : "");
      if (linkedFile instanceof import_obsidian7.TFile) {
        return linkedFile;
      }
    }
  }
  return null;
}

// views/modalDrawio.ts
var import_obsidian8 = require("obsidian");

// utils/forceMarkdownViewUpdate.ts
async function forceMarkdownViewUpdate(app, file) {
  var _a, _b;
  if (!file) {
    console.warn("forceMarkdownViewUpdate: \u0412\u044B\u0437\u0432\u0430\u043D\u0430 \u0441 null \u0444\u0430\u0439\u043B\u043E\u043C. \u041D\u0435\u0432\u043E\u0437\u043C\u043E\u0436\u043D\u043E \u043E\u043F\u0440\u0435\u0434\u0435\u043B\u0438\u0442\u044C, \u0438\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u044F \u043A\u0430\u043A\u043E\u0433\u043E \u0444\u0430\u0439\u043B\u0430 \u043E\u0442\u0441\u043B\u0435\u0436\u0438\u0432\u0430\u0442\u044C.");
    return;
  }
  const diagramFile = file;
  const leaves = app.workspace.getLeavesOfType("markdown");
  for (const leaf of leaves) {
    const mdView = leaf.view;
    if (!mdView || !mdView.file) {
      continue;
    }
    const currentViewFile = mdView.file;
    try {
      let needsRebuild = false;
      if (!currentViewFile || !currentViewFile.path) {
        console.warn(`forceMarkdownViewUpdate: currentViewFile \u0438\u043B\u0438 \u0435\u0433\u043E \u043F\u0443\u0442\u044C \u0441\u0442\u0430\u043B null/undefined \u0434\u043B\u044F \u043B\u0438\u0441\u0442\u0430 ${leaf}. \u041F\u0440\u043E\u043F\u0443\u0441\u043A\u0430\u0435\u043C \u043F\u0435\u0440\u0435\u0441\u0442\u0440\u043E\u0439\u043A\u0443.`);
        continue;
      }
      if (currentViewFile.path === diagramFile.path) {
        needsRebuild = true;
      } else {
        const fileContent = await app.vault.cachedRead(currentViewFile);
        if (fileContent.includes(diagramFile.name) || fileContent.includes(encodeURI(diagramFile.name))) {
          needsRebuild = true;
        }
      }
      if (needsRebuild) {
        if (typeof leaf.rebuildView === "function") {
          await leaf.rebuildView();
        } else {
          const viewState = leaf.getViewState();
          await leaf.setViewState({ type: "empty" });
          await leaf.setViewState(viewState);
        }
      }
    } catch (err) {
      const currentViewFilePathForLog = (_a = currentViewFile == null ? void 0 : currentViewFile.path) != null ? _a : "unknown file (no path)";
      const diagramFilePathForLog = (_b = diagramFile == null ? void 0 : diagramFile.path) != null ? _b : "unknown diagram path";
      console.warn(`\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u043E\u0431\u043D\u043E\u0432\u0438\u0442\u044C \u043F\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043B\u0435\u043D\u0438\u0435 \u0434\u043B\u044F ${currentViewFilePathForLog} \u043E\u0442\u043D\u043E\u0441\u0438\u0442\u0435\u043B\u044C\u043D\u043E \u0438\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u0439 \u0432 ${diagramFilePathForLog}:`, err);
    }
  }
}

// views/modalDrawio.ts
var DrawioEmbedModal = class extends import_obsidian8.Modal {
  constructor(app, editor, plugin, fileToEdit = null) {
    super(app);
    this.currentFile = null;
    this.iframe = null;
    this.messageHandler = null;
    this.isEmptyDiagram = true;
    this.editor = editor;
    this.plugin = plugin;
    this.currentFile = fileToEdit;
    this.modalEl.addClass("drawio-embed-modal");
    const modalBg = this.containerEl.querySelector(".modal-bg");
    if (modalBg) {
      this.scope.register([], "Escape", () => false);
      modalBg.addEventListener("click", (e) => e.stopPropagation(), true);
    }
  }
  async onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    this.titleEl.setText(this.currentFile ? `Edit Diagram: ${this.currentFile.name}` : "Create New Diagram");
    if (this.currentFile) {
      this.isEmptyDiagram = false;
    }
    const isDarkTheme = document.body.hasClass("theme-dark");
    const drawioUrl = `http://localhost:${this.plugin.settings.port}/?embed=1&proto=json&libraries=1&spin=1&splash=0` + (isDarkTheme ? `&ui=dark&dark=1` : `&ui=atlas`);
    this.iframe = contentEl.createEl("iframe", { attr: { src: drawioUrl } });
    this.iframe.addClass("drawioIframe");
    this.messageHandler = this.createMessageHandler();
    window.addEventListener("message", this.messageHandler);
  }
  async onClose() {
    const { contentEl } = this;
    contentEl.empty();
    if (this.messageHandler) {
      window.removeEventListener("message", this.messageHandler);
      this.messageHandler = null;
    }
    await this.handleModalCloseBasedOnContent();
    this.iframe = null;
    this.isEmptyDiagram = true;
    this.currentFile = null;
  }
  sendMessageToDrawio(message) {
    if (this.iframe && this.iframe.contentWindow) {
      this.iframe.contentWindow.postMessage(JSON.stringify(message), `http://localhost:${this.plugin.settings.port}`);
    }
  }
  async handleNewDiagramCreation() {
    const folderPath = this.plugin.settings.Folder;
    try {
      await this.app.vault.createFolder(folderPath);
    } catch (e) {
      if (!e.message.includes("Folder already exists")) {
        new import_obsidian8.Notice("\u274C Could not create folder for new diagram.");
        console.error("Error creating Drawio folder:", e);
        return null;
      }
    }
    const now = new Date();
    const timestamp = `${now.getFullYear()}${(now.getMonth() + 1).toString().padStart(2, "0")}${now.getDate().toString().padStart(2, "0")}${now.getHours().toString().padStart(2, "0")}${now.getMinutes().toString().padStart(2, "0")}${now.getSeconds().toString().padStart(2, "0")}`;
    const fileName = `diagram_${timestamp}.drawio.svg`;
    const fullPath = `${folderPath}/${fileName}`;
    const emptySvgContent = `<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1px" height="1px" viewBox="-0.5 -0.5 1 1" content="&lt;mxGraphModel&gt;&lt;root&gt;&lt;mxCell id=&quot;0&quot;/&gt;&lt;mxCell id=&quot;1&quot; parent=&quot;0&quot;/&gt;&lt;/root&gt;&lt;/mxGraphModel&gt;"><defs/><g/></svg>`;
    try {
      return await this.app.vault.create(fullPath, emptySvgContent);
    } catch (e) {
      new import_obsidian8.Notice(`\u274C Failed to create new diagram file: ${fullPath}`);
      console.error("Error creating new diagram file:", e);
      return null;
    }
  }
  createMessageHandler() {
    return async (event) => {
      if (event.origin !== `http://localhost:${this.plugin.settings.port}`)
        return;
      let msg;
      try {
        msg = typeof event.data === "string" ? JSON.parse(event.data) : event.data;
      } catch (e) {
        console.warn("Could not parse Draw.io message:", event.data, e);
        return;
      }
      switch (msg.event) {
        case "init":
          await this.handleInitMessage();
          break;
        case "save":
          this.sendMessageToDrawio({ action: "export", format: "xmlsvg", xml: 1, empty: 1 });
          break;
        case "export":
          await this.handleExportMessage(msg.data);
          break;
        case "change":
          this.handleChangeMessage(msg.xml);
          break;
        case "exit":
          this.close();
          break;
      }
    };
  }
  async handleInitMessage() {
    if (this.currentFile) {
      const fileContent = await this.app.vault.read(this.currentFile);
      this.sendMessageToDrawio({ action: "load", xml: fileContent, autosave: 1 });
    } else {
      const emptyXml = "<mxGraphModel><root><mxCell id='0'/><mxCell id='1' parent='0'/></root></mxGraphModel>";
      this.sendMessageToDrawio({ action: "load", xml: emptyXml, autosave: 1 });
    }
  }
  async handleExportMessage(svgDataUri) {
    await this.saveDiagramFromModal(svgDataUri);
  }
  handleChangeMessage(xmlContent) {
    const baseEmptyXml = "<mxGraphModel><root><mxCell id='0'/><mxCell id='1' parent='0'/></root></mxGraphModel>";
    this.isEmptyDiagram = !xmlContent || xmlContent === baseEmptyXml;
  }
  async saveDiagramFromModal(svgDataUri) {
    var _a;
    let contentToSave;
    try {
      contentToSave = this.decodeSvgDataUri(svgDataUri);
    } catch (e) {
      new import_obsidian8.Notice(`\u274C Failed to decode SVG content: ${e.message}`);
      return;
    }
    if (this.isSvgContentActuallyEmpty(contentToSave)) {
      new import_obsidian8.Notice("Diagram is empty. Nothing to save.");
      return;
    }
    if (!this.currentFile) {
      const newFile = await this.handleNewDiagramCreation();
      if (!newFile)
        return;
      this.currentFile = newFile;
      this.titleEl.setText(`Edit Diagram: ${this.currentFile.name}`);
      const defaultWidth = this.plugin.settings.diagramSize;
      let embedLink;
      if (this.plugin.settings.useMarkdownLinks) {
        const alt = (_a = defaultWidth == null ? void 0 : defaultWidth.trim()) != null ? _a : "";
        const relativePath = this.currentFile.path;
        embedLink = `![${alt}](${relativePath})`;
      } else {
        embedLink = (defaultWidth == null ? void 0 : defaultWidth.trim()) ? `![[${this.currentFile.path}|${defaultWidth.trim()}]]` : `![[${this.currentFile.path}]]`;
      }
      setTimeout(() => {
        this.editor.replaceSelection(embedLink);
      }, 500);
    }
    try {
      await this.app.vault.modify(this.currentFile, contentToSave);
      new import_obsidian8.Notice(`\u{1F4BE} Diagram saved: ${this.currentFile.path}`);
      forceMarkdownViewUpdate(this.app, this.currentFile);
      this.isEmptyDiagram = false;
    } catch (e) {
      new import_obsidian8.Notice(`\u274C Failed to save diagram: ${this.currentFile.path}`);
      console.error("Error saving diagram:", e);
    }
  }
  decodeSvgDataUri(svgDataUri) {
    if (svgDataUri.startsWith("data:image/svg+xml;base64,")) {
      const base64Part = svgDataUri.split(",")[1];
      return Buffer.from(base64Part, "base64").toString("utf-8");
    } else if (svgDataUri.startsWith("data:image/svg+xml,")) {
      return decodeURIComponent(svgDataUri.split(",")[1]);
    } else {
      throw new Error("Invalid SVG data format received.");
    }
  }
  isSvgContentActuallyEmpty(content) {
    const emptyDrawioXmlInSvgContent = `content="&lt;mxGraphModel&gt;&lt;root&gt;&lt;mxCell id=&quot;0&quot;/&gt;&lt;mxCell id=&quot;1&quot; parent=&quot;0&quot;/&gt;&lt;/root&gt;&lt;/mxGraphModel&gt;"`;
    return content.includes(emptyDrawioXmlInSvgContent) && (content.match(/<g\b[^>]*>/g) || []).length === 1;
  }
  async handleModalCloseBasedOnContent() {
    if (!this.currentFile)
      return;
    if (this.isEmptyDiagram) {
      try {
        const pathToDelete = this.currentFile.path;
        await this.app.fileManager.trashFile(this.currentFile);
        const editorContent = this.editor.getValue();
        const linkToDeleteSimple = `![[${pathToDelete}]]`;
        const linkToDeleteEncoded = `![[${encodeURI(pathToDelete)}]]`;
        let finalContent = editorContent.replace(linkToDeleteSimple, "");
        const linkWithModifierRegex = new RegExp(`!\\[\\[${pathToDelete.replace(/[-\/\\^$*+?.()|[\]{}]/g, "\\$&")}\\|[^\\]]+\\]\\]`, "g");
        finalContent = finalContent.replace(linkWithModifierRegex, "");
        if (finalContent !== editorContent) {
          this.editor.setValue(finalContent);
        }
      } catch (e) {
        if (!(e instanceof Error && e.message.toLowerCase().includes("file already deleted"))) {
          new import_obsidian8.Notice(`\u274C Failed to delete empty diagram file: ${this.currentFile.path}`);
        }
      }
    }
  }
};

// main.ts
var DrawioPlugin = class extends import_obsidian9.Plugin {
  constructor() {
    super(...arguments);
    this.isServerOpen = null;
  }
  async onload() {
    await this.loadSettings();
    this.addSettingTab(new DrawioTab(this.app, this));
    this.registerView(
      DRAWIOVIEW,
      (leaf) => new Drawioview(leaf, this)
    );
    const userLang = (window.localStorage.getItem("language") || "en").split("-")[0];
    setLocale(userLang);
    this.addRibbonIcon("dice", t("ribonIconTitle"), async () => {
      this.activateView();
      await launchDrawioServerLogic(this);
    });
    await CenteringDiagrams(this);
    await DefaultDiagramSize(this);
    await InteractiveDiagrams(this);
    this.registerEvent(
      this.app.workspace.on("editor-menu", (menu, editor, view) => {
        const fileToEdit = findDiagramFileUnderCursor(this.app, editor, view);
        const openDrawioModal = async (file) => {
          await launchDrawioServerLogic(this);
          new DrawioEmbedModal(this.app, editor, this, file).open();
        };
        if (fileToEdit) {
          menu.addItem((item) => {
            item.setTitle(`Edit ${fileToEdit.basename}`).setIcon("pencil").setSection("drawio-actions").onClick(() => openDrawioModal(fileToEdit));
          });
        } else {
          menu.addItem((item) => {
            item.setTitle("Embed New Draw.io Diagram").setIcon("shapes").setSection("drawio-actions").onClick(() => openDrawioModal());
          });
        }
      })
    );
    this.addCommand({
      id: "drawio-create-or-edit",
      name: "Create or edit Draw.io diagram",
      editorCallback: async (editor, view) => {
        const fileToEdit = findDiagramFileUnderCursor(this.app, editor, view);
        await launchDrawioServerLogic(this);
        if (fileToEdit) {
          new DrawioEmbedModal(this.app, editor, this, fileToEdit).open();
        } else {
          new DrawioEmbedModal(this.app, editor, this).open();
        }
      }
    });
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  async onunload() {
    if (this.isServerOpen) {
      this.isServerOpen.close(() => {
        new import_obsidian9.Notice(t("StopDrawioClinetServer"));
        this.isServerOpen = null;
      });
    }
    const ExternalLinkTooltip = document.querySelector(".drawio-custom-tooltip");
    if (ExternalLinkTooltip) {
      ExternalLinkTooltip.remove();
    }
  }
  async activateView() {
    const leaf = this.app.workspace.getLeaf(false);
    if (leaf) {
      await leaf.setViewState({
        type: DRAWIOVIEW,
        active: true
      });
      this.app.workspace.revealLeaf(leaf);
    }
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJjb25zdHMudHMiLCAidmlld3MvZHJhd2lvVmlldy50cyIsICJsb2NhbGVzL2VuLmpzb24iLCAibG9jYWxlcy9ydS5qc29uIiwgImxvY2FsZXMvaTE4bi50cyIsICJ1dGlscy9mb2xkZXJFeGlzdHMudHMiLCAiaGFuZGxlcnMvU2VydmVyU3RhcnQudHMiLCAic2V0dGluZ3MvU2V0dGluZ3MudHMiLCAic2V0dGluZ3MvU2V0dGluZ3MtdGFiLnRzIiwgInV0aWxzL2NlbnRlcmluZ0RpYWdyYW1zLnRzIiwgInV0aWxzL0RlZmF1bHREaWFncmFtU2l6ZS50cyIsICJoYW5kbGVycy9leHRlcm5hbFRvb2x0aXAudHMiLCAiaGFuZGxlcnMvZ2V0RmlsZUNvbnRlbnQudHMiLCAidXRpbHMvZmluZEZpbGVCeU5hbWUudHMiLCAidXRpbHMvaW50ZXJhY3RpdmVEaWFncmFtcy50cyIsICJoYW5kbGVycy9maW5kRGlhZ3JhbUZpbGVVbmRlckN1cnNvci50cyIsICJ2aWV3cy9tb2RhbERyYXdpby50cyIsICJ1dGlscy9mb3JjZU1hcmtkb3duVmlld1VwZGF0ZS50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgRWRpdG9yLCBNYXJrZG93bkVkaXRWaWV3LCBNYXJrZG93blZpZXcsIE1lbnUsIE5vdGljZSwgUGx1Z2luLCBURmlsZSwgV29ya3NwYWNlTGVhZiB9IGZyb20gJ29ic2lkaWFuJztcblxuaW1wb3J0IHsgRFJBV0lPVklFVyB9IGZyb20gJ2NvbnN0cyc7XG5pbXBvcnQgeyBEcmF3aW92aWV3IH0gZnJvbSAndmlld3MvZHJhd2lvVmlldyc7XG5pbXBvcnQgeyBzZXRMb2NhbGUsIHQgfSBmcm9tICdsb2NhbGVzL2kxOG4nO1xuaW1wb3J0IHsgU2VydmVyIH0gZnJvbSAnbm9kZTpodHRwJztcbmltcG9ydCB7IGxhdW5jaERyYXdpb1NlcnZlckxvZ2ljIH0gZnJvbSAnaGFuZGxlcnMvU2VydmVyU3RhcnQnO1xuaW1wb3J0IHsgRHJhd2lvU2V0dGluZ3MsIERFRkFVTFRfU0VUVElOR1MgfSBmcm9tICdzZXR0aW5ncy9TZXR0aW5ncyc7XG5pbXBvcnQgeyBEcmF3aW9UYWIgfSBmcm9tICdzZXR0aW5ncy9TZXR0aW5ncy10YWInO1xuaW1wb3J0IHsgQ2VudGVyaW5nRGlhZ3JhbXMgfSBmcm9tICd1dGlscy9jZW50ZXJpbmdEaWFncmFtcyc7XG5pbXBvcnQgeyBEZWZhdWx0RGlhZ3JhbVNpemUgfSBmcm9tICd1dGlscy9EZWZhdWx0RGlhZ3JhbVNpemUnO1xuaW1wb3J0IHsgSW50ZXJhY3RpdmVEaWFncmFtcyB9IGZyb20gJ3V0aWxzL2ludGVyYWN0aXZlRGlhZ3JhbXMnO1xuaW1wb3J0IHsgZmluZERpYWdyYW1GaWxlVW5kZXJDdXJzb3IgfSBmcm9tICdoYW5kbGVycy9maW5kRGlhZ3JhbUZpbGVVbmRlckN1cnNvcic7XG5pbXBvcnQgeyBEcmF3aW9FbWJlZE1vZGFsIH0gZnJvbSAndmlld3MvbW9kYWxEcmF3aW8nO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBEcmF3aW9QbHVnaW4gZXh0ZW5kcyBQbHVnaW4ge1xuXG5pc1NlcnZlck9wZW46IFNlcnZlciB8IG51bGwgPSBudWxsO1xuc2V0dGluZ3M6IERyYXdpb1NldHRpbmdzO1xuXG4gIGFzeW5jIG9ubG9hZCgpIHtcblxuXHRhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xuXHR0aGlzLmFkZFNldHRpbmdUYWIobmV3IERyYXdpb1RhYih0aGlzLmFwcCwgdGhpcykpO1xuXG5cdHRoaXMucmVnaXN0ZXJWaWV3KFxuXHRcdERSQVdJT1ZJRVcsXG5cdFx0KGxlYWYpID0+IG5ldyBEcmF3aW92aWV3KGxlYWYsIHRoaXMpIFxuXHQpXG5cdFxuXHRjb25zdCB1c2VyTGFuZyA9ICh3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2xhbmd1YWdlJykgfHwgJ2VuJykuc3BsaXQoJy0nKVswXTtcblx0c2V0TG9jYWxlKHVzZXJMYW5nKTtcblxuXHR0aGlzLmFkZFJpYmJvbkljb24oJ2RpY2UnLCB0KFwicmlib25JY29uVGl0bGVcIiksIGFzeW5jICgpID0+IHtcblx0XHR0aGlzLmFjdGl2YXRlVmlldygpXG5cdFx0YXdhaXQgbGF1bmNoRHJhd2lvU2VydmVyTG9naWModGhpcylcblx0fSkgXG5cblx0YXdhaXQgQ2VudGVyaW5nRGlhZ3JhbXModGhpcylcblx0YXdhaXQgRGVmYXVsdERpYWdyYW1TaXplKHRoaXMpXG5cdGF3YWl0IEludGVyYWN0aXZlRGlhZ3JhbXModGhpcylcblxuXHR0aGlzLnJlZ2lzdGVyRXZlbnQoXG5cdFx0dGhpcy5hcHAud29ya3NwYWNlLm9uKFwiZWRpdG9yLW1lbnVcIiwgKG1lbnU6IE1lbnUsIGVkaXRvcjogRWRpdG9yLCB2aWV3OiBNYXJrZG93blZpZXcpID0+IHtcblx0XHRcdGNvbnN0IGZpbGVUb0VkaXQgPSBmaW5kRGlhZ3JhbUZpbGVVbmRlckN1cnNvcih0aGlzLmFwcCwgZWRpdG9yLCB2aWV3KTtcblx0XHRcdGNvbnN0IG9wZW5EcmF3aW9Nb2RhbCA9IGFzeW5jIChmaWxlPzogVEZpbGUpID0+IHtcbiAgICAgICAgICAgICAgICBhd2FpdCBsYXVuY2hEcmF3aW9TZXJ2ZXJMb2dpYyh0aGlzKTsgXG4gICAgICAgICAgICAgICAgbmV3IERyYXdpb0VtYmVkTW9kYWwodGhpcy5hcHAsIGVkaXRvciwgdGhpcywgZmlsZSkub3BlbigpO1xuICAgICAgICAgICAgfTtcblxuXHRcdFx0aWYoZmlsZVRvRWRpdCkge1xuXHRcdFx0XHRtZW51LmFkZEl0ZW0oKGl0ZW0pID0+IHtcblx0XHRcdFx0XHRpdGVtXG5cdFx0XHRcdFx0XHQuc2V0VGl0bGUoYEVkaXQgJHtmaWxlVG9FZGl0LmJhc2VuYW1lfWApXG4gICAgICAgICAgICAgICAgICAgICAgICAuc2V0SWNvbihcInBlbmNpbFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnNldFNlY3Rpb24oXCJkcmF3aW8tYWN0aW9uc1wiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4gb3BlbkRyYXdpb01vZGFsKGZpbGVUb0VkaXQpKTtcblx0XHRcdFx0fSlcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdG1lbnUuYWRkSXRlbSgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpdGVtXG4gICAgICAgICAgICAgICAgICAgICAgICAuc2V0VGl0bGUoXCJFbWJlZCBOZXcgRHJhdy5pbyBEaWFncmFtXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuc2V0SWNvbihcInNoYXBlc1wiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnNldFNlY3Rpb24oXCJkcmF3aW8tYWN0aW9uc1wiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4gb3BlbkRyYXdpb01vZGFsKCkpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblx0XHRcdH1cblx0XHR9KVxuXHQpXG5cbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiAnZHJhd2lvLWNyZWF0ZS1vci1lZGl0JyxcbiAgICAgICAgICAgIG5hbWU6ICdDcmVhdGUgb3IgZWRpdCBEcmF3LmlvIGRpYWdyYW0nLFxuICAgICAgICAgICAgZWRpdG9yQ2FsbGJhY2s6IGFzeW5jIChlZGl0b3I6IEVkaXRvciwgdmlldzogTWFya2Rvd25WaWV3KSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZVRvRWRpdCA9IGZpbmREaWFncmFtRmlsZVVuZGVyQ3Vyc29yKHRoaXMuYXBwLCBlZGl0b3IsIHZpZXcpOyBcbiAgICAgICAgICAgICAgICBhd2FpdCBsYXVuY2hEcmF3aW9TZXJ2ZXJMb2dpYyh0aGlzKTsgXG5cbiAgICAgICAgICAgICAgICBpZiAoZmlsZVRvRWRpdCkge1xuICAgICAgICAgICAgICAgICAgICBuZXcgRHJhd2lvRW1iZWRNb2RhbCh0aGlzLmFwcCwgZWRpdG9yLCB0aGlzLCBmaWxlVG9FZGl0KS5vcGVuKCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3IERyYXdpb0VtYmVkTW9kYWwodGhpcy5hcHAsIGVkaXRvciwgdGhpcykub3BlbigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gIH1cblxuXG5hc3luYyBsb2FkU2V0dGluZ3MoKSB7XG5cdHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBhd2FpdCB0aGlzLmxvYWREYXRhKCkpO1xufVxuXG5hc3luYyBzYXZlU2V0dGluZ3MoKSB7XG5cdGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XG59XG5cbiAgYXN5bmMgb251bmxvYWQoKSB7XG5cdCAgaWYgKHRoaXMuaXNTZXJ2ZXJPcGVuKSB7XG4gICAgICAgIHRoaXMuaXNTZXJ2ZXJPcGVuLmNsb3NlKCgpID0+IHtcbiAgICAgICAgICBuZXcgTm90aWNlKHQoXCJTdG9wRHJhd2lvQ2xpbmV0U2VydmVyXCIpKTtcbiAgICAgICAgICB0aGlzLmlzU2VydmVyT3BlbiA9IG51bGw7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGNvbnN0IEV4dGVybmFsTGlua1Rvb2x0aXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZHJhd2lvLWN1c3RvbS10b29sdGlwJyk7XG4gICAgaWYgKEV4dGVybmFsTGlua1Rvb2x0aXApIHtcbiAgICAgIEV4dGVybmFsTGlua1Rvb2x0aXAucmVtb3ZlKCk7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgYWN0aXZhdGVWaWV3KCkge1xuXHRjb25zdCBsZWFmID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYWYoZmFsc2UpO1xuXHRpZihsZWFmKSB7XG5cdFx0YXdhaXQgbGVhZi5zZXRWaWV3U3RhdGUoe1xuXHRcdHR5cGU6IERSQVdJT1ZJRVcsXG5cdFx0YWN0aXZlOiB0cnVlLFxuICAgIH0pO1xuICAgIHRoaXMuYXBwLndvcmtzcGFjZS5yZXZlYWxMZWFmKGxlYWYpO1xuXHR9XG4gIH1cbn0iLCAiZXhwb3J0IGNvbnN0IERSQVdJT1ZJRVcgPSAnZHJhd2lvdmlldyc7IiwgImltcG9ydCB7IEFwcCwgRmlsZVN5c3RlbUFkYXB0ZXIsIEl0ZW1WaWV3LCBURmlsZSwgV29ya3NwYWNlTGVhZiB9IGZyb20gJ29ic2lkaWFuJztcclxuXHJcbmltcG9ydCB7IERSQVdJT1ZJRVcgfSBmcm9tICdjb25zdHMnO1xyXG5pbXBvcnQgeyB0IH0gZnJvbSAnbG9jYWxlcy9pMThuJztcclxuaW1wb3J0IERyYXdpb1BsdWdpbiBmcm9tICdtYWluJzsgLy8gTWFrZSBzdXJlIHRvIGltcG9ydCBEcmF3aW9QbHVnaW5cclxuaW1wb3J0IHsgREVGQVVMVF9TRVRUSU5HUyB9IGZyb20gJ3NldHRpbmdzL1NldHRpbmdzJztcclxuaW1wb3J0IHsgZm9sZGVyRXhpc3RzIH0gZnJvbSAndXRpbHMvZm9sZGVyRXhpc3RzJztcclxuXHJcbmV4cG9ydCBjbGFzcyBEcmF3aW92aWV3IGV4dGVuZHMgSXRlbVZpZXcge1xyXG4gICAgcHVibGljIGlmcmFtZTogSFRNTElGcmFtZUVsZW1lbnQgfCBudWxsID0gbnVsbDtcclxuICAgIHByaXZhdGUgbWVzc2FnZUhhbmRsZXI6IChldmVudDogTWVzc2FnZUV2ZW50KSA9PiB2b2lkO1xyXG4gICAgcHVibGljIHBsdWdpbjogRHJhd2lvUGx1Z2luO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKGxlYWY6IFdvcmtzcGFjZUxlYWYsIHBsdWdpbjogRHJhd2lvUGx1Z2luKSB7XHJcbiAgICAgICAgc3VwZXIobGVhZik7XHJcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XHJcbiAgICAgICAgdGhpcy5tZXNzYWdlSGFuZGxlciA9IHRoaXMubGlzdGVuZHJhd2lvbWVzc2FnZS5iaW5kKHRoaXMpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldFZpZXdUeXBlKCkge1xyXG4gICAgICAgIHJldHVybiBEUkFXSU9WSUVXO1xyXG4gICAgfVxyXG5cclxuICAgIGdldERpc3BsYXlUZXh0KCkge1xyXG4gICAgICAgIHJldHVybiB0KFwiRHJhd0lvVmlld05hbWVcIik7XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgb25PcGVuKCkge1xyXG4gICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IHRoaXMuY29udGFpbmVyRWwuY2hpbGRyZW5bMV07XHJcblxyXG4gICAgICAgIGNvbnRhaW5lci5lbXB0eSgpO1xyXG4gICAgICAgIGNvbnRhaW5lci5jcmVhdGVFbCgnaWZyYW1lJywge2F0dHI6IHtpZDogJ2RyYXdpb2lmcmFtZScsIHNyYzogYGh0dHA6Ly9sb2NhbGhvc3Q6JHt0aGlzLnBsdWdpbi5zZXR0aW5ncy5wb3J0fT9lbWJlZD0xJnByb3RvPWpzb24mdWk9ZGFya2B9fSlcclxuICAgICAgICAgIC5hZGRDbGFzcygnZHJhd2lvSWZyYW1lJylcclxuICAgICAgICB0aGlzLmlmcmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkcmF3aW9pZnJhbWUnKSBhcyBIVE1MSUZyYW1lRWxlbWVudDtcclxuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIHRoaXMubWVzc2FnZUhhbmRsZXIpO1xyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIGxpc3RlbmRyYXdpb21lc3NhZ2UoZXZlbnQ6IE1lc3NhZ2VFdmVudCkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1zZyA9IEpTT04ucGFyc2UoZXZlbnQuZGF0YSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBzd2l0Y2ggKG1zZy5ldmVudCkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnaW5pdCc6XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pZnJhbWU/LmNvbnRlbnRXaW5kb3c/LnBvc3RNZXNzYWdlKEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiAnbG9hZCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHhtbDogJzxteEdyYXBoTW9kZWw+PHJvb3Q+Li4uPC9yb290PjwvbXhHcmFwaE1vZGVsPicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiAnZXhhbXBsZS5kcmF3aW8nXHJcbiAgICAgICAgICAgICAgICAgICAgfSksIGBodHRwOi8vbG9jYWxob3N0OiR7dGhpcy5wbHVnaW4uc2V0dGluZ3MucG9ydH1gKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlICdzYXZlJzpcclxuICAgICAgICAgICAgICAgIHRoaXMuaWZyYW1lPy5jb250ZW50V2luZG93Py5wb3N0TWVzc2FnZShKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiAnZXhwb3J0JyxcclxuICAgICAgICAgICAgICAgICAgICBmb3JtYXQ6IFwieG1sc3ZnXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgeG1sOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgIH0pLCBgaHR0cDovL2xvY2FsaG9zdDoke3RoaXMucGx1Z2luLnNldHRpbmdzLnBvcnR9YCk7ICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgXCJleHBvcnRcIjoge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHN2Z0Jhc2U2NCA9IG1zZy5kYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHN2ZzY0RGF0YSA9IHN2Z0Jhc2U2NC5yZXBsYWNlKC9eZGF0YTppbWFnZVxcL3N2Z1xcK3htbDtiYXNlNjQsLywgJycpXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3ZnQ29udGVudCA9IGF0b2Ioc3ZnNjREYXRhKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB0aW1lc3RhbXAgPSBgJHtub3cuZ2V0RnVsbFllYXIoKX0keyhub3cuZ2V0TW9udGgoKSArIDEpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKX0ke25vdy5nZXREYXRlKCkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpfSR7bm93LmdldEhvdXJzKCkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpfSR7bm93LmdldE1pbnV0ZXMoKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyl9JHtub3cuZ2V0U2Vjb25kcygpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKX1gO1xyXG4gICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIGlmKGZvbGRlckV4aXN0cyh0aGlzLmFwcCwgdGhpcy5wbHVnaW4uc2V0dGluZ3MuRm9sZGVyKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFwcC52YXVsdC5jcmVhdGUoYCR7dGhpcy5wbHVnaW4uc2V0dGluZ3MuRm9sZGVyfS9kcmF3aW9fJHt0aW1lc3RhbXB9LmRyYXdpby5zdmdgLCBzdmdDb250ZW50KVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwLnZhdWx0LmNyZWF0ZShgL2RyYXdpb18ke3RpbWVzdGFtcH0uZHJhd2lvLnN2Z2AsIHN2Z0NvbnRlbnQpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSAnZXhpdCc6XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUud2FybignXHUwNDFEXHUwNDM1XHUwNDNBXHUwNDNFXHUwNDQwXHUwNDQwXHUwNDM1XHUwNDNBXHUwNDQyXHUwNDNEXHUwNDRCXHUwNDM5IEpTT04gXHUwNDMyIFx1MDQ0MVx1MDQzRVx1MDQzRVx1MDQzMVx1MDQ0OVx1MDQzNVx1MDQzRFx1MDQzOFx1MDQzODonLCBldmVudC5kYXRhKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgb25DbG9zZSgpIHtcclxuICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIHRoaXMubWVzc2FnZUhhbmRsZXIpO1xyXG4gICAgfVxyXG59IiwgIntcclxuICAgIFwiRHJhd0lvVmlld05hbWVcIjogXCJkcmF3LmlvIGVkaXRvclwiLFxyXG4gICAgXCJyaWJvbkljb25UaXRsZVwiOiBcIm9wZW4gZHJhdy5pbyBlZGl0b3JcIixcclxuICAgIFwiU3RhcnREcmF3aW9DbGllbnRTZXZlclwiOiBcIkRyYXcuaW8gc2VydmVyIHN0YXJ0ZWQgb24gcG9ydFwiLFxyXG4gICAgXCJTdG9wRHJhd2lvQ2xpbmV0U2VydmVyXCI6IFwiRHJhdy5pbyBzZXJ2ZXIgc3RvcHBlZFwiXHJcbn1cclxuIiwgIntcclxuICAgIFwiRHJhd0lvVmlld05hbWVcIjogXCJcdTA0MjBcdTA0MzVcdTA0MzRcdTA0MzBcdTA0M0FcdTA0NDJcdTA0M0VcdTA0NDAgZHJhdy5pb1wiLFxyXG4gICAgXCJyaWJvbkljb25UaXRsZVwiOiBcIlx1MDQxRVx1MDQ0Mlx1MDQzQVx1MDQ0MFx1MDQ0Qlx1MDQ0Mlx1MDQ0QyBcdTA0NDBcdTA0MzVcdTA0MzRcdTA0MzBcdTA0M0FcdTA0NDJcdTA0M0VcdTA0NDAgZHJhdy5pb1wiLFxyXG4gICAgXCJTdGFydERyYXdpb0NsaWVudFNldmVyXCI6IFwiXHUwNDIxXHUwNDM1XHUwNDQwXHUwNDM1XHUwNDMyXHUwNDM1XHUwNDQwIFx1MDQzN1x1MDQzMFx1MDQzRlx1MDQ0M1x1MDQ0MVx1MDQ0Mlx1MDQzOFx1MDQzQlx1MDQzMCBcdTA0M0RcdTA0MzAgXHUwNDNGXHUwNDNFXHUwNDQwXHUwNDQyXHUwNDQzXCIsXHJcbiAgICBcIlN0b3BEcmF3aW9DbGluZXRTZXJ2ZXJcIjogXCJcdTA0MjFcdTA0MzVcdTA0NDBcdTA0MzVcdTA0MzJcdTA0NDAgZHJhd2lvIFx1MDQzRVx1MDQ0MVx1MDQ0Mlx1MDQzMFx1MDQzRFx1MDQzRVx1MDQzMlx1MDQzQlx1MDQzNVx1MDQzRFwiXHJcbn1cclxuIiwgImltcG9ydCBlbiBmcm9tICcuL2VuLmpzb24nO1xyXG5pbXBvcnQgcnUgZnJvbSAnLi9ydS5qc29uJztcclxuXHJcbnR5cGUgVHJhbnNsYXRpb25zID0gdHlwZW9mIGVuO1xyXG5cclxuY29uc3QgbG9jYWxlczogUmVjb3JkPHN0cmluZywgVHJhbnNsYXRpb25zPiA9IHtcclxuICBlbixcclxuICBydSxcclxufTtcclxuXHJcbmxldCBjdXJyZW50TG9jYWxlOiBzdHJpbmcgPSBcImVuXCI7XHJcbmxldCB0cmFuc2xhdGlvbnM6IFRyYW5zbGF0aW9ucyA9IGVuO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHNldExvY2FsZShsb2NhbGU6IHN0cmluZykge1xyXG4gIGN1cnJlbnRMb2NhbGUgPSBsb2NhbGUgaW4gbG9jYWxlcyA/IGxvY2FsZSA6IFwiZW5cIjtcclxuICB0cmFuc2xhdGlvbnMgPSBsb2NhbGVzW2N1cnJlbnRMb2NhbGVdO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdChrZXk6IGtleW9mIFRyYW5zbGF0aW9ucyk6IHN0cmluZyB7XHJcbiAgcmV0dXJuIHRyYW5zbGF0aW9uc1trZXldIHx8IGtleTtcclxufSIsICJpbXBvcnQgeyBBcHAsIFRGb2xkZXIsIG5vcm1hbGl6ZVBhdGggfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBmb2xkZXJFeGlzdHMoYXBwOiBBcHAsIHBhdGg6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG4gIGNvbnN0IG5vcm1hbGl6ZWQgPSBub3JtYWxpemVQYXRoKHBhdGgpO1xyXG4gIGNvbnN0IGZvbGRlciA9IGFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgobm9ybWFsaXplZCk7XHJcblxyXG4gIHJldHVybiBmb2xkZXIgaW5zdGFuY2VvZiBURm9sZGVyO1xyXG59XHJcbiIsICJpbXBvcnQgeyBJbmNvbWluZ01lc3NhZ2UsIFNlcnZlciwgU2VydmVyUmVzcG9uc2UgfSBmcm9tIFwiaHR0cFwiO1xyXG5pbXBvcnQgeyB0IH0gZnJvbSBcImxvY2FsZXMvaTE4blwiO1xyXG5pbXBvcnQgRHJhd2lvUGx1Z2luIGZyb20gXCJtYWluXCI7XHJcbmltcG9ydCB7IEFwcCwgTm90aWNlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcblxyXG5jb25zdCBodHRwID0gcmVxdWlyZSgnaHR0cCcpO1xyXG5jb25zdCBmcyA9IHJlcXVpcmUoJ2ZzJyk7XHJcbmNvbnN0IHBhdGggPSByZXF1aXJlKCdwYXRoJyk7XHJcblxyXG5cclxuZnVuY3Rpb24gZ2V0RHJhd2lvUGF0aHMoYXBwOiBBcHAsIG1hbmlmZXN0RGlyOiBzdHJpbmcpIHtcclxuICAgIGNvbnN0IHZhdWx0QmFzZVBhdGggPSAoYXBwLnZhdWx0LmFkYXB0ZXIgYXMgYW55KS5iYXNlUGF0aCBhcyBzdHJpbmc7XHJcbiAgICBjb25zdCBwbHVnaW5EaXIgPSBwYXRoLmpvaW4odmF1bHRCYXNlUGF0aCwgbWFuaWZlc3REaXIpO1xyXG4gICAgY29uc3Qgd2ViQXBwUGF0aCA9IHBhdGguam9pbihwbHVnaW5EaXIsIFwid2ViYXBwXCIpO1xyXG4gICAgcmV0dXJuIHsgdmF1bHRCYXNlUGF0aCwgcGx1Z2luRGlyLCB3ZWJBcHBQYXRoIH07XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNlcnZlclN0YXJ0KHBsdWdpbjogRHJhd2lvUGx1Z2luLCB3ZWJBcHBQYXRoOiBzdHJpbmcsIHBvcnQ6IG51bWJlcik6IFByb21pc2U8U2VydmVyPiB7XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IHNlcnZlciA9IGh0dHAuY3JlYXRlU2VydmVyKChyZXE6IEluY29taW5nTWVzc2FnZSwgcmVzOiBTZXJ2ZXJSZXNwb25zZSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCByZXF1ZXN0VXJsID0gbmV3IFVSTChyZXEudXJsIHx8ICcnLCBgaHR0cDovLyR7cmVxLmhlYWRlcnMuaG9zdH1gKTtcclxuICAgICAgICAgICAgY29uc3QgZmlsZVBhdGggPSBwYXRoLmpvaW4oXHJcbiAgICAgICAgICAgICAgd2ViQXBwUGF0aCxcclxuICAgICAgICAgICAgICByZXF1ZXN0VXJsLnBhdGhuYW1lID09PSAnLycgPyAnaW5kZXguaHRtbCcgOiByZXF1ZXN0VXJsLnBhdGhuYW1lXHJcbiAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICBpZiAoIWZpbGVQYXRoLnN0YXJ0c1dpdGgod2ViQXBwUGF0aCkpIHtcclxuICAgICAgICAgICAgICAgIHJlcy53cml0ZUhlYWQoNDAzLCB7ICdDb250ZW50LVR5cGUnOiAndGV4dC9wbGFpbicgfSk7XHJcbiAgICAgICAgICAgICAgICByZXMuZW5kKCc0MDMgRm9yYmlkZGVuJyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZzLnJlYWRGaWxlKGZpbGVQYXRoLCAoZXJyOiBOb2RlSlMuRXJybm9FeGNlcHRpb24gfCBudWxsLCBkYXRhOiBzdHJpbmcpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZXJyLmNvZGUgPT09ICdFTk9FTlQnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcy53cml0ZUhlYWQoNDA0LCB7ICdDb250ZW50LVR5cGUnOiAndGV4dC9wbGFpbicgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcy5lbmQoJzQwNCBOb3QgRm91bmQnKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXMud3JpdGVIZWFkKDUwMCwgeyAnQ29udGVudC1UeXBlJzogJ3RleHQvcGxhaW4nIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXMuZW5kKGA1MDAgSW50ZXJuYWwgU2VydmVyIEVycm9yOiAke2Vyci5tZXNzYWdlfWApO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZXh0ID0gcGF0aC5leHRuYW1lKGZpbGVQYXRoKS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBjb250ZW50VHlwZSA9ICdhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW0nO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGV4dCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICcuaHRtbCc6IGNvbnRlbnRUeXBlID0gJ3RleHQvaHRtbCc7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICcuanMnOiBjb250ZW50VHlwZSA9ICdhcHBsaWNhdGlvbi9qYXZhc2NyaXB0JzsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJy5jc3MnOiBjb250ZW50VHlwZSA9ICd0ZXh0L2Nzcyc7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICcuanNvbic6IGNvbnRlbnRUeXBlID0gJ2FwcGxpY2F0aW9uL2pzb24nOyBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnLnBuZyc6IGNvbnRlbnRUeXBlID0gJ2ltYWdlL3BuZyc7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICcuanBnJzogY29udGVudFR5cGUgPSAnaW1hZ2UvanBlZyc7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICcuZ2lmJzogY29udGVudFR5cGUgPSAnaW1hZ2UvZ2lmJzsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJy5zdmcnOiBjb250ZW50VHlwZSA9ICdpbWFnZS9zdmcreG1sJzsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJy53b2ZmJzogY29udGVudFR5cGUgPSAnZm9udC93b2ZmJzsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJy53b2ZmMic6IGNvbnRlbnRUeXBlID0gJ2ZvbnQvd29mZjInOyBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnLnR0Zic6IGNvbnRlbnRUeXBlID0gJ2ZvbnQvdHRmJzsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJy5pY28nOiBjb250ZW50VHlwZSA9ICdpbWFnZS94LWljb24nOyBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzLndyaXRlSGVhZCgyMDAsIHsgJ0NvbnRlbnQtVHlwZSc6IGNvbnRlbnRUeXBlIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHJlcy5lbmQoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBzZXJ2ZXIubGlzdGVuKHBvcnQsICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgcG9ydCA9IHBsdWdpbi5zZXR0aW5ncy5wb3J0O1xyXG4gICAgICAgICAgICBuZXcgTm90aWNlKGAke3QoXCJTdGFydERyYXdpb0NsaWVudFNldmVyXCIpfSAke3BvcnR9YCk7XHJcbiAgICAgICAgICAgIHJlc29sdmUoc2VydmVyKTtcclxuICAgICAgICB9KS5vbignZXJyb3InLCAoZXJyOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgaWYgKGVyci5jb2RlID09PSAnRUFERFJJTlVTRScpIHtcclxuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoYFx1Mjc0QyBcdTA0MUZcdTA0M0VcdTA0NDBcdTA0NDIgJHtwb3J0fSBcdTA0NDNcdTA0MzZcdTA0MzUgXHUwNDM3XHUwNDMwXHUwNDNEXHUwNDRGXHUwNDQyLiBcdTA0MjFcdTA0MzVcdTA0NDBcdTA0MzJcdTA0MzVcdTA0NDAgRHJhdy5pbyBcdTA0M0RcdTA0MzUgXHUwNDM3XHUwNDMwXHUwNDNGXHUwNDQzXHUwNDQ5XHUwNDM1XHUwNDNELmApO1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihgXHUwNDFGXHUwNDNFXHUwNDQwXHUwNDQyICR7cG9ydH0gXHUwNDQzXHUwNDM2XHUwNDM1IFx1MDQzN1x1MDQzMFx1MDQzRFx1MDQ0Rlx1MDQ0Mi5gKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoYFx1Mjc0QyBcdTA0MURcdTA0MzUgXHUwNDQzXHUwNDM0XHUwNDMwXHUwNDNCXHUwNDNFXHUwNDQxXHUwNDRDIFx1MDQzN1x1MDQzMFx1MDQzRlx1MDQ0M1x1MDQ0MVx1MDQ0Mlx1MDQzOFx1MDQ0Mlx1MDQ0QyBcdTA0NDFcdTA0MzVcdTA0NDBcdTA0MzJcdTA0MzVcdTA0NDAgRHJhdy5pbzogJHtlcnIubWVzc2FnZX1gKTtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYFx1MDQxRFx1MDQzNSBcdTA0NDNcdTA0MzRcdTA0MzBcdTA0M0JcdTA0M0VcdTA0NDFcdTA0NEMgXHUwNDM3XHUwNDMwXHUwNDNGXHUwNDQzXHUwNDQxXHUwNDQyXHUwNDM4XHUwNDQyXHUwNDRDIFx1MDQ0MVx1MDQzNVx1MDQ0MFx1MDQzMlx1MDQzNVx1MDQ0MCBEcmF3LmlvOmAsIGVycik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxhdW5jaERyYXdpb1NlcnZlckxvZ2ljKHBsdWdpbjogRHJhd2lvUGx1Z2luKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICBpZiAocGx1Z2luLmlzU2VydmVyT3BlbikgcmV0dXJuO1xyXG5cclxuICAgIGNvbnN0IFBPUlQgPSBwbHVnaW4uc2V0dGluZ3MucG9ydFxyXG5cclxuICAgIGNvbnN0IHsgd2ViQXBwUGF0aCB9ID0gZ2V0RHJhd2lvUGF0aHMocGx1Z2luLmFwcCwgcGx1Z2luLm1hbmlmZXN0LmRpciEpO1xyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgICAgcGx1Z2luLmlzU2VydmVyT3BlbiA9IGF3YWl0IHNlcnZlclN0YXJ0KHBsdWdpbiwgd2ViQXBwUGF0aCwgTnVtYmVyKFBPUlQpKTtcclxuICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZSgocmVzKSA9PiBzZXRUaW1lb3V0KHJlcywgMTAwMCkpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKHBsdWdpbi5zZXR0aW5ncy5wb3J0KVxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBwbHVnaW4uaXNTZXJ2ZXJPcGVuID0gbnVsbDtcclxuICAgIH1cclxufSIsICJpbXBvcnQgeyBURm9sZGVyIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIERyYXdpb1NldHRpbmdzIHtcclxuICBwb3J0OiBzdHJpbmc7XHJcbiAgY2VudGVyaW5nRGlhZ3JhbTogYm9vbGVhbjtcclxuICBwZXJjZW50U2l6ZTogYm9vbGVhbjtcclxuICBpbnRlcmFjdGl2ZURpYWdyYW06IGJvb2xlYW47XHJcbiAgdXNlTWFya2Rvd25MaW5rczogYm9vbGVhbjtcclxuICBGb2xkZXI6IHN0cmluZztcclxuICBkaWFncmFtU2l6ZTogc3RyaW5nO1xyXG59XHJcblxyXG5leHBvcnQgY29uc3QgREVGQVVMVF9TRVRUSU5HUzogUGFydGlhbDxEcmF3aW9TZXR0aW5ncz4gPSB7XHJcbiAgcG9ydDogJzE3MTcnLFxyXG4gIGNlbnRlcmluZ0RpYWdyYW06IHRydWUsXHJcbiAgcGVyY2VudFNpemU6IHRydWUsXHJcbiAgaW50ZXJhY3RpdmVEaWFncmFtOiB0cnVlLFxyXG4gIHVzZU1hcmtkb3duTGlua3M6IGZhbHNlLFxyXG4gIEZvbGRlcjogJ2RyYXdpbycsXHJcbiAgZGlhZ3JhbVNpemU6ICcnLFxyXG59OyIsICJpbXBvcnQgRHJhd2lvUGx1Z2luIGZyb20gXCJtYWluXCI7XHJcbmltcG9ydCB7IEFwcCwgRHJvcGRvd25Db21wb25lbnQsIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcsIFRGb2xkZXIgfSBmcm9tICdvYnNpZGlhbic7XHJcblxyXG5leHBvcnQgY2xhc3MgRHJhd2lvVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XHJcbiAgcGx1Z2luOiBEcmF3aW9QbHVnaW47XHJcblxyXG4gIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IERyYXdpb1BsdWdpbikge1xyXG4gICAgc3VwZXIoYXBwLCBwbHVnaW4pO1xyXG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XHJcbiAgfVxyXG5cclxuICBkaXNwbGF5KCk6IHZvaWQge1xyXG4gICAgbGV0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XHJcblxyXG4gICAgY29udGFpbmVyRWwuZW1wdHkoKTtcclxuXHJcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgLnNldE5hbWUoJ1NldCBwb3J0JylcclxuICAgICAgLnNldERlc2MoJ1NldCBwb3J0JylcclxuICAgICAgLmFkZFRleHQoKHRleHQpID0+XHJcbiAgICAgICAgdGV4dFxyXG4gICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCcxNzE3JylcclxuICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5wb3J0KVxyXG4gICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wb3J0ID0gdmFsdWU7XHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgKTtcclxuXHJcbiAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAuc2V0TmFtZSgnQ2VudGVyaW5nIERpYWdyYW0nKVxyXG4gICAgICAuc2V0RGVzYygnSWYgYWN0aXZlIGFsbCBkaWFncmFtIHdpbGwgYmUgcG9zaXRpb24gdG8gY2VudGVyJylcclxuICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PiBcclxuICAgICAgICB0b2dnbGVcclxuICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5jZW50ZXJpbmdEaWFncmFtKVxyXG4gICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jZW50ZXJpbmdEaWFncmFtID0gdmFsdWU7XHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgKTtcclxuXHJcbiAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAuc2V0TmFtZSgnUGVyY2VudCBzaXplJylcclxuICAgICAgLnNldERlc2MoJ1BlcmNlbnQgU2l6ZScpXHJcbiAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT4gXHJcbiAgICAgICAgdG9nZ2xlXHJcbiAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MucGVyY2VudFNpemUpXHJcbiAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnBlcmNlbnRTaXplID0gdmFsdWU7XHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgKTtcclxuXHJcbiAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAuc2V0TmFtZSgnSW50ZXJhY3RpdmUgZGlhZ3JhbXMnKVxyXG4gICAgICAuc2V0RGVzYygnSW50ZXJhY3RpdmUgZGlhZ3JhbXMnKVxyXG4gICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+IFxyXG4gICAgICAgIHRvZ2dsZVxyXG4gICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmludGVyYWN0aXZlRGlhZ3JhbSlcclxuICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuaW50ZXJhY3RpdmVEaWFncmFtID0gdmFsdWU7XHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgKTtcclxuXHJcbiAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAuc2V0TmFtZSgnVXNlIG1hcmtkb3duIExpbmtzJylcclxuICAgICAgLnNldERlc2MoJ0lmIGVuYWJsZSBsaW5rIHdpbGwgYmUgbWFya2Rvd24gbGluayBzdHlsZScpXHJcbiAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT4gXHJcbiAgICAgICAgdG9nZ2xlXHJcbiAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MudXNlTWFya2Rvd25MaW5rcylcclxuICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MudXNlTWFya2Rvd25MaW5rcyA9IHZhbHVlO1xyXG4gICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgIH0pXHJcbiAgICAgICk7XHJcblxyXG4gICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgLnNldE5hbWUoJ1NlbGVjdCBmb2xkZXInKVxyXG4gICAgICAuc2V0RGVzYygnU2VsZWN0IGZvbGRlciB0aGF0IHNhdmUgZGlhZ3JhbXMnKVxyXG4gICAgICAuYWRkRHJvcGRvd24oZHJvcGRvd24gPT4ge1xyXG4gICAgICAgIGNvbnN0IGZvbGRlcnMgPSB0aGlzLmFwcC52YXVsdC5nZXRBbGxMb2FkZWRGaWxlcygpLmZpbHRlcihmaWxlID0+IGZpbGUgaW5zdGFuY2VvZiBURm9sZGVyKTtcclxuICAgICAgICBcclxuICAgICAgICBmb2xkZXJzLmZvckVhY2goKGZvbGRlcjogVEZvbGRlcikgPT4ge1xyXG4gICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24oZm9sZGVyLnBhdGgsIGZvbGRlci5wYXRoKTtcclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICBkcm9wZG93bi5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5Gb2xkZXIpO1xyXG5cclxuICAgICAgICBkcm9wZG93bi5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuRm9sZGVyID0gdmFsdWU7XHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICAgICk7XHJcblxyXG4gICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgLnNldE5hbWUoJ2RpYWdyYW0gd2lkdGgnKVxyXG4gICAgICAuc2V0RGVzYygnU2V0IGRlZmF1bHQgZGlhZ3JhbSBzaXplJylcclxuICAgICAgLmFkZFRleHQoKHRleHQpID0+XHJcbiAgICAgICAgdGV4dFxyXG4gICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCcxMDAlJylcclxuICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5kaWFncmFtU2l6ZSlcclxuICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZGlhZ3JhbVNpemUgPSB2YWx1ZTtcclxuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICApO1xyXG4gIH1cclxufSIsICJpbXBvcnQgRHJhd2lvUGx1Z2luIGZyb20gXCJtYWluXCI7XHJcbmltcG9ydCB7IE1hcmtkb3duUG9zdFByb2Nlc3NvciB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIENlbnRlcmluZ0RpYWdyYW1zKHBsdWdpbjogRHJhd2lvUGx1Z2luKSB7XHJcbiAgICBpZighcGx1Z2luLnNldHRpbmdzLmNlbnRlcmluZ0RpYWdyYW0pIHtcclxuICAgICAgICByZXR1cm5cclxuICAgIH0gZWxzZSB7XHJcbiAgcGx1Z2luLnJlZ2lzdGVyTWFya2Rvd25Qb3N0UHJvY2Vzc29yKChlbCwgY3R4KSA9PiB7XHJcbiAgY29uc3QgZW1iZWRzID0gZWwucXVlcnlTZWxlY3RvckFsbCgnc3Bhbi5pbnRlcm5hbC1lbWJlZFtzcmMkPVwiLmRyYXdpby5zdmdcIl0nKTtcclxuXHJcbiAgZW1iZWRzLmZvckVhY2goKGVtYmVkKSA9PiB7XHJcbiAgICBjb25zdCB3cmFwcGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICB3cmFwcGVyLnN0eWxlLnRleHRBbGlnbiA9ICdjZW50ZXInO1xyXG4gICAgd3JhcHBlci5zdHlsZS53aWR0aCA9ICcxMDAlJztcclxuXHJcbiAgICAvLyBcdTA0MURcdTA0MzBcdTA0MzlcdTA0NDJcdTA0MzggPGltZz4gXHUwNDMyXHUwNDNEXHUwNDQzXHUwNDQyXHUwNDQwXHUwNDM4IDxzcGFuPlxyXG4gICAgY29uc3QgaW1nID0gZW1iZWQucXVlcnlTZWxlY3RvcignaW1nJyk7XHJcbiAgICBpZiAoaW1nKSB7XHJcbiAgICAgIGltZy5zdHlsZS53aWR0aCA9ICcxMDAlJztcclxuICAgICAgaW1nLnN0eWxlLmhlaWdodCA9ICdhdXRvJzsgLy8gXHUwNDQ3XHUwNDQyXHUwNDNFXHUwNDMxXHUwNDRCIFx1MDQzRFx1MDQzNSBcdTA0MzhcdTA0NDFcdTA0M0FcdTA0MzBcdTA0MzZcdTA0MzBcdTA0M0JcdTA0M0VcdTA0NDFcdTA0NEMgXHUwNDM4XHUwNDM3XHUwNDNFXHUwNDMxXHUwNDQwXHUwNDMwXHUwNDM2XHUwNDM1XHUwNDNEXHUwNDM4XHUwNDM1XHJcbiAgICAgIGltZy5zdHlsZS5tYXhXaWR0aCA9ICcxMDAlJzsgLy8gXHUwNDNEXHUwNDMwIFx1MDQzMlx1MDQ0MVx1MDQ0Rlx1MDQzQVx1MDQzOFx1MDQzOSBcdTA0NDFcdTA0M0JcdTA0NDNcdTA0NDdcdTA0MzBcdTA0MzlcclxuICAgIH1cclxuXHJcbiAgICAvLyBcdTA0MUVcdTA0MzFcdTA0MzVcdTA0NDBcdTA0M0RcdTA0NDNcdTA0NDJcdTA0NEMgPHNwYW4+IFx1MDQzMiA8ZGl2PlxyXG4gICAgaWYgKGVtYmVkLnBhcmVudEVsZW1lbnQgJiYgZW1iZWQucGFyZW50RWxlbWVudC50YWdOYW1lID09PSAnRElWJykgcmV0dXJuO1xyXG4gICAgZW1iZWQucGFyZW50RWxlbWVudD8uaW5zZXJ0QmVmb3JlKHdyYXBwZXIsIGVtYmVkKTtcclxuICAgIHdyYXBwZXIuYXBwZW5kQ2hpbGQoZW1iZWQpO1xyXG4gIH0pO1xyXG59KTtcclxuXHJcbiAgICB9O1xyXG59IiwgImltcG9ydCBEcmF3aW9QbHVnaW4gZnJvbSBcIm1haW5cIjtcclxuaW1wb3J0IHsgTWFya2Rvd25Qb3N0UHJvY2Vzc29yIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gRGVmYXVsdERpYWdyYW1TaXplKHBsdWdpbjogRHJhd2lvUGx1Z2luKSB7XHJcbiAgICBpZighcGx1Z2luLnNldHRpbmdzLnBlcmNlbnRTaXplKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBwbHVnaW4ucmVnaXN0ZXJNYXJrZG93blBvc3RQcm9jZXNzb3IoKGVsLCBjdHgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgZW1iZWRzID0gZWwucXVlcnlTZWxlY3RvckFsbCgnc3Bhbi5pbnRlcm5hbC1lbWJlZFtzcmMkPVwiLmRyYXdpby5zdmdcIl0nKTtcclxuICAgICAgICAgICAgZW1iZWRzLmZvckVhY2goKGVtYmVkKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB3aWR0aCA9IGVtYmVkLmdldEF0dHJpYnV0ZSgnYWx0JylcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBwZXJjZW50cGF0dGVybiA9IC9eKDEwMHxbMS05XT9cXGQpJSQvO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKHBlcmNlbnRwYXR0ZXJuLnRlc3Qod2lkdGggPz8gJycpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZW1iZWQuc2V0QXR0cmlidXRlKCd3aWR0aCcsIHdpZHRoISlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9KVxyXG4gICAgfX0iLCAiZXhwb3J0IGNsYXNzIEV4dGVybmFsVG9vbHRpcCB7XG4gICAgcHJpdmF0ZSB0b29sdGlwRWxlbWVudDogSFRNTEVsZW1lbnQ7XG4gICAgcHJpdmF0ZSBoaWRlVGltZW91dDogTm9kZUpTLlRpbWVvdXQgfCBudWxsID0gbnVsbDtcblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLnRvb2x0aXBFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIHRoaXMudG9vbHRpcEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnZHJhd2lvLWN1c3RvbS10b29sdGlwJyk7XG4gICAgICAgIHRoaXMudG9vbHRpcEVsZW1lbnQuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xuICAgICAgICB0aGlzLnRvb2x0aXBFbGVtZW50LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgIHRoaXMudG9vbHRpcEVsZW1lbnQuc3R5bGUuekluZGV4ID0gJzk5OTknO1xuXG4gICAgICAgIHRoaXMudG9vbHRpcEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsICgpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLmhpZGVUaW1lb3V0KSB7XG4gICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuaGlkZVRpbWVvdXQpO1xuICAgICAgICAgICAgICAgIHRoaXMuaGlkZVRpbWVvdXQgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy50b29sdGlwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5oaWRlKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQodGhpcy50b29sdGlwRWxlbWVudCk7XG4gICAgfVxuXG5wdWJsaWMgc2hvdyh0ZXh0OiBzdHJpbmcsIGV2ZW50OiBNb3VzZUV2ZW50KTogdm9pZCB7XG4gICAgaWYgKCFkb2N1bWVudC5ib2R5LmNvbnRhaW5zKHRoaXMudG9vbHRpcEVsZW1lbnQpKSB7XG4gICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQodGhpcy50b29sdGlwRWxlbWVudCk7XG4gICAgfVxuXG4gICAgdGhpcy50b29sdGlwRWxlbWVudC50ZXh0Q29udGVudCA9IHRleHQ7XG4gICAgdGhpcy50b29sdGlwRWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICB0aGlzLnVwZGF0ZVBvc2l0aW9uKGV2ZW50KTtcbn1cblxuICAgIHB1YmxpYyBoaWRlKGRlbGF5ID0gMTAwKSB7XG4gICAgICAgIGlmICh0aGlzLmhpZGVUaW1lb3V0KSB7XG4gICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5oaWRlVGltZW91dCk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmhpZGVUaW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnRvb2x0aXBFbGVtZW50LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgIH0sIGRlbGF5KTtcbiAgICB9XG5cbiAgICBwdWJsaWMgdXBkYXRlUG9zaXRpb24oZXZlbnQ6IE1vdXNlRXZlbnQpIHtcbiAgICAgICAgY29uc3Qgb2Zmc2V0WCA9IDE1O1xuICAgICAgICBjb25zdCBvZmZzZXRZID0gMTU7XG5cbiAgICAgICAgbGV0IG5ld0xlZnQgPSBldmVudC5jbGllbnRYICsgd2luZG93LnNjcm9sbFggKyBvZmZzZXRYO1xuICAgICAgICBsZXQgbmV3VG9wID0gZXZlbnQuY2xpZW50WSArIHdpbmRvdy5zY3JvbGxZICsgb2Zmc2V0WTtcblxuICAgICAgICBjb25zdCB0b29sdGlwV2lkdGggPSB0aGlzLnRvb2x0aXBFbGVtZW50Lm9mZnNldFdpZHRoO1xuICAgICAgICBjb25zdCB0b29sdGlwSGVpZ2h0ID0gdGhpcy50b29sdGlwRWxlbWVudC5vZmZzZXRIZWlnaHQ7XG4gICAgICAgIGNvbnN0IHZpZXdwb3J0V2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aDtcbiAgICAgICAgY29uc3Qgdmlld3BvcnRIZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQ7XG5cbiAgICAgICAgaWYgKG5ld0xlZnQgKyB0b29sdGlwV2lkdGggPiB2aWV3cG9ydFdpZHRoICsgd2luZG93LnNjcm9sbFgpIHtcbiAgICAgICAgICAgIG5ld0xlZnQgPSBldmVudC5jbGllbnRYICsgd2luZG93LnNjcm9sbFggLSB0b29sdGlwV2lkdGggLSBvZmZzZXRYO1xuICAgICAgICB9XG4gICAgICAgIGlmIChuZXdUb3AgKyB0b29sdGlwSGVpZ2h0ID4gdmlld3BvcnRIZWlnaHQgKyB3aW5kb3cuc2Nyb2xsWSkge1xuICAgICAgICAgICAgbmV3VG9wID0gZXZlbnQuY2xpZW50WSArIHdpbmRvdy5zY3JvbGxZIC0gdG9vbHRpcEhlaWdodCAtIG9mZnNldFk7XG4gICAgICAgIH1cblxuICAgICAgICBuZXdMZWZ0ID0gTWF0aC5tYXgobmV3TGVmdCwgd2luZG93LnNjcm9sbFggKyBvZmZzZXRYKTtcbiAgICAgICAgbmV3VG9wID0gTWF0aC5tYXgobmV3VG9wLCB3aW5kb3cuc2Nyb2xsWSArIG9mZnNldFkpO1xuXG4gICAgICAgIHRoaXMudG9vbHRpcEVsZW1lbnQuc3R5bGUubGVmdCA9IGAke25ld0xlZnR9cHhgO1xuICAgICAgICB0aGlzLnRvb2x0aXBFbGVtZW50LnN0eWxlLnRvcCA9IGAke25ld1RvcH1weGA7XG4gICAgfVxufSIsICJpbXBvcnQgRHJhd2lvUGx1Z2luIGZyb20gJ21haW4nO1xuaW1wb3J0IHsgVEZpbGUsIFZhdWx0LCBBcHAgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBmaW5kRmlsZUJ5TmFtZSB9IGZyb20gJ3V0aWxzL2ZpbmRGaWxlQnlOYW1lJztcblxuZXhwb3J0IGZ1bmN0aW9uIGdldEZpbGVDb250ZW50KGVsZW1lbnQ6IEVsZW1lbnQsIGFwcDogQXBwKTogVEZpbGUgfCBudWxsIHtcblxuICAgIGNvbnN0IHNyYyA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKFwic3JjXCIpO1xuICAgIGlmICghc3JjKSByZXR1cm4gbnVsbDtcblxuICAgIGNvbnN0IGZpbGVuYW1lID0gc3JjLnNwbGl0KCcvJykucG9wKCk7XG4gICAgXG4gICAgaWYgKCFmaWxlbmFtZSkgcmV0dXJuIG51bGw7XG5cbiAgICBjb25zdCBmaWxlID0gZmluZEZpbGVCeU5hbWUoZmlsZW5hbWUsIGFwcCk7XG5cbiAgICByZXR1cm4gZmlsZSBpbnN0YW5jZW9mIFRGaWxlID8gZmlsZSA6IG51bGw7XG59IiwgImltcG9ydCB7IFRGaWxlLCBWYXVsdCwgQXBwIH0gZnJvbSAnb2JzaWRpYW4nO1xuXG5leHBvcnQgZnVuY3Rpb24gZmluZEZpbGVCeU5hbWUoZmlsZU5hbWU6IHN0cmluZywgYXBwOiBBcHApOiBURmlsZSB8IG51bGwge1xuICAgIGNvbnN0IGZpbGVzID0gYXBwLnZhdWx0LmdldEZpbGVzKCk7XG4gICAgZm9yIChjb25zdCBmaWxlIG9mIGZpbGVzKSB7XG4gICAgICAgIGlmIChmaWxlLm5hbWUgPT09IGZpbGVOYW1lKSB7XG4gICAgICAgICAgICByZXR1cm4gZmlsZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbn1cbiIsICJcbmltcG9ydCB7IEV4dGVybmFsVG9vbHRpcCB9IGZyb20gXCJoYW5kbGVycy9leHRlcm5hbFRvb2x0aXBcIjtcbmltcG9ydCB7IGdldEZpbGVDb250ZW50IH0gZnJvbSBcImhhbmRsZXJzL2dldEZpbGVDb250ZW50XCI7XG5pbXBvcnQgRHJhd2lvUGx1Z2luIGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBNYXJrZG93blBvc3RQcm9jZXNzb3JDb250ZXh0LCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuXG5jb25zdCB0b29sdGlwID0gbmV3IEV4dGVybmFsVG9vbHRpcCgpO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gSW50ZXJhY3RpdmVEaWFncmFtcyhwbHVnaW46IERyYXdpb1BsdWdpbikge1xuXHRpZiAoIXBsdWdpbi5zZXR0aW5ncy5pbnRlcmFjdGl2ZURpYWdyYW0pIHJldHVybjtcblxuXHRwbHVnaW4ucmVnaXN0ZXJNYXJrZG93blBvc3RQcm9jZXNzb3IoYXN5bmMgKGVsLCBjdHg6IE1hcmtkb3duUG9zdFByb2Nlc3NvckNvbnRleHQpID0+IHtcblx0XHRjb25zdCBlbWJlZHMgPSBlbC5xdWVyeVNlbGVjdG9yQWxsKCdzcGFuLmludGVybmFsLWVtYmVkW3NyYyQ9XCIuZHJhd2lvLnN2Z1wiXScpO1xuXG5cdFx0Zm9yIChjb25zdCBlbWJlZCBvZiBlbWJlZHMpIHtcblxuXHRcdFx0ZW1iZWQuYWRkQ2xhc3MoJ2RyYXdpby1jb250YWluZXInKVxuXHRcdFx0Y29uc3QgZmlsZSA9IGdldEZpbGVDb250ZW50KGVtYmVkLCBwbHVnaW4uYXBwKTtcblxuXHRcdFx0aWYgKCEoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSkgY29udGludWU7XG5cblx0XHRcdGNvbnN0IGRhdGEgPSBhd2FpdCBwbHVnaW4uYXBwLnZhdWx0LnJlYWQoZmlsZSk7XG5cblx0XHRcdGNvbnN0IGltZyA9IGVtYmVkLnF1ZXJ5U2VsZWN0b3IoJ2ltZycpO1xuXG5cdFx0XHRsZXQgaW1nU2l6ZWUgPSBudWxsO1xuXG5cdFx0XHRpZihpbWcuaGFzQXR0cmlidXRlKCd3aWR0aCcpKSB7XG5cdFx0XHRcdGltZ1NpemVlID0gaW1nLmdldEF0dHJpYnV0ZSgnd2lkdGgnKTtcblx0XHRcdH0gaWYgKGltZy5oYXNBdHRyaWJ1dGUoJ2FsdCcpICYmIGltZy5nZXRBdHRyaWJ1dGUoJ2FsdCcpLmluY2x1ZGVzKCclJykpIHtcblx0XHRcdFx0aW1nU2l6ZWUgPSBpbWcuZ2V0QXR0cmlidXRlKCdhbHQnKVxuXHRcdFx0fVxuXG5cdFx0XHRjb25zdCB0ZW1wID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblx0XHRcdHRlbXAuaW5uZXJIVE1MID0gZGF0YTtcblxuXHRcdFx0Y29uc3Qgc3ZnRWxlbWVudCA9IHRlbXAucXVlcnlTZWxlY3RvcihcInN2Z1wiKTtcblx0XHRcdGlmICghc3ZnRWxlbWVudCkgY29udGludWU7XG5cblx0XHRcdGltZy5yZXBsYWNlV2l0aChzdmdFbGVtZW50KTtcblxuXHRcdFx0c3ZnRWxlbWVudC5hZGRDbGFzcygnZHJhd2lvLXN2ZycpXG5cblx0XHRcdGlmIChpbWdTaXplZSAhPT0gbnVsbCAmJiAhaW1nU2l6ZWUuaW5jbHVkZXMoJyUnKSkge1xuXHRcdFx0XHRzdmdFbGVtZW50LnNldEF0dHJpYnV0ZSgnd2lkdGgnLCBpbWdTaXplZSArICdweCcpO1xuXHRcdFx0XHRzdmdFbGVtZW50LnNldEF0dHJpYnV0ZSgnaGVpZ2h0JywgJzEwMCUnKTtcblx0XHRcdH0gZWxzZSBpZiAoaW1nU2l6ZWUgIT09IG51bGwpIHtcblx0XHRcdFx0c3ZnRWxlbWVudC5zZXRBdHRyaWJ1dGUoJ3dpZHRoJywgaW1nU2l6ZWUpO1xuXHRcdFx0XHRzdmdFbGVtZW50LnNldEF0dHJpYnV0ZSgnaGVpZ2h0JywgJzEwMCUnKTtcblx0XHRcdH1cblxuXG5cdFx0XHRpZihkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5jb250YWlucygndGhlbWUtbGlnaHQnKSkge1xuXHRcdFx0XHRzdmdFbGVtZW50LmFkZENsYXNzKCdkcmF3aW8tc2NoZW1lLWxpZ2h0JykgXG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRzdmdFbGVtZW50LmFkZENsYXNzKCdkcmF3aW8tc2NoZW1lLWRhcmsnKVxuXHRcdFx0fVxuXHRcblx0Y29uc3QgbGlua3MgPSBzdmdFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2EnKTtcblxuXHRmb3IoY29uc3QgbGluayBvZiBsaW5rcykge1xuXHRcblx0XHRjb25zdCBocmVmTGluayA9IGxpbmsuZ2V0QXR0cmlidXRlKCd4bGluazpocmVmJyk7XG5cdFx0bGV0IGNsZWFuSHJlZiA9IGhyZWZMaW5rO1xuXG5cdFx0Y29uc3QgZXh0ZXJuYWxMaW5rcyA9IGhyZWZMaW5rLm1hdGNoKC9eaHR0cHM/OlxcL1xcLy8pO1xuXG5cdFx0aWYoZXh0ZXJuYWxMaW5rcykge1xuXHRcdFx0Y2xlYW5IcmVmID0gZXh0ZXJuYWxMaW5rcy5pbnB1dFxuXHRcdFx0bGluay5hZGRDbGFzcygnZXh0ZXJuYWwtbGluaycpXG5cblx0XHRcdGNvbnN0IG1vdmVIYW5kbGVyID0gdG9vbHRpcC51cGRhdGVQb3NpdGlvbi5iaW5kKHRvb2x0aXApO1xuXG5cdFx0XHRsaW5rLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCAoZXZlbnQpID0+IHtcblx0XHRcdHRvb2x0aXAuc2hvdyhjbGVhbkhyZWYsIGV2ZW50IGFzIE1vdXNlRXZlbnQpO1xuXHRcdFx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgbW92ZUhhbmRsZXIpO1xuXHRcdH0pO1xuXG5cdFx0bGluay5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4ge1xuXHRcdFx0dG9vbHRpcC5oaWRlKCk7XG5cdFx0XHRkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCBtb3ZlSGFuZGxlcik7XG5cdFx0fSk7XG5cdFx0fTtcblxuXHRcdGNvbnN0IG1hdGNoUm91bmQgPSBocmVmTGluay5tYXRjaCgvXFxbLio/XFxdXFwoKC4qPylcXCkvKTtcblx0XHRpZiAobWF0Y2hSb3VuZCkge1xuXHRcdFx0Y2xlYW5IcmVmID0gbWF0Y2hSb3VuZFsxXTtcblx0XHRcdGxpbmsuYWRkQ2xhc3MoJ2ludGVybmFsLWxpbmsnKVxuXHRcdH1cblxuXHRcdGNvbnN0IG1hdGNoRG91YmxlU3F1YXJlID0gaHJlZkxpbmsubWF0Y2goL1xcW1xcWyguKj8pXFxdXFxdLyk7XG5cdFx0aWYgKG1hdGNoRG91YmxlU3F1YXJlKSB7XG5cdFx0XHRjbGVhbkhyZWYgPSBtYXRjaERvdWJsZVNxdWFyZVsxXTtcblx0XHRcdGxpbmsuYWRkQ2xhc3MoJ2ludGVybmFsLWxpbmsnKVxuXHRcdH1cblxuXHRcdGxpbmsuc2V0QXR0cmlidXRlKCdocmVmJywgY2xlYW5IcmVmKTtcblx0fVxuXHRcblx0fVxuXHR9KTtcbn0iLCAiaW1wb3J0IHsgRWRpdG9yLCBNYXJrZG93blZpZXcsIFRGaWxlLCBBcHAgfSBmcm9tIFwib2JzaWRpYW5cIjtcblxuZXhwb3J0IGZ1bmN0aW9uIGZpbmREaWFncmFtRmlsZVVuZGVyQ3Vyc29yKGFwcDogQXBwLCBlZGl0b3I6IEVkaXRvciwgdmlldzogTWFya2Rvd25WaWV3KTogVEZpbGUgfCBudWxsIHtcbiAgICBjb25zdCBjdXJzb3IgPSBlZGl0b3IuZ2V0Q3Vyc29yKCk7XG4gICAgY29uc3QgbGluZSA9IGVkaXRvci5nZXRMaW5lKGN1cnNvci5saW5lKTtcblxuICAgIGNvbnN0IGxpbmtSZWdleCA9IC8hXFxbXFxbKFtefFxcXV0rXFwuKD86ZHJhd2lvXFwuc3ZnfGRyYXdpbykpW15cXF1dKlxcXVxcXS9nO1xuICAgIGxldCBleGVjTWF0Y2g7XG5cbiAgICB3aGlsZSAoKGV4ZWNNYXRjaCA9IGxpbmtSZWdleC5leGVjKGxpbmUpKSAhPT0gbnVsbCkge1xuICAgICAgICBjb25zdCBmdWxsTWF0Y2hUZXh0ID0gZXhlY01hdGNoWzBdO1xuICAgICAgICBjb25zdCBsaW5rVGV4dCA9IGV4ZWNNYXRjaFsxXTtcbiAgICAgICAgY29uc3Qgc3RhcnRJbmRleCA9IGV4ZWNNYXRjaC5pbmRleDtcbiAgICAgICAgY29uc3QgZW5kSW5kZXggPSBzdGFydEluZGV4ICsgZnVsbE1hdGNoVGV4dC5sZW5ndGg7XG5cbiAgICAgICAgaWYgKGN1cnNvci5jaCA+PSBzdGFydEluZGV4ICYmIGN1cnNvci5jaCA8PSBlbmRJbmRleCkge1xuICAgICAgICAgICAgY29uc3QgbGlua2VkRmlsZSA9IGFwcC5tZXRhZGF0YUNhY2hlLmdldEZpcnN0TGlua3BhdGhEZXN0KGxpbmtUZXh0LCB2aWV3LmZpbGU/LnBhdGggPz8gXCJcIik7XG4gICAgICAgICAgICBpZiAobGlua2VkRmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGxpbmtlZEZpbGU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG59IiwgImltcG9ydCB7IEFwcCwgTW9kYWwsIEVkaXRvciwgVEZpbGUsIE5vdGljZSwgTWFya2Rvd25WaWV3IH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IERyYXdpb1BsdWdpbiBmcm9tICcuLi9tYWluJztcbmltcG9ydCB7IGZvcmNlTWFya2Rvd25WaWV3VXBkYXRlIH0gZnJvbSAnLi4vdXRpbHMvZm9yY2VNYXJrZG93blZpZXdVcGRhdGUnO1xuXG5leHBvcnQgY2xhc3MgRHJhd2lvRW1iZWRNb2RhbCBleHRlbmRzIE1vZGFsIHtcbiAgICBwcml2YXRlIGVkaXRvcjogRWRpdG9yO1xuICAgIHByaXZhdGUgY3VycmVudEZpbGU6IFRGaWxlIHwgbnVsbCA9IG51bGw7XG4gICAgcHJpdmF0ZSBpZnJhbWU6IEhUTUxJRnJhbWVFbGVtZW50IHwgbnVsbCA9IG51bGw7XG4gICAgcHJpdmF0ZSBtZXNzYWdlSGFuZGxlcjogKChldmVudDogTWVzc2FnZUV2ZW50KSA9PiBQcm9taXNlPHZvaWQ+KSB8IG51bGwgPSBudWxsO1xuICAgIHByaXZhdGUgcGx1Z2luOiBEcmF3aW9QbHVnaW47XG4gICAgcHJpdmF0ZSBpc0VtcHR5RGlhZ3JhbTogYm9vbGVhbiA9IHRydWU7XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgZWRpdG9yOiBFZGl0b3IsIHBsdWdpbjogRHJhd2lvUGx1Z2luLCBmaWxlVG9FZGl0OiBURmlsZSB8IG51bGwgPSBudWxsKSB7XG4gICAgICAgIHN1cGVyKGFwcCk7XG4gICAgICAgIHRoaXMuZWRpdG9yID0gZWRpdG9yO1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICAgICAgdGhpcy5jdXJyZW50RmlsZSA9IGZpbGVUb0VkaXQ7XG4gICAgICAgIHRoaXMubW9kYWxFbC5hZGRDbGFzcyhcImRyYXdpby1lbWJlZC1tb2RhbFwiKTtcblxuICAgICAgICBjb25zdCBtb2RhbEJnID0gdGhpcy5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKCcubW9kYWwtYmcnKTtcbiAgICAgICAgaWYgKG1vZGFsQmcpIHtcbiAgICAgICAgICAgIHRoaXMuc2NvcGUucmVnaXN0ZXIoW10sIFwiRXNjYXBlXCIsICgpID0+IGZhbHNlKTtcbiAgICAgICAgICAgIG1vZGFsQmcuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gZS5zdG9wUHJvcGFnYXRpb24oKSwgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhc3luYyBvbk9wZW4oKSB7XG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuICAgICAgICBjb250ZW50RWwuZW1wdHkoKTtcblxuICAgICAgICB0aGlzLnRpdGxlRWwuc2V0VGV4dCh0aGlzLmN1cnJlbnRGaWxlID8gYEVkaXQgRGlhZ3JhbTogJHt0aGlzLmN1cnJlbnRGaWxlLm5hbWV9YCA6IFwiQ3JlYXRlIE5ldyBEaWFncmFtXCIpO1xuXG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRGaWxlKSB7XG4gICAgICAgICAgICB0aGlzLmlzRW1wdHlEaWFncmFtID0gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBpc0RhcmtUaGVtZSA9IGRvY3VtZW50LmJvZHkuaGFzQ2xhc3MoXCJ0aGVtZS1kYXJrXCIpO1xuICAgICAgICBjb25zdCBkcmF3aW9VcmwgPSBgaHR0cDovL2xvY2FsaG9zdDoke3RoaXMucGx1Z2luLnNldHRpbmdzLnBvcnR9Lz9lbWJlZD0xJnByb3RvPWpzb24mbGlicmFyaWVzPTEmc3Bpbj0xJnNwbGFzaD0wYCArXG4gICAgICAgICAgICAgICAgICAgICAgICAgIChpc0RhcmtUaGVtZSA/IGAmdWk9ZGFyayZkYXJrPTFgIDogYCZ1aT1hdGxhc2ApO1xuXG4gICAgICAgIHRoaXMuaWZyYW1lID0gY29udGVudEVsLmNyZWF0ZUVsKFwiaWZyYW1lXCIsIHsgYXR0cjogeyBzcmM6IGRyYXdpb1VybCB9IH0pO1xuICAgICAgICB0aGlzLmlmcmFtZS5hZGRDbGFzcygnZHJhd2lvSWZyYW1lJyk7XG5cbiAgICAgICAgdGhpcy5tZXNzYWdlSGFuZGxlciA9IHRoaXMuY3JlYXRlTWVzc2FnZUhhbmRsZXIoKTtcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsIHRoaXMubWVzc2FnZUhhbmRsZXIpO1xuICAgIH1cblxuICAgIGFzeW5jIG9uQ2xvc2UoKSB7XG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuICAgICAgICBjb250ZW50RWwuZW1wdHkoKTtcblxuICAgICAgICBpZiAodGhpcy5tZXNzYWdlSGFuZGxlcikge1xuICAgICAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsIHRoaXMubWVzc2FnZUhhbmRsZXIpO1xuICAgICAgICAgICAgdGhpcy5tZXNzYWdlSGFuZGxlciA9IG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBhd2FpdCB0aGlzLmhhbmRsZU1vZGFsQ2xvc2VCYXNlZE9uQ29udGVudCgpO1xuXG4gICAgICAgIHRoaXMuaWZyYW1lID0gbnVsbDtcbiAgICAgICAgdGhpcy5pc0VtcHR5RGlhZ3JhbSA9IHRydWU7XG4gICAgICAgIHRoaXMuY3VycmVudEZpbGUgPSBudWxsO1xuICAgIH1cblxuICAgIHByaXZhdGUgc2VuZE1lc3NhZ2VUb0RyYXdpbyhtZXNzYWdlOiBvYmplY3QpIHtcbiAgICAgICAgaWYgKHRoaXMuaWZyYW1lICYmIHRoaXMuaWZyYW1lLmNvbnRlbnRXaW5kb3cpIHtcbiAgICAgICAgICAgIHRoaXMuaWZyYW1lLmNvbnRlbnRXaW5kb3cucG9zdE1lc3NhZ2UoSlNPTi5zdHJpbmdpZnkobWVzc2FnZSksIGBodHRwOi8vbG9jYWxob3N0OiR7dGhpcy5wbHVnaW4uc2V0dGluZ3MucG9ydH1gKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgaGFuZGxlTmV3RGlhZ3JhbUNyZWF0aW9uKCk6IFByb21pc2U8VEZpbGUgfCBudWxsPiB7XG4gICAgICAgIGNvbnN0IGZvbGRlclBhdGggPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5Gb2xkZXI7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmFwcC52YXVsdC5jcmVhdGVGb2xkZXIoZm9sZGVyUGF0aCk7XG4gICAgICAgIH0gY2F0Y2ggKGU6IGFueSkge1xuICAgICAgICAgICAgaWYgKCFlLm1lc3NhZ2UuaW5jbHVkZXMoXCJGb2xkZXIgYWxyZWFkeSBleGlzdHNcIikpIHtcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKFwiXHUyNzRDIENvdWxkIG5vdCBjcmVhdGUgZm9sZGVyIGZvciBuZXcgZGlhZ3JhbS5cIik7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGNyZWF0aW5nIERyYXdpbyBmb2xkZXI6XCIsIGUpO1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKTtcbiAgICAgICAgY29uc3QgdGltZXN0YW1wID0gYCR7bm93LmdldEZ1bGxZZWFyKCl9JHsobm93LmdldE1vbnRoKCkgKyAxKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyl9JHtub3cuZ2V0RGF0ZSgpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKX0ke25vdy5nZXRIb3VycygpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKX0ke25vdy5nZXRNaW51dGVzKCkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpfSR7bm93LmdldFNlY29uZHMoKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyl9YDtcbiAgICAgICAgY29uc3QgZmlsZU5hbWUgPSBgZGlhZ3JhbV8ke3RpbWVzdGFtcH0uZHJhd2lvLnN2Z2A7XG4gICAgICAgIGNvbnN0IGZ1bGxQYXRoID0gYCR7Zm9sZGVyUGF0aH0vJHtmaWxlTmFtZX1gO1xuICAgICAgICBjb25zdCBlbXB0eVN2Z0NvbnRlbnQgPSBgPD94bWwgdmVyc2lvbj1cIjEuMFwiIGVuY29kaW5nPVwiVVRGLThcIj8+PCFET0NUWVBFIHN2ZyBQVUJMSUMgXCItLy9XM0MvL0RURCBTVkcgMS4xLy9FTlwiIFwiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkXCI+PHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgeG1sbnM6eGxpbms9XCJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rXCIgdmVyc2lvbj1cIjEuMVwiIHdpZHRoPVwiMXB4XCIgaGVpZ2h0PVwiMXB4XCIgdmlld0JveD1cIi0wLjUgLTAuNSAxIDFcIiBjb250ZW50PVwiJmx0O214R3JhcGhNb2RlbCZndDsmbHQ7cm9vdCZndDsmbHQ7bXhDZWxsIGlkPSZxdW90OzAmcXVvdDsvJmd0OyZsdDtteENlbGwgaWQ9JnF1b3Q7MSZxdW90OyBwYXJlbnQ9JnF1b3Q7MCZxdW90Oy8mZ3Q7Jmx0Oy9yb290Jmd0OyZsdDsvbXhHcmFwaE1vZGVsJmd0O1wiPjxkZWZzLz48Zy8+PC9zdmc+YDtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuYXBwLnZhdWx0LmNyZWF0ZShmdWxsUGF0aCwgZW1wdHlTdmdDb250ZW50KTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgbmV3IE5vdGljZShgXHUyNzRDIEZhaWxlZCB0byBjcmVhdGUgbmV3IGRpYWdyYW0gZmlsZTogJHtmdWxsUGF0aH1gKTtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBjcmVhdGluZyBuZXcgZGlhZ3JhbSBmaWxlOlwiLCBlKTtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVNZXNzYWdlSGFuZGxlcigpOiAoZXZlbnQ6IE1lc3NhZ2VFdmVudCkgPT4gUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHJldHVybiBhc3luYyAoZXZlbnQ6IE1lc3NhZ2VFdmVudCkgPT4ge1xuICAgICAgICAgICAgaWYgKGV2ZW50Lm9yaWdpbiAhPT0gYGh0dHA6Ly9sb2NhbGhvc3Q6JHt0aGlzLnBsdWdpbi5zZXR0aW5ncy5wb3J0fWApIHJldHVybjtcblxuICAgICAgICAgICAgbGV0IG1zZztcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgbXNnID0gdHlwZW9mIGV2ZW50LmRhdGEgPT09IFwic3RyaW5nXCIgPyBKU09OLnBhcnNlKGV2ZW50LmRhdGEpIDogZXZlbnQuZGF0YTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oXCJDb3VsZCBub3QgcGFyc2UgRHJhdy5pbyBtZXNzYWdlOlwiLCBldmVudC5kYXRhLCBlKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHN3aXRjaCAobXNnLmV2ZW50KSB7XG4gICAgICAgICAgICAgICAgY2FzZSBcImluaXRcIjpcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5oYW5kbGVJbml0TWVzc2FnZSgpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwic2F2ZVwiOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbmRNZXNzYWdlVG9EcmF3aW8oeyBhY3Rpb246IFwiZXhwb3J0XCIsIGZvcm1hdDogXCJ4bWxzdmdcIiwgeG1sOiAxLCBlbXB0eTogMSB9KTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBcImV4cG9ydFwiOlxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmhhbmRsZUV4cG9ydE1lc3NhZ2UobXNnLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwiY2hhbmdlXCI6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlQ2hhbmdlTWVzc2FnZShtc2cueG1sKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBcImV4aXRcIjpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIGhhbmRsZUluaXRNZXNzYWdlKCkge1xuICAgICAgICBpZiAodGhpcy5jdXJyZW50RmlsZSkge1xuICAgICAgICAgICAgY29uc3QgZmlsZUNvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKHRoaXMuY3VycmVudEZpbGUpO1xuICAgICAgICAgICAgdGhpcy5zZW5kTWVzc2FnZVRvRHJhd2lvKHsgYWN0aW9uOiBcImxvYWRcIiwgeG1sOiBmaWxlQ29udGVudCwgYXV0b3NhdmU6IDEgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBlbXB0eVhtbCA9IFwiPG14R3JhcGhNb2RlbD48cm9vdD48bXhDZWxsIGlkPScwJy8+PG14Q2VsbCBpZD0nMScgcGFyZW50PScwJy8+PC9yb290PjwvbXhHcmFwaE1vZGVsPlwiO1xuICAgICAgICAgICAgdGhpcy5zZW5kTWVzc2FnZVRvRHJhd2lvKHsgYWN0aW9uOiBcImxvYWRcIiwgeG1sOiBlbXB0eVhtbCwgYXV0b3NhdmU6IDEgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIGhhbmRsZUV4cG9ydE1lc3NhZ2Uoc3ZnRGF0YVVyaTogc3RyaW5nKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuc2F2ZURpYWdyYW1Gcm9tTW9kYWwoc3ZnRGF0YVVyaSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBoYW5kbGVDaGFuZ2VNZXNzYWdlKHhtbENvbnRlbnQ6IHN0cmluZykge1xuICAgICAgICBjb25zdCBiYXNlRW1wdHlYbWwgPSBcIjxteEdyYXBoTW9kZWw+PHJvb3Q+PG14Q2VsbCBpZD0nMCcvPjxteENlbGwgaWQ9JzEnIHBhcmVudD0nMCcvPjwvcm9vdD48L214R3JhcGhNb2RlbD5cIjtcbiAgICAgICAgdGhpcy5pc0VtcHR5RGlhZ3JhbSA9ICgheG1sQ29udGVudCB8fCB4bWxDb250ZW50ID09PSBiYXNlRW1wdHlYbWwpO1xuICAgIH1cblxucHJpdmF0ZSBhc3luYyBzYXZlRGlhZ3JhbUZyb21Nb2RhbChzdmdEYXRhVXJpOiBzdHJpbmcpIHtcbiAgICBsZXQgY29udGVudFRvU2F2ZTogc3RyaW5nO1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnRlbnRUb1NhdmUgPSB0aGlzLmRlY29kZVN2Z0RhdGFVcmkoc3ZnRGF0YVVyaSk7XG4gICAgfSBjYXRjaCAoZTogYW55KSB7XG4gICAgICAgIG5ldyBOb3RpY2UoYFx1Mjc0QyBGYWlsZWQgdG8gZGVjb2RlIFNWRyBjb250ZW50OiAke2UubWVzc2FnZX1gKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBcbiAgICBpZiAodGhpcy5pc1N2Z0NvbnRlbnRBY3R1YWxseUVtcHR5KGNvbnRlbnRUb1NhdmUpKSB7XG4gICAgICAgIG5ldyBOb3RpY2UoXCJEaWFncmFtIGlzIGVtcHR5LiBOb3RoaW5nIHRvIHNhdmUuXCIpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLmN1cnJlbnRGaWxlKSB7XG4gICAgICAgIGNvbnN0IG5ld0ZpbGUgPSBhd2FpdCB0aGlzLmhhbmRsZU5ld0RpYWdyYW1DcmVhdGlvbigpO1xuICAgICAgICBpZiAoIW5ld0ZpbGUpIHJldHVybjtcblxuICAgICAgICB0aGlzLmN1cnJlbnRGaWxlID0gbmV3RmlsZTtcbiAgICAgICAgdGhpcy50aXRsZUVsLnNldFRleHQoYEVkaXQgRGlhZ3JhbTogJHt0aGlzLmN1cnJlbnRGaWxlLm5hbWV9YCk7IC8vIFx1MDQxRVx1MDQzMVx1MDQzRFx1MDQzRVx1MDQzMlx1MDQzQlx1MDQ0Rlx1MDQzNVx1MDQzQyBcdTA0MzdcdTA0MzBcdTA0MzNcdTA0M0VcdTA0M0JcdTA0M0VcdTA0MzJcdTA0M0VcdTA0M0EgXHUwNDNFXHUwNDNBXHUwNDNEXHUwNDMwXG5cbiAgICAgICAgY29uc3QgZGVmYXVsdFdpZHRoID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuZGlhZ3JhbVNpemU7XG4gICAgICAgIGxldCBlbWJlZExpbms6IHN0cmluZzsgICAgICAgIFxuICAgICAgICBcbiAgICAgICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLnVzZU1hcmtkb3duTGlua3MpIHtcbiAgICAgICAgICAgIGNvbnN0IGFsdCA9IGRlZmF1bHRXaWR0aD8udHJpbSgpID8/IFwiXCI7XG4gICAgICAgICAgICBjb25zdCByZWxhdGl2ZVBhdGggPSB0aGlzLmN1cnJlbnRGaWxlLnBhdGg7XG5cbiAgICAgICAgICAgIGVtYmVkTGluayA9IGAhWyR7YWx0fV0oJHtyZWxhdGl2ZVBhdGh9KWA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBlbWJlZExpbmsgPSBkZWZhdWx0V2lkdGg/LnRyaW0oKVxuICAgICAgICAgICAgICAgID8gYCFbWyR7dGhpcy5jdXJyZW50RmlsZS5wYXRofXwke2RlZmF1bHRXaWR0aC50cmltKCl9XV1gXG4gICAgICAgICAgICAgICAgOiBgIVtbJHt0aGlzLmN1cnJlbnRGaWxlLnBhdGh9XV1gO1xuICAgICAgICB9XG5cbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmVkaXRvci5yZXBsYWNlU2VsZWN0aW9uKGVtYmVkTGluayk7XG4gICAgICAgIH0sIDUwMCk7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgdGhpcy5hcHAudmF1bHQubW9kaWZ5KHRoaXMuY3VycmVudEZpbGUsIGNvbnRlbnRUb1NhdmUpO1xuICAgICAgICBuZXcgTm90aWNlKGBcdUQ4M0RcdURDQkUgRGlhZ3JhbSBzYXZlZDogJHt0aGlzLmN1cnJlbnRGaWxlLnBhdGh9YCk7XG4gICAgICAgIGZvcmNlTWFya2Rvd25WaWV3VXBkYXRlKHRoaXMuYXBwLCB0aGlzLmN1cnJlbnRGaWxlKTtcbiAgICAgICAgdGhpcy5pc0VtcHR5RGlhZ3JhbSA9IGZhbHNlO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgbmV3IE5vdGljZShgXHUyNzRDIEZhaWxlZCB0byBzYXZlIGRpYWdyYW06ICR7dGhpcy5jdXJyZW50RmlsZS5wYXRofWApO1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3Igc2F2aW5nIGRpYWdyYW06XCIsIGUpO1xuICAgIH1cbn1cblxuICAgIHByaXZhdGUgZGVjb2RlU3ZnRGF0YVVyaShzdmdEYXRhVXJpOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICBpZiAoc3ZnRGF0YVVyaS5zdGFydHNXaXRoKFwiZGF0YTppbWFnZS9zdmcreG1sO2Jhc2U2NCxcIikpIHtcbiAgICAgICAgICAgIGNvbnN0IGJhc2U2NFBhcnQgPSBzdmdEYXRhVXJpLnNwbGl0KCcsJylbMV07XG4gICAgICAgICAgICByZXR1cm4gQnVmZmVyLmZyb20oYmFzZTY0UGFydCwgJ2Jhc2U2NCcpLnRvU3RyaW5nKCd1dGYtOCcpO1xuICAgICAgICB9IGVsc2UgaWYgKHN2Z0RhdGFVcmkuc3RhcnRzV2l0aChcImRhdGE6aW1hZ2Uvc3ZnK3htbCxcIikpIHtcbiAgICAgICAgICAgIHJldHVybiBkZWNvZGVVUklDb21wb25lbnQoc3ZnRGF0YVVyaS5zcGxpdCgnLCcpWzFdKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgU1ZHIGRhdGEgZm9ybWF0IHJlY2VpdmVkLlwiKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgaXNTdmdDb250ZW50QWN0dWFsbHlFbXB0eShjb250ZW50OiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAgICAgY29uc3QgZW1wdHlEcmF3aW9YbWxJblN2Z0NvbnRlbnQgPSBgY29udGVudD1cIiZsdDtteEdyYXBoTW9kZWwmZ3Q7Jmx0O3Jvb3QmZ3Q7Jmx0O214Q2VsbCBpZD0mcXVvdDswJnF1b3Q7LyZndDsmbHQ7bXhDZWxsIGlkPSZxdW90OzEmcXVvdDsgcGFyZW50PSZxdW90OzAmcXVvdDsvJmd0OyZsdDsvcm9vdCZndDsmbHQ7L214R3JhcGhNb2RlbCZndDtcImA7XG4gICAgICAgIHJldHVybiBjb250ZW50LmluY2x1ZGVzKGVtcHR5RHJhd2lvWG1sSW5TdmdDb250ZW50KSAmJiAoY29udGVudC5tYXRjaCgvPGdcXGJbXj5dKj4vZykgfHwgW10pLmxlbmd0aCA9PT0gMTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIGhhbmRsZU1vZGFsQ2xvc2VCYXNlZE9uQ29udGVudCgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmN1cnJlbnRGaWxlKSByZXR1cm47IC8vIFx1MDQxNVx1MDQ0MVx1MDQzQlx1MDQzOCBcdTA0NDRcdTA0MzBcdTA0MzlcdTA0M0IgXHUwNDQyXHUwNDMwXHUwNDNBIFx1MDQzOCBcdTA0M0RcdTA0MzUgXHUwNDMxXHUwNDRCXHUwNDNCIFx1MDQ0MVx1MDQzRVx1MDQzN1x1MDQzNFx1MDQzMFx1MDQzRCwgXHUwNDMyXHUwNDRCXHUwNDQ1XHUwNDNFXHUwNDM0XHUwNDM4XHUwNDNDXG5cbiAgICAgICAgLy8gXHUwNDJEXHUwNDQyXHUwNDMwIFx1MDQzQlx1MDQzRVx1MDQzM1x1MDQzOFx1MDQzQVx1MDQzMCBcdTA0M0RcdTA0NDNcdTA0MzZcdTA0M0RcdTA0MzAgXHUwNDM0XHUwNDNCXHUwNDRGIFx1MDQ0MVx1MDQzQlx1MDQ0M1x1MDQ0N1x1MDQzMFx1MDQ0RiwgXHUwNDNBXHUwNDNFXHUwNDMzXHUwNDM0XHUwNDMwIFx1MDQzRlx1MDQzRVx1MDQzQlx1MDQ0Q1x1MDQzN1x1MDQzRVx1MDQzMlx1MDQzMFx1MDQ0Mlx1MDQzNVx1MDQzQlx1MDQ0QyBcdTA0M0VcdTA0NDdcdTA0MzhcdTA0NDFcdTA0NDJcdTA0MzhcdTA0M0IgKlx1MDQ0MVx1MDQ0M1x1MDQ0OVx1MDQzNVx1MDQ0MVx1MDQ0Mlx1MDQzMlx1MDQ0M1x1MDQ0RVx1MDQ0OVx1MDQ0M1x1MDQ0RSogXHUwNDM0XHUwNDM4XHUwNDMwXHUwNDMzXHUwNDQwXHUwNDMwXHUwNDNDXHUwNDNDXHUwNDQzLlxuICAgICAgICBpZiAodGhpcy5pc0VtcHR5RGlhZ3JhbSkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCBwYXRoVG9EZWxldGUgPSB0aGlzLmN1cnJlbnRGaWxlLnBhdGg7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5hcHAuZmlsZU1hbmFnZXIudHJhc2hGaWxlKHRoaXMuY3VycmVudEZpbGUpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGNvbnN0IGVkaXRvckNvbnRlbnQgPSB0aGlzLmVkaXRvci5nZXRWYWx1ZSgpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGxpbmtUb0RlbGV0ZVNpbXBsZSA9IGAhW1ske3BhdGhUb0RlbGV0ZX1dXWA7XG4gICAgICAgICAgICAgICAgY29uc3QgbGlua1RvRGVsZXRlRW5jb2RlZCA9IGAhW1ske2VuY29kZVVSSShwYXRoVG9EZWxldGUpfV1dYDtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBsZXQgZmluYWxDb250ZW50ID0gZWRpdG9yQ29udGVudC5yZXBsYWNlKGxpbmtUb0RlbGV0ZVNpbXBsZSwgJycpO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgbGlua1dpdGhNb2RpZmllclJlZ2V4ID0gbmV3IFJlZ0V4cChgIVxcXFxbXFxcXFske3BhdGhUb0RlbGV0ZS5yZXBsYWNlKC9bLVxcL1xcXFxeJCorPy4oKXxbXFxde31dL2csICdcXFxcJCYnKX1cXFxcfFteXFxcXF1dK1xcXFxdXFxcXF1gLCAnZycpO1xuICAgICAgICAgICAgICAgIGZpbmFsQ29udGVudCA9IGZpbmFsQ29udGVudC5yZXBsYWNlKGxpbmtXaXRoTW9kaWZpZXJSZWdleCwgJycpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGZpbmFsQ29udGVudCAhPT0gZWRpdG9yQ29udGVudCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmVkaXRvci5zZXRWYWx1ZShmaW5hbENvbnRlbnQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIGlmICghKGUgaW5zdGFuY2VvZiBFcnJvciAmJiBlLm1lc3NhZ2UudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhcImZpbGUgYWxyZWFkeSBkZWxldGVkXCIpKSkge1xuICAgICAgICAgICAgICAgICAgICBuZXcgTm90aWNlKGBcdTI3NEMgRmFpbGVkIHRvIGRlbGV0ZSBlbXB0eSBkaWFncmFtIGZpbGU6ICR7dGhpcy5jdXJyZW50RmlsZS5wYXRofWApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn0iLCAiaW1wb3J0IHsgQXBwLCBURmlsZSwgTWFya2Rvd25WaWV3IH0gZnJvbSAnb2JzaWRpYW4nO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZm9yY2VNYXJrZG93blZpZXdVcGRhdGUoYXBwOiBBcHAsIGZpbGU6IFRGaWxlIHwgbnVsbCkge1xuICAgIGlmICghZmlsZSkge1xuICAgICAgICBjb25zb2xlLndhcm4oXCJmb3JjZU1hcmtkb3duVmlld1VwZGF0ZTogXHUwNDEyXHUwNDRCXHUwNDM3XHUwNDMyXHUwNDMwXHUwNDNEXHUwNDMwIFx1MDQ0MSBudWxsIFx1MDQ0NFx1MDQzMFx1MDQzOVx1MDQzQlx1MDQzRVx1MDQzQy4gXHUwNDFEXHUwNDM1XHUwNDMyXHUwNDNFXHUwNDM3XHUwNDNDXHUwNDNFXHUwNDM2XHUwNDNEXHUwNDNFIFx1MDQzRVx1MDQzRlx1MDQ0MFx1MDQzNVx1MDQzNFx1MDQzNVx1MDQzQlx1MDQzOFx1MDQ0Mlx1MDQ0QywgXHUwNDM4XHUwNDM3XHUwNDNDXHUwNDM1XHUwNDNEXHUwNDM1XHUwNDNEXHUwNDM4XHUwNDRGIFx1MDQzQVx1MDQzMFx1MDQzQVx1MDQzRVx1MDQzM1x1MDQzRSBcdTA0NDRcdTA0MzBcdTA0MzlcdTA0M0JcdTA0MzAgXHUwNDNFXHUwNDQyXHUwNDQxXHUwNDNCXHUwNDM1XHUwNDM2XHUwNDM4XHUwNDMyXHUwNDMwXHUwNDQyXHUwNDRDLlwiKTtcbiAgICAgICAgcmV0dXJuOyBcbiAgICB9XG4gICAgY29uc3QgZGlhZ3JhbUZpbGU6IFRGaWxlID0gZmlsZTsgXG5cbiAgICBjb25zdCBsZWF2ZXMgPSBhcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZShcIm1hcmtkb3duXCIpO1xuICAgIGZvciAoY29uc3QgbGVhZiBvZiBsZWF2ZXMpIHtcbiAgICAgICAgY29uc3QgbWRWaWV3ID0gbGVhZi52aWV3IGFzIE1hcmtkb3duVmlldztcbiAgICAgICAgaWYgKCFtZFZpZXcgfHwgIW1kVmlldy5maWxlKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBjdXJyZW50Vmlld0ZpbGU6IFRGaWxlID0gbWRWaWV3LmZpbGU7IFxuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBsZXQgbmVlZHNSZWJ1aWxkID0gZmFsc2U7XG4gICAgICAgICAgICBpZiAoIWN1cnJlbnRWaWV3RmlsZSB8fCAhY3VycmVudFZpZXdGaWxlLnBhdGgpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYGZvcmNlTWFya2Rvd25WaWV3VXBkYXRlOiBjdXJyZW50Vmlld0ZpbGUgXHUwNDM4XHUwNDNCXHUwNDM4IFx1MDQzNVx1MDQzM1x1MDQzRSBcdTA0M0ZcdTA0NDNcdTA0NDJcdTA0NEMgXHUwNDQxXHUwNDQyXHUwNDMwXHUwNDNCIG51bGwvdW5kZWZpbmVkIFx1MDQzNFx1MDQzQlx1MDQ0RiBcdTA0M0JcdTA0MzhcdTA0NDFcdTA0NDJcdTA0MzAgJHtsZWFmfS4gXHUwNDFGXHUwNDQwXHUwNDNFXHUwNDNGXHUwNDQzXHUwNDQxXHUwNDNBXHUwNDMwXHUwNDM1XHUwNDNDIFx1MDQzRlx1MDQzNVx1MDQ0MFx1MDQzNVx1MDQ0MVx1MDQ0Mlx1MDQ0MFx1MDQzRVx1MDQzOVx1MDQzQVx1MDQ0My5gKTtcbiAgICAgICAgICAgICAgICBjb250aW51ZTsgXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChjdXJyZW50Vmlld0ZpbGUucGF0aCA9PT0gZGlhZ3JhbUZpbGUucGF0aCkge1xuICAgICAgICAgICAgICAgIG5lZWRzUmVidWlsZCA9IHRydWU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVDb250ZW50ID0gYXdhaXQgYXBwLnZhdWx0LmNhY2hlZFJlYWQoY3VycmVudFZpZXdGaWxlKTtcbiAgICAgICAgICAgICAgICBpZiAoZmlsZUNvbnRlbnQuaW5jbHVkZXMoZGlhZ3JhbUZpbGUubmFtZSkgfHwgZmlsZUNvbnRlbnQuaW5jbHVkZXMoZW5jb2RlVVJJKGRpYWdyYW1GaWxlLm5hbWUpKSkge1xuICAgICAgICAgICAgICAgICAgICBuZWVkc1JlYnVpbGQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKG5lZWRzUmVidWlsZCkge1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgKGxlYWYgYXMgYW55KS5yZWJ1aWxkVmlldyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCAobGVhZiBhcyBhbnkpLnJlYnVpbGRWaWV3KCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgdmlld1N0YXRlID0gbGVhZi5nZXRWaWV3U3RhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgbGVhZi5zZXRWaWV3U3RhdGUoeyB0eXBlOiAnZW1wdHknIH0pO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCBsZWFmLnNldFZpZXdTdGF0ZSh2aWV3U3RhdGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRWaWV3RmlsZVBhdGhGb3JMb2cgPSBjdXJyZW50Vmlld0ZpbGU/LnBhdGggPz8gJ3Vua25vd24gZmlsZSAobm8gcGF0aCknO1xuICAgICAgICAgICAgY29uc3QgZGlhZ3JhbUZpbGVQYXRoRm9yTG9nID0gZGlhZ3JhbUZpbGU/LnBhdGggPz8gJ3Vua25vd24gZGlhZ3JhbSBwYXRoJzsgXG5cbiAgICAgICAgICAgIGNvbnNvbGUud2FybihgXHUwNDFEXHUwNDM1IFx1MDQ0M1x1MDQzNFx1MDQzMFx1MDQzQlx1MDQzRVx1MDQ0MVx1MDQ0QyBcdTA0M0VcdTA0MzFcdTA0M0RcdTA0M0VcdTA0MzJcdTA0MzhcdTA0NDJcdTA0NEMgXHUwNDNGXHUwNDQwXHUwNDM1XHUwNDM0XHUwNDQxXHUwNDQyXHUwNDMwXHUwNDMyXHUwNDNCXHUwNDM1XHUwNDNEXHUwNDM4XHUwNDM1IFx1MDQzNFx1MDQzQlx1MDQ0RiAke2N1cnJlbnRWaWV3RmlsZVBhdGhGb3JMb2d9IFx1MDQzRVx1MDQ0Mlx1MDQzRFx1MDQzRVx1MDQ0MVx1MDQzOFx1MDQ0Mlx1MDQzNVx1MDQzQlx1MDQ0Q1x1MDQzRFx1MDQzRSBcdTA0MzhcdTA0MzdcdTA0M0NcdTA0MzVcdTA0M0RcdTA0MzVcdTA0M0RcdTA0MzhcdTA0MzkgXHUwNDMyICR7ZGlhZ3JhbUZpbGVQYXRoRm9yTG9nfTpgLCBlcnIpO1xuICAgICAgICB9XG4gICAgfVxufSJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxJQUFBQSxtQkFBbUc7OztBQ0E1RixJQUFNLGFBQWE7OztBQ0ExQixJQUFBQyxtQkFBdUU7OztBQ0F2RTtBQUFBLEVBQ0ksZ0JBQWtCO0FBQUEsRUFDbEIsZ0JBQWtCO0FBQUEsRUFDbEIsd0JBQTBCO0FBQUEsRUFDMUIsd0JBQTBCO0FBQzlCOzs7QUNMQTtBQUFBLEVBQ0ksZ0JBQWtCO0FBQUEsRUFDbEIsZ0JBQWtCO0FBQUEsRUFDbEIsd0JBQTBCO0FBQUEsRUFDMUIsd0JBQTBCO0FBQzlCOzs7QUNBQSxJQUFNLFVBQXdDO0FBQUEsRUFDNUM7QUFBQSxFQUNBO0FBQ0Y7QUFFQSxJQUFJLGdCQUF3QjtBQUM1QixJQUFJLGVBQTZCO0FBRTFCLFNBQVMsVUFBVSxRQUFnQjtBQUN4QyxrQkFBZ0IsVUFBVSxVQUFVLFNBQVM7QUFDN0MsaUJBQWUsUUFBUSxhQUFhO0FBQ3RDO0FBRU8sU0FBUyxFQUFFLEtBQWlDO0FBQ2pELFNBQU8sYUFBYSxHQUFHLEtBQUs7QUFDOUI7OztBQ3BCQSxzQkFBNEM7QUFFckMsU0FBUyxhQUFhLEtBQVVDLE9BQXVCO0FBQzVELFFBQU0saUJBQWEsK0JBQWNBLEtBQUk7QUFDckMsUUFBTSxTQUFTLElBQUksTUFBTSxzQkFBc0IsVUFBVTtBQUV6RCxTQUFPLGtCQUFrQjtBQUMzQjs7O0FKQ08sSUFBTSxhQUFOLGNBQXlCLDBCQUFTO0FBQUEsRUFLckMsWUFBWSxNQUFxQixRQUFzQjtBQUNuRCxVQUFNLElBQUk7QUFMZCxTQUFP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SyxjQUFjO0FBQ2xCLFdBQUssYUFBYSxNQUFNLE1BQU07QUFDNUIsWUFBSSx3QkFBTyxFQUFFLHdCQUF3QixDQUFDO0FBQ3RDLGFBQUssZUFBZTtBQUFBLE1BQ3RCLENBQUM7QUFBQSxJQUNMO0FBRUEsVUFBTSxzQkFBc0IsU0FBUyxjQUFjLHdCQUF3QjtBQUMzRSxRQUFJLHFCQUFxQjtBQUN2QiwwQkFBb0IsT0FBTztBQUFBLElBQzdCO0FBQUEsRUFDRjtBQUFBLEVBRUEsTUFBTSxlQUFlO0FBQ3RCLFVBQU0sT0FBTyxLQUFLLElBQUksVUFBVSxRQUFRLEtBQUs7QUFDN0MsUUFBRyxNQUFNO0FBQ1IsWUFBTSxLQUFLLGFBQWE7QUFBQSxRQUN4QixNQUFNO0FBQUEsUUFDTixRQUFRO0FBQUEsTUFDTixDQUFDO0FBQ0QsV0FBSyxJQUFJLFVBQVUsV0FBVyxJQUFJO0FBQUEsSUFDckM7QUFBQSxFQUNDO0FBQ0Y7IiwKICAibmFtZXMiOiBbImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAicGF0aCIsICJpbXBvcnRfb2JzaWRpYW4iLCAicG9ydCIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIl0KfQo=
